<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>上海医保异地就医</title>
      <link href="/2021/11/10/Shanghai-Remote-Medical-Treatment/"/>
      <url>/2021/11/10/Shanghai-Remote-Medical-Treatment/</url>
      
        <content type="html"><![CDATA[<h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>因为需要去江苏南京就医，所以在今年九月初办理了医保异地就医，过程记录一下，方便有需要的朋友。本文适用于在上海缴纳五险一金，但是需要在上海以外使用医保就医的情况。</p><h2 id="材料"><a href="#材料" class="headerlink" title="材料"></a>材料</h2><ul><li>身份证原件；</li><li>医保卡&#x2F;社保卡原件；</li><li>公司外派证明。</li></ul><p>身份证和社保卡都带原件这个不用多说，外派证明的话这里给大家一个例子，我就是用的这个，A4 纸打印就行，但注意一定要加盖单位公章：</p><center>外派工作证明</center><p>兹证明张三先生（身份证号码 328888888888888882）为我单位正式员工，劳动合同由 2008 年 8 月 8 日至 2018 年 8 月 8 日。   </p><p>我单位现因工作需要，外派张三先生（身份证号码 328888888888888882），至江苏省南京市从事市场拓展工作，为期 1 年。故申请办理就医关系转移手续，望接洽！   </p><p>特此证明。</p><p align="right">上海例子科技有限公司</br> 2021 年 11 月 11 日&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p><h2 id="办理"><a href="#办理" class="headerlink" title="办理"></a>办理</h2><ul><li>选择上海的任意医疗保险事务中心都可以，我去的是 <code>普陀区医疗保险事务中心</code>；</li><li>注意医疗保险事务中心的工作时间，避开节假日，以免白跑；</li><li>疫情期间，进门出示健康码，然后跟保安大叔说你要办理医保异地就医，保安大叔会帮你在机器上取号；</li><li>来办事的人一般都挺少的，我去了两次，第一次询问情况，第二次是办理，都在取号五分钟内轮到我了；</li><li>叫到号时，把上面准备的三个材料给工作人员，然后你要告诉他办理异地就医，就医地点要告诉他，精确到省市区三级，且需要准备一个地址作为办公地址（因为是按工作外派办理的，实在没有的话，可以找一个目标医院附近的酒店、宾馆的地址），没什么问题的话，办好后会得到下列材料：</li></ul><p><img src="/images/Medical-2.jpg" alt="就医关系转移表"></p><p><img src="/images/Medical-3.jpg" alt="异地就医备案表"></p><h2 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h2><p><img src="/images/Medical-1.jpg" alt="注意事项"></p><ul><li>办理异地就医成功后，立刻生效，所以有啥检查、药要在上海准备的，弄好了之后再去医保局办理手续；</li><li>异地就医关系转出后，理论上，上海本地是不能再刷这个医保卡了，只能去转出地使用；</li><li>异地就医办理后，6 个月内不能转回上海，6 个月后随时可以转回；但在转出上海期间，可以多次调整省内目标地点，比如转去南京两个月，然后再转去苏州（但我没试过；</li><li>在异地，医保联网的定点医院，刷上海医保卡，可以直接按报销后的价格结算；如果就医的医院，不支持医保联网，或者由于其他一些原因导致不能刷卡直接报销，则需要拿完整的资料回上海，比如出院小结、消费明细、发票等，有些医院出院的时候会给好，有些医院可能要自己去病案室打印，自己要留意，不然到时候回上海由于材料不全不给报销再往回跑会很尴尬；</li><li>那么医保定点医院有哪些呢？可以下载「国家医保服务平台」App 进行搜索和查看，除此以外 App 中还可以查询包括历史消费详情等很多信息（其实很多省市区也可以在上面办理异地就医，但上海市目前还不支持通过这个 App 进行办理）：</li></ul><p><img src="/images/Medical-4.jpg" alt="国家医保服务平台"></p><h2 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h2><ul><li>希望以上内容对大家永远没有用；</li><li>没有五险一金的朋友一定赶紧交好五险一金，注意不要断缴；</li><li>请大家务必给自己和家人买好商业保险，以备不时之需。</li></ul><hr><p>参考资料：</p><p><a href="https://zhuanlan.zhihu.com/p/378316098">上海异地就医备案流程</a></p><hr><blockquote><p>如有任何知识产权、版权问题或理论错误，还请指正。<br><a href="https://www.eyrefree.org/2021/11/10/Shanghai-Remote-Medical-Treatment">https://www.eyrefree.org/2021/11/10/Shanghai-Remote-Medical-Treatment</a><br>如文中无特殊说明，本站均使用以下协议保护：<a href="http://creativecommons.org/licenses/by-nc-nd/3.0/cn/">署名-非商业性使用-禁止演绎</a>。   </p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Life </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Life </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>写在住院之前</title>
      <link href="/2021/09/25/Before-Hospitalization/"/>
      <url>/2021/09/25/Before-Hospitalization/</url>
      
        <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>大家好，我是 EyreFree（EF）。</p><p>既然是住院的话，我是在 2018 年 11 月确诊的，具体病情住院之后有机会的话再跟大家分享。</p><h2 id="前公司"><a href="#前公司" class="headerlink" title="前公司"></a>前公司</h2><p>确诊时我就职于上家公司，负责管理移动端开发团队，工作一直兢兢业业勤勤恳恳，所以也不觉得对公司坦白会有什么问题，在初步诊断结果出来后，我把此事告知了直属上级，也就是 CTO。</p><p>过完春节，也就是 2019 年 3 月，公司产品部门负责人带着运营部门负责人找到我，要求接下来整个移动端进行 007 式开发，也就是一周七天，每天 12 小时。我拒绝了，因为移动端一直是全公司加班最多的一个部门，之前 CTO 要求移动端发挥带头作用，平时就是 996 的工作状态，其他部门并不加班，而且也没有一分钱加班费，我曾经在研发部门会议上提过加班费的问题，被 CTO 一口回绝，并表示绝对不能开这个口子。</p><p>随后 CTO 当晚开始对移动端的工作状况挑刺，在 22:23 质问我为啥移动端人都不在公司加班，和我说的“大家每天加班工作很辛苦”不相符合，借机发难。实际情况是前一天 App 发完新版本，大家刚忙完，而且这个语境似乎已经把员工无偿加班到晚上 10 点多认定为是员工的本分了，当时我正坐在公司工位上加班。第二天 CTO 找我谈话，对我拒绝 007 的事表示“你对我们说 No 我们也对你说 No”，以行政命令的方式强制整个移动端实行 007 工作制直到月底。我见领导铁了心要逼大家加班，只能退而求其次，申请了一个所谓的加班补贴 2000 块 RMB，在三月底给到比较辛苦的三位同事，1 个 1000 元，2 个 500 元，这是当时的加班记录 <a href="https://docs.qq.com/sheet/DVmhuREhFa3lhcnNO?tab=BB08J2">三月突击计划结算表</a>（表中早退指 22:30 前下班），下图是 CTO 和我的企业微信聊天记录：</p><p><img src="/images/IMG_12.png" alt="找茬"></p><p>在 3 月底，HR 以「公司上市需要做账」为由，要求移动端员工改签劳动合同，过程中没有涨薪，但在这份新合同中，把基本工资的 20% 变为了“绩效工资”，实际上也就是变相降薪，因为根据新合同的规定，绩效工资发多少由公司根据当月表现来定，也就是最少可以一分不给。而且新增了多条类似「员工身体健康状况发生变化」和「员工无法胜任工作」后公司如何做岗位调整和解除劳动合同的条款。对于绩效工资，我很直白地问了负责改签合同的 HR 如果公司不给钱怎么办，她只是答复了一堆「公司只是为了做避税和方便管理，员工和公司之间要相互信任」之类的话术。新合同中还对加班制度作了规定，提及了加班费和加班申请等，但实际上这些文本只是为了符合相关法律规定装样子的摆设罢了，因为不管是在这之前还是之后，不管是工作日的超出 8 小时后的加班还是非工作日的加班，不管是 996 还是 007，公司没有给任何普通员工发过哪怕一分钱的加班费。</p><p>4 月 10 日，CTO 表示 007 继续，从 11 号开始到月底，这是 4 月份的加班记录 <a href="https://docs.qq.com/sheet/DVkdLWUpoT0FPU0dO?tab=BB08J2">四月突击计划结算表</a>，点开链接的朋友会发现里面只记了 4 月 11 日一天，没错因为我被降职了。4 月 12 号，CTO 找到我表示公司组织架构调整，移动端和前端组合并成立大前端，前端负责人为新的 Leader，并表示这是 3 月决定的事，没有任何其他理由。新的大前端部门成立一周后，公司把前端开发工程师全部裁掉了，所以实际上大前端也就是移动端换个名字而已，很新颖的操作方式。然后 007 照旧到月底，但加班不用记录了，因为这次没人去给团队申请 2000 块了。</p><p>期间内推我的同事告诉我，他找 CEO 沟通了我的事情，CEO 的说法是”虽然 EF 自己能为公司加班，但他不能带动团队一起加班”，我听完就满脸问号，所以移动端之前无偿 996 和 007 给公司加班算啥，不存在？从公司的这一番操作中，我感觉自己被刻意针对了，但也没有十分确定的证据。因为 6 月有年中绩效评估（调薪），在被降职后我找到 CTO 表示希望公司不要故意针对我把我排除在调薪范围之外，CTO 当场许诺会给我调薪，甚至明确告诉我涨幅是 15%。得到超出预期的答复后，我觉得可能我之前想多了，自己以小人之心度君子之腹。</p><p>随后公司入职了一个技术 VP，他对我们说原来的 CTO 已经把岗位让给了他，现在他是新的 CTO 了，负责管理研发团队，并表示接下来要对研发团队做改革，精简裁撤，好好表现努力工作的人能够留下来得到加薪，大概意思就是胡萝卜加大棒。并在找我谈话时表示 CEO 对他说“移动端所有人都可以开掉”，因为他并不了解我的病情所以觉得用 CEO 的话可以震慑我，但我却从中获得了一个信息：CEO 似乎在暗示他把我开掉？</p><p>之后发生的事情，当时在公司工作的朋友们应该都知道。七月初，移动端之前我招进来的 iOS &amp; Android 工程师此时有毕海湉、夏启波、张文超、王世超、刘庆、王顺扬、王杰，共 7 人，除了张文超以外全都被辞退。辞退理由是绩效不达标、技术菜之类莫须有的罪名，辞退补偿是三周的薪水（因为 Android 当时缺人，后面他们招到新的 Android 工程师后把张文超也裁掉了，大概 9 月初）。毕海湉是我招进公司的 Android 开发小姐姐，技术和工作能力都很强，进入公司后统筹 Android 项目开发，辞退时间发生时她正在休婚假，休完假回到公司当天就被辞退。也就是说，在整个移动端团队 3、4 月份 007 高强度加班两个月，平时也保持 996 的开发节奏，并且从未出现过重大生产事故的情况下，几乎整个团队被开掉了，并且赔偿还是完全不合法的三周薪水，被开除之前大家还在天真地期待着年中绩效考评升职加薪。下图是当时和张文超的微信聊天记录，还记得之前改签的那份新合同么？1800 元是用 20% 绩效工资手段扣掉的：</p><p><img src="/images/IMG_10.png" alt="张文超被辞退"></p><p>关于张文超菜不菜这个问题，可能我作为当事人下的结论会让人觉得可信度不高，这是他的 GitHub：<a href="https://github.com/Zackratos">https://github.com/Zackratos</a>，做 Android 开发的朋友可以自己评估。据我了解到的情况是张文超之后接了 Soul 的 Offer，毕海湉去了哈喽单车，其他同事也都很快找到了合适的工作。</p><p>另外关于离职补偿为啥是三周这个问题我很长一段时间一直没想明白，直到有一次遇到老领导丹哥，他第一反应就是问了一句“你们是不是劳动合同走的避税？”，算了一下按避税的基本工资计算 N+1 差不多就是真实工资三周的数字了，这大概就是 CTO 有底气叫嚣“你可以去仲裁”的原因吧。</p><p>接下来，年中绩效评估结果出来了，看到这里的朋友到这应该知道，不管是 CTO 还是 VP 都许诺了此时会给到涨薪，接下来到了兑现的时候了。七月底，VP 找到我沟通年中绩效评估。通知我我的年中绩效结果是 3 分（满分 5 分），并表示有其他领导想给我打 2 分让我走人，是他力挽狂澜保住了我，并让我以后好好表现，之前许诺的涨薪只字未提，并且对我进行了一番 PUA，说我工作做得不好这也不行那也不行之类的。几天后，CTO 也找我谈话，表示之前口头答应给到我的涨薪不给了，告诉我直接原因是他在 VP 面前帮我提了调薪但被 VP 否决了，并表示虽然之前口头许诺了我涨薪，但公司就是靠层层压榨攫取利益的，既然我现在不是 Leader 了不愿意和公司一起压榨手下的员工，那自然也享受不到压榨员工带来的好处。</p><p>当天加了公司离职员工群，把从三月开始的这些事（也就是上文这些内容）简单描述了一下，发到了群里，但可能没有这么详细，并跟圈子里的一些朋友沟通我的遭遇。第二天，HR 部门负责人找我谈话，大致就是让我不要继续搞事情。随后 CTO 也找我谈话，我对他转述了 VP 说的话，他表示我说的内容和他了解到的事实有出入，随后我表示“VP 在会上说留下来的同事有涨薪，这个会你也在场的吧？”，CTO 沉默了，之后表示会帮我把答应的涨薪争取回来。最后给到的方案是公司每月给我所谓的「帮扶金」，由他们这些公司高管一起出钱，数额大概就是之前答应我的 15% 涨薪的额度，但这笔钱的性质此时已经完全变了。期间 CEO 也找到我，给我支付宝转账 1 万块，表示对我的帮助。</p><p>这件事之后，我便开始考虑之后如何维持生计的问题，因为领导宁愿给所谓的「帮扶金」也不愿给我涨哪怕一块钱已经摆明了姿态，公司不会给我任何涨薪。之后的几个月里，我不断滴找一些朋友、同事、老乡越聊创业的事情希望能自力更生，因为不想再换一家公司工作，倒不是真的因为身体原因影响工作能力，只是怕坑人，但始终没有比较好的机会。</p><p>在这期间，各种针对我的劝退行为一直没有停：</p><ul><li>比如刚调前端 Leader 来管理移动端时，因为新领导压根不懂 App 开发，所以移动端很多同事不适应，我在公司找他们沟通让他们好好配合新领导工作，结果 VP 找到我说新 Leader 投诉我私下和移动端同事串联教唆他们造反，让我停止搞事情，再犯就要处分我；</li><li>年中绩效考评时给到移动端组的绩效是全公司倒数第二，理由是稳定性指标降低了，没错原因是需求多加班赶进度频繁发版本出现了一些需求延误和几个小 Bug，也就是说移动端加班不仅不给加班费，而且还亏钱；</li><li>八月初的公司月度会议，公司政府关系部门的负责人在台上表示自己又联合某地公安抓获了薅公司运营活动羊毛的团伙帮公司挽回了损失，并公开点名我说“EF 都是你的工作没做好”，我寻思被薅的运营活动是前端组做的微信小程序的，出问题的接口是后端写的，跟我一个 iOS 开发有啥关系？但话语权在他们手上，而且确实十分有效，因为公司大部分人都是不懂技术的，真就认为这事怪我是我给公司造成了损失；</li><li>公司领导不断在各种场合宣称公司业务做不起来怪移动端开发，因为 App 是开发人员做的，数据起不来就是开发的能力问题。</li></ul><p>10 月底，CTO 找我谈话，表示“不希望看到我继续在这家公司浪费时间”，我花了一周时间面试，拿了几家公司的 Offer，并在 11 月上旬办理了离职手续。即使在这时，我仍然抱着“他们顶多就是觉得我身体不行了不能继续正常工作所以不停劝退我而已”的想法，接下来发生的事情让我知道我确实想法太单纯了。在我离职后没多久的 12 月初，公司开始进行大规模 N+1 裁员，难怪之前不停劝退我，原来是为了省掉 N+1 的钱，恭喜他们，省下了对我来说算得上是救命钱的 10 万块，可能是要把这笔钱投入到他们的公益慈善事业中去吧，是我格局小了。</p><p>因为当时身在局中，所以不太看得明白，之后跟朋友聊起这些事，朋友很直白地告诉我，从结果往前反推的话，整件事情的脉络就十分清晰了：因为跟朋友们聊的时候他们知道我的具体病情，CTO 所谓的让移动端带头 996 的时候，就已经是在针对我了，虽然在这之前的刚过完年给我涨过一次薪，但类比之后「大前端」，这么操作只是为了避免太过直接显得刻意针对而已。公司其他部门都不加班，单单让移动端加班，本就很反常。在我得了患病的情况下，坚持带病无偿 996 加班公司不仅没有任何认可，3、4 月份继续加码逼迫无偿 007，已经是赤裸裸逼我走，因为他们觉得我肯定扛不住，没想到我竟然还坚持下来了，所以 4 月份他们就直接动手把我 Leader 撤了，然后用涨薪的许诺先稳住我，再把我招进来的员工一个个都裁撤掉，接着食言不给我之前许诺的涨薪，此时我只剩孤身一人对他们构不成任何威胁。对了，前面 CEO 给的 1 万块是拿来稳住我的不是奔着帮我，因为之后公司要用补偿三周的方式裁掉其他部门同事时，有一个 UI 小姐姐（阿菲）受不了打算号召大家集体仲裁，CEO 也熟练地掏出了 1 万块，到这个时候我才明白，都是套路。</p><p>在确诊后他们不停质疑我的工作能力，而我为了证明我的病情不影响我的工作能力只能不断加班（看三月份的加班表就知道了），所以有意思的是，为了不被公司找借口拿我的病情说事，我还得付出比以前正常时更多的工作量和工作时间。但并没有什么用，因为他们是奔着劝退我的目标去的，不加班就说工作投入度不高，加班了就挑刺没达到运营数据指标，最后把我 Leader 都撤了之后 CTO 仍然三天两头找我谈话挑我刺，即使此时我的直属上级已经不是他了。我没有得到过任何主动的帮助，甚至相反，我面对的是主动的恶意。只能说我从一开始就没想到这样一群履历光鲜的人，“来自硅谷、小红书、阿里、微软、百度等的 一群创业者”，会这样对我一个患病的人吧。</p><h2 id="现公司"><a href="#现公司" class="headerlink" title="现公司"></a>现公司</h2><p>2019 年的 11 月上旬入职了潮玩族，也就是回响科技。其实刚换了工作每月收入反而少了，因为我没有把上家公司的「补助」说成是自己的薪水，但终于到了一个可以正常工作的环境。</p><p>其实中间过程也有一些曲折，最终去了回响。既不是因为回响的薪资更高也不是因为其他公司背调没有通过或者其它一些原因，而是因为在知道我身体不是很好后他们仍然选择接纳我，虽然我没有向他们透露具体的病情，只是表示等治好了再告诉他们具体情况。</p><p>进入公司后正常工作，每月去医院随访检查。就这样一直到 2020 年的 8 月，此时我已经药物维持治疗两年了，我做了相应的检测，结果没有转阴。经过确诊后不断的自我学习，我明白这个检测结果意味着服药可能无法使我获得治愈，所以我在 9 月底请了一天病假，去找治疗这个分型比较权威的教授门诊，希望能给出有机会获得治愈的治疗方案，他看完我的病历与各项检查报告后表示如果刚开始就去他那里治疗结果可能会比现在好，既然现在已经服药维持了这么长时间并且看起来情况还算稳定，之后我可以在合适的时候去住院进行根治性治疗。</p><p>此后，我一边做入院治疗的各项准备，一边继续工作攒钱。2021 年 3 月发完年终奖后，我终于凑够了住院治疗需要的 30 多万，然后向公司告知了具体病情并表示接下来可能会需要住院治疗一段时间。CEO 沈振宇在得知我的具体病情后，表示如果在疾病治疗上有经济困难可以直接找他开口，并且先不用考虑怎么还的问题。因为他有校友得过类似的疾病（和我差一个分型），所以他可能对我的疾病也有一定的了解。说实话我挺感动的，确诊到现在第一次有人在得知我的病情后愿意给我提供实质性的帮助。尤其是在经过前公司的一系列事情之后。当然我事后也对 HR Nicole 说，不能因为我目前在这家公司工作，CEO 就倒了霉似的要给我这笔钱帮助我，如果真的有一天我撑不住了，肯定会是公开病情寻求所有人的帮助。下图是过去两年医保系统记录的医疗费用汇总：</p><p><img src="/images/IMG_13.png" alt="医疗费用汇总"></p><p>接下来的时间里因为等待新药上市、疫情等原因，中间延期了两次，最后于 9 月初，我请了病假准备住院做根治性治疗。在写这篇文章时，我正在忙着住院前的核酸检测、医院的原始检测材料、异地医保等的办理。</p><p>如果我不告诉别人我的病情，也许没有人能看得出我是一个病人。当然了，除了大家都对我戴的“痛苦面具”感到好奇以外。</p><p><img src="/images/IMG_3.png" alt="3M防毒面具"></p><h2 id="感谢"><a href="#感谢" class="headerlink" title="感谢"></a>感谢</h2><p>感谢倪雪萍、王顺扬、忧伤珲舞、周国建、Yuu（郑宇琦）、ToothLess、SunnyYoung、Andself、肖玮荣、moscato、Evan、吕晨、周锦林、黄辰学长、何翌、tung、王浙剑、于德志、世杰、欧阳日鹏、胡尼玛、李蕊、DarrenW、周凌宇、芮寅康、Cathy、Laker、倪瑶、李楠、李奎、Nicole（王茜）、沈强、MM（郑宜东）、瓜神、XY、李一丹、刘金龙、吴家欢、POJO 博士、粉总、沈振宇、AidenRao、黄河、王杰、毕海湉、小胖、刘庆、肖子浩、丹哥、王世超、钱弘扬、L、小文姐、梧桐、雪碧、洪帮主、笛子姐等所有在过程中对我提供过关心、鼓励和帮助的朋友，祝大家诸事顺利。</p><p>同时也希望所有朋友身体健康，不要像我一样逛医院如喝水吃饭，当然了，为了以防万一还是请务必给自己和家人买好商业保险。</p><h2 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h2><p>有人就要问了，住院治个病而已，弄得像道别似的这么隆重，最后屁事没有五年、十年以后还在蹦跶就太打脸了。</p><p>我想说：还有这种好事？</p><hr><blockquote><p>如有任何知识产权、版权问题或理论错误，还请指正。<br><a href="https://www.eyrefree.org/2021/09/25/Before-Hospitalization">https://www.eyrefree.org/2021/09/25/Before-Hospitalization</a><br>如文中无特殊说明，本站均使用以下协议保护：<a href="http://creativecommons.org/licenses/by-nc-nd/3.0/cn/">署名-非商业性使用-禁止演绎</a>。   </p></blockquote>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Nothing </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>EyreFree 的茶叶店</title>
      <link href="/2021/02/22/Tea/"/>
      <url>/2021/02/22/Tea/</url>
      
        <content type="html"><![CDATA[<p>EyreFree 老家自营茶场，新茶上市啦，碧螺春（新茶）666 元&#x2F;斤，欢迎选购！</p><p>另现货供应各种茶叶：</p><table><thead><tr><th align="left">序号</th><th align="left">品名</th><th align="left">单价（元 &#x2F; 斤）</th></tr></thead><tbody><tr><td align="left">1</td><td align="left">宜兴红茶（普通）</td><td align="left">240</td></tr><tr><td align="left">2</td><td align="left">宜兴红茶（中档）</td><td align="left">350</td></tr><tr><td align="left">3</td><td align="left">宜兴红茶（高档）</td><td align="left">460</td></tr><tr><td align="left">4</td><td align="left">宜兴红茶（特等）</td><td align="left">580</td></tr><tr><td align="left">5</td><td align="left">碧螺春（普通）</td><td align="left">260</td></tr><tr><td align="left">6</td><td align="left">碧螺春（中档）</td><td align="left">380</td></tr><tr><td align="left">7</td><td align="left">碧螺春（高档）</td><td align="left">500</td></tr><tr><td align="left">8</td><td align="left">碧螺春（特等）</td><td align="left">600</td></tr><tr><td align="left">9</td><td align="left">碧螺春（新茶）</td><td align="left">666</td></tr><tr><td align="left">10</td><td align="left">宜兴白茶（高档）</td><td align="left">888</td></tr><tr><td align="left">11</td><td align="left">宜兴白茶（特等）</td><td align="left">1200</td></tr><tr><td align="left">12</td><td align="left">金骏眉（高档）</td><td align="left">888</td></tr><tr><td align="left">13</td><td align="left">金骏眉（特等）</td><td align="left">1200</td></tr><tr><td align="left">14</td><td align="left">黄金叶（高档）</td><td align="left">1200</td></tr><tr><td align="left">15</td><td align="left">黄金叶（特等）</td><td align="left">2333</td></tr></tbody></table><p>有冷库保鲜，一年四季供应鲜茶，并有老红茶 &#x2F; 机制红茶专供养壶。另供应各种机制 &#x2F; 手工绿茶，价格优惠，送礼 &#x2F; 自用佳品（礼盒可选配，单独付费）。</p><p>购买总价满 300 RMB 包邮（偏远地区另议），支持微信 &#x2F; 支付宝 &#x2F; 银行卡转账。</p><p>QQ：1795179491<br>微信：EyreFree<br>邮箱：<a href="mailto:&#101;&#121;&#114;&#x65;&#102;&#x72;&#101;&#101;&#64;&#101;&#x79;&#x72;&#101;&#102;&#114;&#x65;&#101;&#x2e;&#111;&#x72;&#103;">&#101;&#121;&#114;&#x65;&#102;&#x72;&#101;&#101;&#64;&#101;&#x79;&#x72;&#101;&#102;&#114;&#x65;&#101;&#x2e;&#111;&#x72;&#103;</a></p><hr><blockquote><p>如有任何知识产权、版权问题或理论错误，还请指正。<br><a href="https://www.eyrefree.org/2021/02/22/Tea">https://www.eyrefree.org/2021/02/22/Tea</a><br>如文中无特殊说明，本站均使用以下协议保护：<a href="http://creativecommons.org/licenses/by-nc-nd/3.0/cn/">署名-非商业性使用-禁止演绎</a>。   </p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Other </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Other </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Flutter 与 Swift 混编项目启用 Bitcode</title>
      <link href="/2020/11/17/Flutter-Bitcode/"/>
      <url>/2020/11/17/Flutter-Bitcode/</url>
      
        <content type="html"><![CDATA[<p>因为手头在做的项目是 Flutter 与 Swift 混编的，然后之前是已经启用 Bitcode 的，刚接入 Flutter 的时候，我把 Bitcode 的各种设置都启用了，比如：</p><ol><li>将各个 target 的 <code>Enable Bitcode</code> 选项设为 <code>Yes</code>；</li><li>在 <code>Podfile</code> 尾部添加如下代码将 pod 的 <code>Enable Bitcode</code> 打开：</li></ol><figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">post_install <span class="keyword">do</span> |<span class="params">installer</span>|</span><br><span class="line">  installer.pods_project.targets.each <span class="keyword">do</span> |<span class="params">target</span>|</span><br><span class="line">    target.build_configurations.each <span class="keyword">do</span> |<span class="params">config</span>|</span><br><span class="line">      config.build_settings[<span class="string">&#x27;ENABLE_BITCODE&#x27;</span>] = <span class="string">&#x27;YES&#x27;</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p>但 Archive 时会报错，类似如下的错误输出：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">bitcode bundle could not be generated because <span class="string">&#x27;/.../.ios/Flutter/engine/Flutter.framework/Flutter&#x27;</span> was built without full bitcode. All frameworks and dylibs <span class="keyword">for</span> bitcode must be generated from Xcode Archive or Install build file <span class="string">&#x27;/.../.ios/Flutter/engine/Flutter.framework/Flutter&#x27;</span> <span class="keyword">for</span> architecture armv7</span><br></pre></td></tr></table></figure><p>找了一圈得到的回复基本都是 <code>修改 pod 库的 ENABLE_BITCODE = NO（因为 Flutter 现在不支持 bitcode）</code>，所以暂时关闭了。</p><p>但最近包体积膨胀得厉害，所以又回头来找找解决方案，毕竟 Flutter 官方是号称支持 Bitcode 的，而且还一本正经地搞了一个 <a href="https://github.com/flutter/flutter/wiki/Creating-an-iOS-Bitcode-enabled-app">Creating an iOS Bitcode enabled app</a> 文档。</p><p>果然最后在 issue 里翻到了 <a href="https://github.com/flutter/flutter/issues/48092#issuecomment-577345215">解决方案</a>：</p><p>在 Archive 之前终端切换到 flutter 模块下执行一次 <code>flutter build ios --release</code> 然后再 Archive 就可以了，已成功提交审核并上架 App Store，Adhoc 包也没问题。</p><p><img src="https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1605613608337&di=c1eb216cb8a9c37b0ed37b622cb7249c&imgtype=0&src=http://b-ssl.duitang.com/uploads/item/201703/07/20170307134555_jtF2H.thumb.700_0.jpeg" alt="想不到吧"></p><p>顺便贴一下我的 flutter doctor 输出：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[✓] Flutter (Channel unknown, 1.22.3, on Mac OS X 10.15.5 19F96, locale</span><br><span class="line">    zh-Hans-CN)</span><br><span class="line">    • Flutter version 1.22.3 at /Users/eyrefree/Documents/Tools/flutter</span><br><span class="line">    • Framework revision 8874f21e79 (3 weeks ago), 2020-10-29 14:14:35 -0700</span><br><span class="line">    • Engine revision a1440ca392</span><br><span class="line">    • Dart version 2.10.3</span><br><span class="line">    • Pub download mirror https://pub.flutter-io.cn</span><br><span class="line">    • Flutter download mirror https://storage.flutter-io.cn</span><br><span class="line"></span><br><span class="line">[✓] Android toolchain - develop <span class="keyword">for</span> Android devices (Android SDK version 30.0.0)</span><br><span class="line">    • Android SDK at /Users/eyrefree/Library/Android/sdk</span><br><span class="line">    • Platform android-30, build-tools 30.0.0</span><br><span class="line">    • ANDROID_HOME = /Users/eyrefree/Library/Android/sdk</span><br><span class="line">    • Java binary at: /Applications/Android</span><br><span class="line">      Studio.app/Contents/jre/jdk/Contents/Home/bin/java</span><br><span class="line">    • Java version OpenJDK Runtime Environment (build</span><br><span class="line">      1.8.0_242-release-1644-b3-6222593)</span><br><span class="line">    • All Android licenses accepted.</span><br><span class="line"></span><br><span class="line">[✓] Xcode - develop <span class="keyword">for</span> iOS and macOS (Xcode 12.2)</span><br><span class="line">    • Xcode at /Applications/Xcode.app/Contents/Developer</span><br><span class="line">    • Xcode 12.2, Build version 12B45b</span><br><span class="line">    • CocoaPods version 1.10.0</span><br><span class="line"></span><br><span class="line">[✓] Android Studio (version 4.0)</span><br><span class="line">    • Android Studio at /Applications/Android Studio.app/Contents</span><br><span class="line">    • Flutter plugin version 46.0.2</span><br><span class="line">    • Dart plugin version 193.7361</span><br><span class="line">    • Java version OpenJDK Runtime Environment (build</span><br><span class="line">      1.8.0_242-release-1644-b3-6222593)</span><br><span class="line"></span><br><span class="line">[✓] VS Code (version 1.51.0)</span><br><span class="line">    • VS Code at /Applications/Visual Studio Code.app/Contents</span><br><span class="line">    • Flutter extension version 3.16.0</span><br></pre></td></tr></table></figure><hr><blockquote><p>如有任何知识产权、版权问题或理论错误，还请指正。<br><a href="https://www.eyrefree.org/2020/11/17/Flutter-Bitcode">https://www.eyrefree.org/2020/11/17/Flutter-Bitcode</a><br>如文中无特殊说明，本站均使用以下协议保护：<a href="http://creativecommons.org/licenses/by-nc-nd/3.0/cn/">署名-非商业性使用-禁止演绎</a>。   </p></blockquote>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Swift </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>如何实现通过 NFC 标签唤起 App Clips</title>
      <link href="/2020/09/27/NFC-AppClips/"/>
      <url>/2020/09/27/NFC-AppClips/</url>
      
        <content type="html"><![CDATA[<p>Apple 在 WWDC2020 推出 App Clips 之后引起了不少相关的讨论，很多同学对这种 iOS 平台的 <code>小程序</code> 感到很好奇，下面我们就来看看如何通过 NFC 标签来唤起 App Clips 吧。</p><h2 id="NFC-简介"><a href="#NFC-简介" class="headerlink" title="NFC 简介"></a>NFC 简介</h2><p>NFC 是 Near Field Communication 的首字母缩写，即近场通信，也被称为近距离无线通信，是一种短距离的高频无线通信技术，通过在单一芯片上集成感应式读卡器、感应式卡片和点对点通信的功能，利用移动设备实现移动支付、电子票务、门禁、移动身份识别、防伪等功能。</p><p><img src="/images/NFC-AppClips-1.jpg" alt="一种 NFC 标签"></p><h3 id="1-起源"><a href="#1-起源" class="headerlink" title="1. 起源"></a>1. 起源</h3><p>大约在 2003 年，索尼公司和飞利浦半导体（现为恩智浦 NXP 半导体）进行合作，计划基于 RFID 研发一种更加安全快捷并且能与之兼容的无线通讯技术，不久后双方联合对外发布了一种兼容 IS014443 非接触式卡协议的无线通讯技术，取名为 NFC，具体通信规范称作 <a href="https://www.ecma-international.org/publications/files/ECMA-ST/ECMA-340.pdf">NFCIP-1</a> 规范。随后，索尼、飞利浦与诺基亚一起，创建 NFC 论坛，开始推广 NFC 的应用。</p><h3 id="2-原理"><a href="#2-原理" class="headerlink" title="2. 原理"></a>2. 原理</h3><p>NFC 是一种短距高频的无线电技术，NFCIP-1 标准规定 NFC 的通信距离为 10 厘米以内，运行频率 13.56 MHz，传输速度有106 Kbit&#x2F;s、212 Kbit&#x2F;s 或者 424 Kbit&#x2F;s 三种。NFCIP-1 标准详细规定 NFC 设备的传输速度、编解码方法、调制方案以及射频接口的帧格式，此标准中还定义了 NFC 的传输协议，其中包括启动协议和数据交换方法等。</p><p>NFC 工作模式分为被动模式和主动模式：</p><ul><li>被动模式</li></ul><p>NFC 发起设备（也称为主设备）利用供电设备的能量来提供射频场，并将数据发送到 NFC 目标设备（也称作从设备）。根据电磁感应原理，从设备利用主设备产生的射频场转换为电能，为从设备的电路供电，接收主设备发送的数据，并且以相同的速度将从设备数据传回主设备。</p><ul><li>主动模式</li></ul><p>发起设备和目标设备在向对方发送数据时，都必须主动产生射频场，所以称为主动模式，它们都需要供电设备来提供产生射频场的能量。这种通信模式可以获得非常快速的连接速率。</p><h3 id="3-应用"><a href="#3-应用" class="headerlink" title="3. 应用"></a>3. 应用</h3><h4 id="支付应用"><a href="#支付应用" class="headerlink" title="支付应用"></a>支付应用</h4><p>NFC 支付主要是指带有 NFC 功能的手机虚拟成银行卡、一卡通等的应用。</p><p><img src="/images/NFC-AppClips-2.jpg" alt="地铁、公交"></p><h4 id="安防应用"><a href="#安防应用" class="headerlink" title="安防应用"></a>安防应用</h4><p>NFC 安防的应用主要是将手机虚拟成门禁卡、电子门票等。 NFC 虚拟门禁卡就是将现有的门禁卡数据写入手机的 NFC，使用手机就可以实现门禁功能，门禁的配置、监控和修改等都会变得十分方便，而且可以实现远程修改和配置，例如在需要时临时分发凭证卡等。 </p><p><img src="/images/NFC-AppClips-3.jpg" alt="门禁卡"></p><h4 id="标签应用"><a href="#标签应用" class="headerlink" title="标签应用"></a>标签应用</h4><p>NFC 标签应用就是把一些信息写入一个 NFC 标签内， 用户只需用 NFC 手机或准备好的设备在 NFC 标签上挥一挥就可以立即获得相关的信息。例如商家可以把含有海报、促销信息、广告的 NFC 标签放在店门口，用户可以根据自己的需求用NFC手机获取相关的信息。</p><p><img src="/images/NFC-AppClips-4.jpg" alt="amiibo"></p><h2 id="App-Clips-创建"><a href="#App-Clips-创建" class="headerlink" title="App Clips 创建"></a>App Clips 创建</h2><p>唔，这里以 <a href="https://github.com/EFPrefix/EFQRCode/tree/appclips">EFQRCode</a> 的 iOS Demo 为例进行演示。</p><h3 id="1-开发环境和设备"><a href="#1-开发环境和设备" class="headerlink" title="1. 开发环境和设备"></a>1. 开发环境和设备</h3><p>首先请安装好 Xcode 12，然后请准备一台已经升级到 iOS 14 的<a href="https://www.bluebite.com/nfc/iphone-nfc-compatibility">支持 NFC 的 iOS 设备</a>用于测试，我这里是用的是 iPhone X。</p><table><thead><tr><th align="right"></th><th align="center">Has NFC</th><th align="center">Card Emulation</th><th align="center">NFC Payments</th><th align="center">Reads NFC</th><th align="center">Writes NFC</th></tr></thead><tbody><tr><td align="right">iPhone 11, 11 Pro &#x2F; Max, SE (2nd Gen)</td><td align="center">✓</td><td align="center">✓</td><td align="center">✓</td><td align="center">✓</td><td align="center">✓</td></tr><tr><td align="right">iPhone XS, XS Max, XR</td><td align="center">✓</td><td align="center">✓</td><td align="center">✓</td><td align="center">✓</td><td align="center">✓</td></tr><tr><td align="right">iPhone X, 8, 8+, 7, 7+</td><td align="center">✓</td><td align="center">✓</td><td align="center">✓</td><td align="center">✓*</td><td align="center">✓</td></tr><tr><td align="right">iPhone 6, 6+, 6S, 6S+, SE (1st Gen)</td><td align="center">✓</td><td align="center">✓</td><td align="center">✓</td><td align="center">✗</td><td align="center">✗</td></tr><tr><td align="right">iPhone 5S, 5C, 5, 4S, 4, 3GS, 3G</td><td align="center">✗</td><td align="center">✗</td><td align="center">✗</td><td align="center">✗</td><td align="center">✗</td></tr></tbody></table><h3 id="2-创建-App-Clip-Target"><a href="#2-创建-App-Clip-Target" class="headerlink" title="2. 创建 App Clip Target"></a>2. 创建 App Clip Target</h3><p>切换到 Project 的 Targets 列表，点击左下角 <code>+</code> 号找到 <code>App Clip</code> 项目，添加 Target：</p><p><img src="/images/NFC-AppClips-5.png" alt="创建 Target"></p><h3 id="3-apple-app-site-association"><a href="#3-apple-app-site-association" class="headerlink" title="3. apple-app-site-association"></a>3. apple-app-site-association</h3><p>扫描 NFC 标签打开对应 App Clips &#x2F; App 实际上是读取了 NFC 标签数据区的 URL 然后打开该 URL 绑定的 App Clips &#x2F; App，听起来是不是和 Universal Link 很像？所以类似地，需要在想关联的域名下添加 <code>apple-app-site-association</code> 文件，并在其中写入 <code>appclips</code> 对应的内容，<code>apps</code> 值格式为 <code>DevelopmentTeamID.BundleID</code>（DevelopmentTeamID 和 BundleID 请替换为你自己的），下面是 <a href="http://efqrcode.com/apple-app-site-association">EFQRCode 的</a>：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;appclips&quot;: &#123;</span><br><span class="line">        &quot;apps&quot;: [&quot;P3X2725LYY.AppStore.EFQRCode.Clip&quot;]</span><br><span class="line">    &#125;</span><br><span class="line">    &quot;applinks&quot;: &#123;</span><br><span class="line">        &quot;apps&quot;: [],</span><br><span class="line">        &quot;details&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">                &quot;appID&quot;: &quot;P3X2725LYY.AppStore.EFQRCode&quot;,</span><br><span class="line">                &quot;paths&quot;: [ &quot;*&quot; ]</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>同时我们切换到刚创建的 App Clip 的 <code>Signing &amp; Capabilities</code> 选项卡下，点击左上角的 <code>+ Capability</code> 添加 <code>Associated Domains</code>，EFQRCode 的如下：</p><p><img src="/images/NFC-AppClips-6.png" alt="Associated Domains"></p><h3 id="4-Hello-World"><a href="#4-Hello-World" class="headerlink" title="4. Hello World"></a>4. Hello World</h3><p>此时我们在 Xcode 左上角选择 Clip 的 Scheme 进行编译，可以启动一个带有 Hello World 字样的空的 App Clip。</p><h3 id="5-添加代码获取唤起-Clip-的-URL"><a href="#5-添加代码获取唤起-Clip-的-URL" class="headerlink" title="5. 添加代码获取唤起 Clip 的 URL"></a>5. 添加代码获取唤起 Clip 的 URL</h3><p>打开我们创建的 App Clip，找到入口文件 <code>appclipApp.swift</code> 然后添加如下代码，这里使用的是 SwiftUI 方式进行开发：</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">@main</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">appclipApp</span>: <span class="title class_">App</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">Scene</span> &#123;</span><br><span class="line">        <span class="type">WindowGroup</span> &#123;</span><br><span class="line">            <span class="type">ContentView</span>()</span><br><span class="line">                .onContinueUserActivity(<span class="type">NSUserActivityTypeBrowsingWeb</span>, perform: &#123; userActivity <span class="keyword">in</span></span><br><span class="line">                    <span class="keyword">guard</span> <span class="keyword">let</span> incomingURL <span class="operator">=</span> userActivity.webpageURL,</span><br><span class="line">                          <span class="keyword">let</span> components <span class="operator">=</span> <span class="type">NSURLComponents</span>(url: incomingURL, resolvingAgainstBaseURL: <span class="literal">true</span>),</span><br><span class="line">                          <span class="keyword">let</span> queryItems <span class="operator">=</span> components.queryItems <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="keyword">return</span></span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="built_in">print</span>(incomingURL)</span><br><span class="line">                    <span class="built_in">print</span>(components)</span><br><span class="line">                    <span class="built_in">print</span>(queryItems)</span><br><span class="line">                &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="App-Clip-的-NFC-唤起"><a href="#App-Clip-的-NFC-唤起" class="headerlink" title="App Clip 的 NFC 唤起"></a>App Clip 的 NFC 唤起</h2><h3 id="1-制备-NFC-标签"><a href="#1-制备-NFC-标签" class="headerlink" title="1. 制备 NFC 标签"></a>1. 制备 NFC 标签</h3><p>在唤起 Clip 之前，我们需要先制备能够唤起 Clip 的 NFC 标签，同学们可以在淘宝搜索 <code>NFC 标签贴</code> 买到空白的 NFC 标签，我这边准备的是 <code>ISO 14443-3A</code> 类型的 NFC 便利贴，小小的，可以贴在玩具底座上，如下图所示：</p><p><img src="/images/NFC-AppClips-7.jpg" alt="NFC 便利贴"></p><p>刚买到的 NFC 标签是空白的，并不包含数据，所以用 iPhone 贴近 NFC 标签并不会有任何响应。接下来我们打开 App Store 搜索 NFC Tools 随便找一个 NFC 读写器来完成我们对 NFC 标签的读写，这边我是用的是 <a href="https://apps.apple.com/cn/app/nfc-tools/id1252962749">NFC Tools</a>。</p><p>打开 NFC Tools 选择 <code>读</code> 选项，当 NFC 扫描弹框出现后，将手机的背部摄像头位置靠近我们准备好的 NFC 标签，即可读出标签内的数据（如果没有识别到的话，可以尝试调整位置或扫描姿势，反正我用的 iPhone X 的 NFC 感应器是在摄像头旁边一点的样子），可以看到目前 NFC 标签内是没有写入任何数据的，只有一些基本信息，并且是可写状态，如下图所示：</p><p><img src="/images/NFC-AppClips-8.png" alt="读取空白 NFC 标签内的数据"></p><p>回到 NFC Tools 首页，选择 <code>写</code> -&gt; <code>添加记录</code> -&gt; <code>URL / URI</code>，将我们上面配好的 Associated Domains 地址填入，然后回到写数据页面，点击 <code>写 / 17 字节</code> 选项，再将手机贴近 NFC 标签，等待写入成功。这时，我们再使用 <code>读</code> 功能读取 NFC 标签内的数据，可以看到我们写入的 URL 记录：</p><p><img src="/images/NFC-AppClips-9.png" alt="写入数据"></p><h3 id="2-唤起-Clip"><a href="#2-唤起-Clip" class="headerlink" title="2. 唤起 Clip"></a>2. 唤起 Clip</h3><p>此时我们退出 NFC Tools 回到桌面，将 iPhone 贴近制备好的 NFC 标签，可以看到 iPhone 已经能识别到 NFC 标签内我们写入的 URL，但它并没有唤起我们的 App Clip，而是询问是否用 Safari 打开，这好像和我们的设想有些出入。</p><p><img src="/images/NFC-AppClips-10.jpg" alt="询问是否用 Safari 打开"></p><p>唔，这是因为我们的 Clip 并没有上架，所以 iOS 现在并不知道这个 URL 和我们 App Clip 的绑定关系。这个时候我们可以打开 <code>设置</code> -&gt; <code>开发者</code>，可以看到有 <code>APP CLIP TESTING</code> 一项，点击 <code>Local Experiences</code> -&gt; <code>Register Local Experiences</code> 添加我们的测试数据即可，添加完成后再用 iPhone 靠近 NFC 标签即可成功唤起 Clip：</p><p><img src="/images/NFC-AppClips-11.jpg" alt="唤起 Clip"></p><p>唤起成功啦，接下来就可以动手给 Clip 添加内容了呢。</p><h2 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h2><p>本文代码可从 <a href="https://github.com/EFPrefix/EFQRCode/tree/appclips">https://github.com/EFPrefix/EFQRCode/tree/appclips</a> 获取，有一些上文没有提到但需要注意的点：</p><ul><li>一个 App 能且只能拥有一个 App Clip；</li><li>App Clip 的包大小上限为 10M，如何合理封装、复用现有代码，需要花一些时间思考；</li><li>如果用户已经安装了 App，那么会直接唤起 App 而不是 Clip。</li></ul><p>那么问题来了，实际生活中有哪些业务需求可以用到这个酷炫的能力呢？小伙伴们需要自己思考啦…</p><p>本文编写过程中参考了以下文章，在此对原作者们表示感谢：</p><ul><li><a href="https://onevcat.com/2020/06/first-look-app-clips/">一些关于 App Clips 的笔记</a></li><li><a href="http://www.cocoachina.com/articles/899697">App Clips简介以及demo演示</a></li><li><a href="https://www.bluebite.com/nfc/iphone-nfc-compatibility">iPhone NFC Compatibility</a></li></ul><hr><blockquote><p>如有任何知识产权、版权问题或理论错误，还请指正。<br><a href="https://www.eyrefree.org/2020/09/27/NFC-AppClips">https://www.eyrefree.org/2020/09/27/NFC-AppClips</a><br>如文中无特殊说明，本站均使用以下协议保护：<a href="http://creativecommons.org/licenses/by-nc-nd/3.0/cn/">署名-非商业性使用-禁止演绎</a>。   </p></blockquote>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Swift </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CocoaPods installed but not initialized. Skipping pod install</title>
      <link href="/2019/10/17/CocoaPods-Flutter-CDN/"/>
      <url>/2019/10/17/CocoaPods-Flutter-CDN/</url>
      
        <content type="html"><![CDATA[<p>流水账警告，⚠️</p><hr><p>CocoaPods <a href="http://blog.cocoapods.org/CocoaPods-1.8.0-beta/">1.8.0</a> 支持了 CDN，速度比以前快了很多，这么棒当然是赶紧用起来了，于是推动组内升到了 1.8.3 并移除了无用的 repo，然后 Jenkins 打包就炸了，发现报错：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/Users/XXX/Desktop/jenkinsWorkspace/workspace/x_iOS/XXX/XXX-Bridging-Header.h:60:9: &#x27;FlutterPluginRegistrant/GeneratedPluginRegistrant.h&#x27; file not found</span><br></pre></td></tr></table></figure><p>唔，看起来是依赖的 Flutter 模块炸了，去 Flutter 的打包日志看看，找到如下报错：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Build...</span><br><span class="line">Warning: Building for device with codesigning disabled. You will have to manually codesign before deploying to device.</span><br><span class="line">Building com.x w s.XXX for device (ios-release)...</span><br><span class="line">Warning: CocoaPods installed but not initialized. Skipping pod install.</span><br><span class="line">  CocoaPods is used to retrieve the iOS platform side&#x27;s plugin code that responds to your plugin usage on the Dart side.</span><br><span class="line">  Without resolving iOS dependencies with CocoaPods, plugins will not work on iOS.</span><br><span class="line">  For more info, see https://flutter.io/platform-plugins</span><br><span class="line">To initialize CocoaPods, run:</span><br><span class="line">  pod setup</span><br><span class="line">once to finalize CocoaPods&#x27; installation.</span><br><span class="line">Running Xcode build...                                          </span><br><span class="line">Xcode build done.                                           57.4s</span><br><span class="line">Failed to build iOS app</span><br><span class="line">Error output from Xcode build:</span><br><span class="line">↳</span><br><span class="line">    ** BUILD FAILED **</span><br></pre></td></tr></table></figure><p>噫，<code>pod install</code> 被跳过了？切到打包机执行了 <code>flutter doctor</code> 命令，查看一下是不是 flutter 环境坏掉了：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Doctor summary (to see all details, run flutter doctor -v):</span><br><span class="line">[✓] Flutter (Channel beta, v1.3.8, on Mac OS X 10.14.6 18G95, locale zh-Hans-CN)</span><br><span class="line">[✓] Android toolchain - develop for Android devices (Android SDK version 28.0.3)</span><br><span class="line">[!] iOS toolchain - develop for iOS devices (Xcode 11.1)</span><br><span class="line">    ✗ CocoaPods installed but not initialized.</span><br><span class="line">        CocoaPods is used to retrieve the iOS platform side&#x27;s plugin code that responds to your plugin usage on the Dart side.</span><br><span class="line">        Without resolving iOS dependencies with CocoaPods, plugins will not work on iOS.</span><br><span class="line">        For more info, see https://flutter.io/platform-plugins</span><br><span class="line">      To initialize CocoaPods, run:</span><br><span class="line">        pod setup</span><br><span class="line">      once to finalize CocoaPods&#x27; installation.</span><br><span class="line">[✓] Android Studio (version 3.2)</span><br><span class="line">[!] Connected device</span><br><span class="line">    ! No devices available</span><br></pre></td></tr></table></figure><p>唔，出现了一样的报错，看起来是升级 CocoaPods 导致的异常。按日志的提示我们执行了 <code>pod setup</code>，操作成功！ <code>flutter doctor</code> 报错依旧。咦，怎么肥事？经过 <a href="https://github.com/flutter/flutter/issues/41291">一番搜索</a> 发现，CocoaPods 1.8.x 以下在 setup 时初始化的 repo 是 <code>master</code>，而 1.8.x 已经不再是这个了：</p><p><img src="/images/CocoaPods-Flutter-CDN-1.png"></p><p>但不知道是 flutter 还是 CocoaPods 的问题（可能是因为我们用的 flutter 版本低了，是 1.3.8），打包过程会通过检测旧版本的主 repo 是否存在来判断 CocoaPods 是否已经初始化，所以我们需要先切换到 1.7.5，然后执行 <code>pod setup</code>，再切回 1.8.3 即可，<code>flutter doctor</code> 显示正常，打包也恢复正常了。</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo gem uninstall cocoapods</span><br><span class="line">sudo gem install cocoapods -v 1.7.5</span><br><span class="line">pod setup</span><br></pre></td></tr></table></figure><p>然后再安装最新版 CocoaPods 就可以了：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo gem install cocoapods</span><br></pre></td></tr></table></figure><p>提示：记住这里千万不要删除多余的 repo，不然你就会像我一样需要白忙活 2 个小时，首尾呼应，完结撒花。</p><hr><blockquote><p>如有任何知识产权、版权问题或理论错误，还请指正。<br><a href="https://www.eyrefree.org/2019/10/17/CocoaPods-Flutter-CDN">https://www.eyrefree.org/2019/10/17/CocoaPods-Flutter-CDN</a><br>如文中无特殊说明，本站均使用以下协议保护：<a href="http://creativecommons.org/licenses/by-nc-nd/3.0/cn/">署名-非商业性使用-禁止演绎</a>。   </p></blockquote>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CocoaPods </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>GitHub 项目 README 展示使用本开源库的 App</title>
      <link href="/2019/04/06/GitHub-ReadMe-Apps/"/>
      <url>/2019/04/06/GitHub-ReadMe-Apps/</url>
      
        <content type="html"><![CDATA[<h2 id="零、前言"><a href="#零、前言" class="headerlink" title="零、前言"></a>零、前言</h2><ol><li>本文展示有引用关系的 App，所以仅针对 iOS &#x2F; Android 库；</li><li>本文依赖 AppSight 的数据实现所述功能，若您的 SDK 无法在 AppSight 检索到，则本文方式无法使用。</li></ol><h2 id="一、找到源数据"><a href="#一、找到源数据" class="headerlink" title="一、找到源数据"></a>一、找到源数据</h2><p>展示使用某库的 App，首先需要找到一个能够提供相应数据的数据源，这里我们依赖的 <a href="https://www.appsight.io/">AppSight</a>，这里以 <a href="https://github.com/EFPrefix/EFCountingLabel">EFCountingLabel</a> 为例，我们在 上找到它对应的页面 <a href="https://www.appsight.io/sdk/ef-counting-label">https://www.appsight.io/sdk/ef-counting-label</a>，打开后可看到相关引用数据，如下所示：</p><p><img src="https://user-gold-cdn.xitu.io/2019/4/6/169f0f80e72751bc?w=1288&h=917&f=png&s=200364"></p><h2 id="二、加载所有数据"><a href="#二、加载所有数据" class="headerlink" title="二、加载所有数据"></a>二、加载所有数据</h2><p>数据有了，接下来我们可以用脚本爬取的方式获取想要的数据，这里为了便于调试，笔者使用了 JavaScript，在 Chrome 的 Console 里执行就可以直接获取我们想要的结果。</p><p>由于此处的引用数据是有分页的，那么爬取之前，我们先要写一段脚本来循环点击分页加载按钮，帮助我们自动加载所有的分页数据（如果数据量少的话意义不是很大，但是数据量多的话，这一步就很有必要了）。</p><p>在 SDK 页面，打开 Chrome 开发者工具中的 <code>JavaScript 控制台</code>，执行如下脚本即可：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">sleep</span>(<span class="params">ms</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> <span class="built_in">setTimeout</span>(resolve, ms));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>) &#123;</span><br><span class="line"><span class="keyword">var</span> using = <span class="variable language_">document</span>.<span class="title function_">getElementsByClassName</span>(<span class="string">&#x27;as-sec-apps-using&#x27;</span>)[<span class="number">0</span>];</span><br><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="title function_">getElementsByClassName</span>(<span class="string">&#x27;as-sec-loading&#x27;</span>)[<span class="number">0</span>].<span class="property">style</span>.<span class="property">cssText</span> == <span class="string">&quot;display: block;&quot;</span>) &#123;</span><br><span class="line"><span class="keyword">await</span> <span class="title function_">sleep</span>(<span class="number">1000</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (using.<span class="title function_">getElementsByClassName</span>(<span class="string">&#x27;as-but as-but-more btn disabled&#x27;</span>)[<span class="number">0</span>] == <span class="literal">null</span>) &#123;</span><br><span class="line">using.<span class="title function_">getElementsByClassName</span>(<span class="string">&#x27;as-but as-but-more btn&#x27;</span>)[<span class="number">0</span>].<span class="title function_">click</span>();</span><br><span class="line"><span class="keyword">await</span> <span class="title function_">sleep</span>(<span class="number">1000</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125; <span class="keyword">while</span> (<span class="literal">true</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">main</span>();</span><br></pre></td></tr></table></figure><h2 id="三、生成-HTML-代码"><a href="#三、生成-HTML-代码" class="headerlink" title="三、生成 HTML 代码"></a>三、生成 HTML 代码</h2><p>所有分页数据加载完成（或者达到你需要的数量）后，继续在 <code>JavaScript 控制台</code>，执行如下脚本：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> using = <span class="variable language_">document</span>.<span class="title function_">getElementsByClassName</span>(<span class="string">&#x27;as-sec-apps-using&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">var</span> items = using.<span class="title function_">getElementsByClassName</span>(<span class="string">&#x27;as-list-item-inner&#x27;</span>)</span><br><span class="line"><span class="keyword">var</span> result = <span class="string">&quot;&lt;table&gt;&lt;tr&gt;&quot;</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>, len = items.<span class="property">length</span>; i &lt; len; i++) &#123;</span><br><span class="line"><span class="keyword">if</span>(i % <span class="number">10</span> == <span class="number">0</span> &amp;&amp; i &gt; <span class="number">0</span>) &#123;</span><br><span class="line">result = result + <span class="string">&quot;&lt;/tr&gt;&lt;tr&gt;&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">let</span> item = items[i]</span><br><span class="line">    <span class="keyword">var</span> icon = item.<span class="title function_">getElementsByClassName</span>(<span class="string">&#x27;as-icon&#x27;</span>)[<span class="number">0</span>].<span class="property">src</span>;</span><br><span class="line">    <span class="keyword">var</span> title = item.<span class="title function_">getElementsByClassName</span>(<span class="string">&#x27;as-label as-name&#x27;</span>)[<span class="number">0</span>].<span class="property">innerHTML</span>;</span><br><span class="line">    <span class="keyword">var</span> href = item.<span class="property">href</span></span><br><span class="line">    result = result + <span class="string">&quot;&lt;td&gt;&lt;a href=\&#x27;&quot;</span> + href + <span class="string">&quot;\&#x27; title=\&#x27;&quot;</span> + title + <span class="string">&quot;\&#x27;&gt;&lt;img src=\&#x27;&quot;</span> + icon + <span class="string">&quot;\&#x27;&gt;&lt;/a&gt;&lt;/td&gt;&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">result = result + <span class="string">&quot;&lt;/tr&gt;&lt;/table&gt;&quot;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(result)</span><br></pre></td></tr></table></figure><p>可以获得对应的 App 信息的 HTML 代码，如下所示：</p><p><img src="https://user-gold-cdn.xitu.io/2019/4/6/169f1408e10d6030?w=1767&h=741&f=png&s=445066"></p><p>获得的代码整理后为如下形式：</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">table</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&#x27;https://www.appsight.io/app/toss-%ED%86%A0%EC%8A%A4&#x27;</span> <span class="attr">title</span>=<span class="string">&#x27;토스&#x27;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#x27;https://d3ixtyf8ei2pcx.cloudfront.net/icons/001/263/485/media/small.png?1530945069&#x27;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&#x27;https://www.appsight.io/app/%EC%87%BC%ED%95%91%EC%9D%84-%EB%9A%9D%EB%94%B1-%ED%8B%B0%EB%AA%AC&#x27;</span> <span class="attr">title</span>=<span class="string">&#x27;티몬 - 오늘은 또 어떤 딜?&#x27;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#x27;https://d3ixtyf8ei2pcx.cloudfront.net/icons/001/286/380/media/small.png?1534301992&#x27;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&#x27;https://www.appsight.io/app/%EB%B1%85%ED%81%AC%EC%83%90%EB%9F%AC%EB%93%9C&#x27;</span> <span class="attr">title</span>=<span class="string">&#x27;뱅크샐러드&#x27;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#x27;https://d3ixtyf8ei2pcx.cloudfront.net/icons/001/282/332/media/small.png?1533591669&#x27;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&#x27;https://www.appsight.io/app/climendo-basic&#x27;</span> <span class="attr">title</span>=<span class="string">&#x27;Climendo Basic&#x27;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#x27;https://d3ixtyf8ei2pcx.cloudfront.net/icons/000/304/533/media/small.png?1481531280&#x27;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="四、嵌入-README-中"><a href="#四、嵌入-README-中" class="headerlink" title="四、嵌入 README 中"></a>四、嵌入 README 中</h2><p>复制我们前面获得的 HTML 代码，直接插入到我们项目 README 的合适位置即可：</p><p><img src="https://user-gold-cdn.xitu.io/2019/4/6/169f1441fa3d0f42?w=1181&h=531&f=png&s=120336"></p><h2 id="五、效果展示"><a href="#五、效果展示" class="headerlink" title="五、效果展示"></a>五、效果展示</h2><p>最后实际效果如下，也可以点击直接查看 <a href="https://github.com/EFPrefix/EFCountingLabel/blob/master/README.md">EFCountingLabel 的 README</a> 进行预览：</p><p><img src="https://user-gold-cdn.xitu.io/2019/4/6/169f144d8c360486?w=995&h=521&f=png&s=156267"></p><p>感兴趣的同学，快自己动手试一试吧，👻</p><hr><p>再读一篇类似文章？</p><p><a href="https://www.eyrefree.org/2017/07/06/GitHub-Wiki-Introduction/">GitHub Wiki 页面的添加和设置</a></p><hr><blockquote><p>如有任何知识产权、版权问题或理论错误，还请指正。<br><a href="https://www.eyrefree.org/2019/04/06/GitHub-ReadMe-Apps/">https://www.eyrefree.org/2019/04/06/GitHub-ReadMe-Apps/</a><br>如文中无特殊说明，本站均使用以下协议保护：<a href="http://creativecommons.org/licenses/by-nc-nd/3.0/cn/">署名-非商业性使用-禁止演绎</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Markdown </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GitHub </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>怎样将信息发布 / 记录到 ETH 网络？</title>
      <link href="/2018/07/25/ETHTransactionData/"/>
      <url>/2018/07/25/ETHTransactionData/</url>
      
        <content type="html"><![CDATA[<p>现在各行各业都在“上链”，大家说的“上链”到底是什么呢？今天，咱就来实际操作一把…</p><hr><p>阅读本文前，请先确保您：</p><ol><li>具备科学上网能力；   </li><li>有钱，能兑换成 ETH 虚拟币用来支付以太坊转账费手续费；   </li><li>有一定的英文阅读能力。</li></ol><hr><h2 id="1-下载-x2F-安装-Chrome"><a href="#1-下载-x2F-安装-Chrome" class="headerlink" title="1. 下载 &#x2F; 安装 Chrome"></a>1. 下载 &#x2F; 安装 Chrome</h2><p>下载谷歌浏览器并安装，官网地址：<a href="https://www.google.com/intl/zh-CN_ALL/chrome/">https://www.google.com/intl/zh-CN_ALL&#x2F;chrome&#x2F;</a></p><p><img src="https://upload-images.jianshu.io/upload_images/1018190-ebc9cd894d955ba7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p><h2 id="2-安装-MetaMask-插件"><a href="#2-安装-MetaMask-插件" class="headerlink" title="2. 安装 MetaMask 插件"></a>2. 安装 MetaMask 插件</h2><p>打开 Chrome 网上应用店，下载 MetaMask 插件 <a href="https://chrome.google.com/webstore/detail/metamask/nkbihfbeogaeaoehlefnkodbefgpgknn?hl=zh-CN">https://chrome.google.com/webstore/detail/metamask/nkbihfbeogaeaoehlefnkodbefgpgknn?hl=zh-CN</a>，这是一个运行在 ETH 网络上的 DAPP，感兴趣的同学可以研究一下它的源码：<a href="https://github.com/MetaMask/metamask-extension">https://github.com/MetaMask/metamask-extension</a>。</p><p><img src="https://upload-images.jianshu.io/upload_images/1018190-31d82c6a4c6dd257.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p><p>然后在 Chrome 内打开 MetaMask，左上角下拉列表可以选择网络类型，我们要用的是第一个 Main Ethereum Network（其他的都是测试网络…）：</p><p><img src="https://upload-images.jianshu.io/upload_images/1018190-5a971e2759060a55.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p><h2 id="3-注册-ETH-钱包"><a href="#3-注册-ETH-钱包" class="headerlink" title="3. 注册 ETH 钱包"></a>3. 注册 ETH 钱包</h2><p>接下来在 MetaMask 内根据提示注册 ETH 钱包（同时也会成为你的 MetaMask 账号），注意将公钥、私钥、助记词、密码之类的信息记录在可靠的地方，丢失的话，你的 ETH 钱包（主要是里面包含的虚拟币）就没啦。</p><p><img src="https://upload-images.jianshu.io/upload_images/1018190-0466beb4abcea283.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p><h2 id="4-给-ETH-账号打钱"><a href="#4-给-ETH-账号打钱" class="headerlink" title="4. 给 ETH 账号打钱"></a>4. 给 ETH 账号打钱</h2><p>新建的 ETH 钱包是木有钱的，而接下来的我们发布信息的操作需要执行转账动作。有的同学可能会问，我们进行一笔总价为 0 ETH 的交易不就行了么？没错，这样的确可以不产生实际的虚拟币转账，不过仍然需要手续费来驱使矿工们将这一笔为 0 的交易记录写入到区块内，也就是每一笔交易只有支付了手续费才有可能发生（手续费是交易发起者自定的，如果手续费过低，可能会出现交易失败）。</p><p>ETH 网络上用到的手续费肯定就是 ETH（以太坊）啦，来源的话，一般是去 <a href="https://www.binance.com/?ref=27965336">币安</a>、<a href="https://otcbtc.com/referrals/EYREFREE">OTCBTC</a> 之类的交易所购买然后从交易所提币到自己的钱包，过程比较繁琐，可以自行研究，这里不多做赘述。</p><p>只是了解 &#x2F; 试用一下，不打算大批量购买的话，找一个有 ETH 的朋友让他转你 0.01 ETH（现价大概 3208.36 * 0.01 &#x3D; 32 RMB）一般就够用了…</p><p><img src="https://upload-images.jianshu.io/upload_images/1018190-e4207d8a72600521.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p><h2 id="5-准备需要发布的信息"><a href="#5-准备需要发布的信息" class="headerlink" title="5. 准备需要发布的信息"></a>5. 准备需要发布的信息</h2><p>接下来就是准备我们需要发布的信息啦，因为需要转码成 Hex String，所以直接试用中文大概是不资瓷的啦，需要先转成拼音，比如我们随便找一段文字，像这样：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">烂是有原因的，[微笑]。大家都愿意吃屎，你不吃，就是你的过错了，[微笑]。***写得再烂，至少还愿意认错，[微笑]。****不止烂，还嘴硬，[微笑]</span><br></pre></td></tr></table></figure><p>然后用 <a href="https://www.chineseconverter.com/zh-cn/convert/chinese-to-pinyin">汉字转拼音工具</a> 转为拼音（注意全角标点符号要自己改成半角哦，然后风格大家可以自选…）：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">lan4 shi4 you3 yuan2 yin1 di2 , [ wei1 xiao4 ] . da4 jia1 du1 yuan4 yi4 chi1 shi3 , ni3 bu4 chi1 , jiu4 shi4 ni3 di2 guo4 cuo4 liao3 , [ wei1 xiao4 ] . * * * xie3 de2 zai4 lan4 , zhi4 shao3 huan2 yuan4 yi4 ren4 cuo4 , [ wei1 xiao4 ] . * * * * bu4 zhi3 lan4 , huan2 zui3 ying4 , [ wei1 xiao4 ] .</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/1018190-a84204c59e10d4dc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p><p>接下来再用 <a href="https://codebeautify.org/string-hex-converter">String 转 Hex 工具</a> 转为 Hex String 即可：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">6c616e34207368693420796f7533207975616e322079696e3120646932202c205b2077656931207869616f34205d202e20646134206a69613120647531207975616e342079693420636869312073686933202c206e6933206275342063686931202c206a6975342073686934206e6933206469322067756f342063756f34206c69616f33202c205b2077656931207869616f34205d202e202a202a202a207869653320646532207a616934206c616e34202c207a686934207368616f33206875616e32207975616e34207969342072656e342063756f34202c205b2077656931207869616f34205d202e202a202a202a202a20627534207a686933206c616e34202c206875616e32207a7569332079696e6734202c205b2077656931207869616f34205d202e</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/1018190-96ba6002d9f3ab2e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p><p>最后可以用 <a href="https://codebeautify.org/hex-string-converter">Hex 转 String 工具</a> 试试看能不能再转回来确认一下有无问题：</p><p><img src="https://upload-images.jianshu.io/upload_images/1018190-96390e6e4d7c14a7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p><h2 id="6-生成一笔交易记录"><a href="#6-生成一笔交易记录" class="headerlink" title="6. 生成一笔交易记录"></a>6. 生成一笔交易记录</h2><p>然后我们继续回到 MetaMask，点击 SEND 按钮开始一笔转账：</p><p><img src="https://upload-images.jianshu.io/upload_images/1018190-ae93d36b52890b79.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p><p>随便填入一个有效的 ETH 接收地址，这里我用的是 0xa666b081583dbe8018af7c7c6e8bb6954c8984d2，然后交易数额填 0，TRANSACTION DATA 就填写刚才生成的 Hex String，然后点击 SEND 就行啦：</p><p><img src="https://upload-images.jianshu.io/upload_images/1018190-806b97ab28a7070b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p><p>接下来是交易确认界面，我们需要将 Gas Price 修改为 2，这样容易更快完成交易：</p><p><img src="https://upload-images.jianshu.io/upload_images/1018190-d094cb44fa8ebdb5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p><p>然后点击 SUBMIT 按钮即可，然后过一会就能在列表中看到这一条交易已完成啦：</p><p><img src="https://upload-images.jianshu.io/upload_images/1018190-4c47251c48893fd9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p><p>点击可以查看详情，比如这一条交易记录可以在这个页面进行查看：<a href="https://etherscan.io/tx/0xff61b121aef8065e6e0a2aeeff5d9fce738b1ba0cbe5e1cd8b51b3509faff903">https://etherscan.io/tx/0xff61b121aef8065e6e0a2aeeff5d9fce738b1ba0cbe5e1cd8b51b3509faff903</a>，翻到下面详情中的 Input Data 选择以 UTF-8 方式预览即可：</p><p><img src="https://upload-images.jianshu.io/upload_images/1018190-409c6b0a8383e8a9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p><p>然后全球所有的 ETH 钱包这时应该都已经同步了这条信息啦，好玩吧，这，就是传说中的，上链。</p><p>还不赶紧自己动手实践一下？​</p><hr><blockquote><p>如有任何知识产权、版权问题或理论错误，还请指正。<br><a href="https://www.eyrefree.org/2018/07/25/ETHTransactionData">https://www.eyrefree.org/2018/07/25/ETHTransactionData</a><br>如文中无特殊说明，本站均使用以下协议保护：<a href="http://creativecommons.org/licenses/by-nc-nd/3.0/cn/">署名-非商业性使用-禁止演绎</a>。   </p></blockquote>]]></content>
      
      
      <categories>
          
          <category> BlockChain </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ETH </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>蜂鸟商家版 iOS 组件化 / 模块化实践总结</title>
      <link href="/2018/01/20/LPDBusinessiOS/"/>
      <url>/2018/01/20/LPDBusinessiOS/</url>
      
        <content type="html"><![CDATA[<p><img src="https://user-gold-cdn.xitu.io/2018/1/19/1610f02b4af3f3d9?w=750&h=400&f=png&s=302366"></p><h2 id="零-前言"><a href="#零-前言" class="headerlink" title="零. 前言"></a>零. 前言</h2><blockquote><p>“蜂鸟配送商家版”是一款针对商家打造的专业配送软件，有了这款应用，您可以使用蜂鸟商家版呼叫所有平台订单及电话订单配送，餐饮、鲜花、蛋糕、生鲜、商超均可配送。超低运费，清晰合理。海量补贴，充值返现。</p></blockquote><p>以上这段对「蜂鸟商家版」的描述摘自 <a href="https://fengniao.ele.me/business.html">蜂鸟配送官网</a>，大概可以理解为蜂鸟商家版是一个给广大商家用来发单呼叫配送员的 App。许多同学可能只听说过「饿了么」外卖应用，但是对支撑起外卖配送的后勤业务「蜂鸟配送」却知之甚少，实际上每天海量的外卖订单都是由蜂鸟配送系统进行处理和配送最终送到消费者手中的。外卖 O2O 是由外卖平台、商户、配送系统这三方合作共同完成的，缺一不可。O2O 最核心的价值就是人与服务的连接，而这种连接最终都是通过配送才得以实现的。</p><p>自 2016 年底开始我参与蜂鸟商家版的维护工作，除了日常的开发迭代以外，期间还参与推进了项目 Swift 化、项目组件化 &#x2F; 模块化、非业务组件开源化等技术改造工作，今天这篇文章就给大家分享一下蜂鸟商家版 iOS 的组件化 &#x2F; 模块化实践过程和自己的心得体会。</p><h2 id="一-背景分析"><a href="#一-背景分析" class="headerlink" title="一. 背景分析"></a>一. 背景分析</h2><p>蜂鸟商家版 iOS 端代码使用 Git 进行管理，代码托管在内网的 GitLab 上。项目的依赖管理工具是大家比较熟悉的 CocoaPods，除了 RN 模块为了和 Android 组公用采用 Submodule 进行管理外，其他所有的子模块都采用 Pods 库的方式引入。</p><h3 id="1-存在的问题"><a href="#1-存在的问题" class="headerlink" title="1. 存在的问题"></a>1. 存在的问题</h3><p>在「蜂鸟商家版 iOS 组件化 &#x2F; 模块化」工作开展之前，项目主要存在如下这些问题：</p><ul><li>项目臃肿不堪</li></ul><p>在组件化 &#x2F; 模块化之前，蜂鸟商家版 App 的所有代码 &#x2F; 资源文件等都是在同一个主工程里的，只有 RN 仓库或组内公用私有库等极少部分代码游离于主工程之外，所以在开发时，每一次都要编译整个项目的所有代码，十分低效。这个问题在独立开发时还不是十分明显，毕竟虽然项目大但是代码只有一个人在提交，所以项目代码量增加也不是那么夸张而且对项目发生的变化比较熟悉。但是当多人协作开发时，这个缺陷就暴露了出来，大家在各自开发不同的业务时，不仅要时刻和他人同步项目变化、读懂他人代码，还要每次编译完整个项目才能对自己所做的一点修改进行调试，效率低下。</p><ul><li>团队规模变化</li></ul><p>我开始参与蜂鸟商家版 iOS 端的维护时，之前只有一个前辈在维护，也就是一个人独立维护一个 App。然后过了没多久，他离职去了另一家公司，所以又变成了一个人独立维护这个 App。这时候因为是独立开发，所以也不存在什么太大的问题。但随着团队扩大，后面陆续来了几位同事共同负责这个项目的维护工作，大家都在同一个工程上进行业务开发，经常遇到如代码冲突、开发效率低下、职责划分不清、代码管理混乱等问题。</p><ul><li>业务发展压力</li></ul><p>由于公司处在高速发展的阶段，业务增长很快，最直观的表现就是市场 &amp; 客服部门不断接到大量一线使用者的使用反馈或诉求，最后就变成了产品展示给我们开发人员的一份接一份的 PRD。紧凑的业务开发需求和各种灵活的功能迫使我们想尽一切能够使用的办法来提高开发效率，提高提测质量。</p><ul><li>代码管理混乱</li></ul><p>当我开始参与这个项目的维护时，这个项目就已经是一个 Swift 和 OC 混编的项目了，然后还有 RN 和 H5 代码，可以说是十分复杂了。虽然这不是我厂唯一一个 Swift 和 OC 的混编项目，但绝对是当时 Swift 化最高的一个项目，约 25% 的代码为 Swift。众所周知，Swift 和 OC 的互相调用远不如 Java 和 Kotlin 的互相调用那么顺滑（反正你现在知道了），并且处处藏着危机，暗坑无数，所以迫切需要找一个方式，将 Swift 和 OC 代码进行整理、转换或者分隔。毕竟，这个文件是 OC 下一个文件就是 Swift 这种频繁的思维转换在业务开发这种本就十分紧张的场景下，会使人十分疲惫，不利于开发工作的顺利进行。</p><p><img src="https://user-gold-cdn.xitu.io/2018/1/19/1610f02b4ad93d93?w=800&h=683&f=png&s=230419"></p><h3 id="2-怎样去解决"><a href="#2-怎样去解决" class="headerlink" title="2. 怎样去解决"></a>2. 怎样去解决</h3><p>为了解决以上这些问题，我们曾经进行过如下一些探索：</p><ol><li>移除无用的第三方库和资源文件，减少打包时间：效果不明显；</li><li>整理并推动内部 Gitflow 工作流，提高协作效率：有一些效果，但由于项目过大，日常协作仍然吃力；</li><li>研究 Swift 编译时间优化方法，提高编译效率：发现增加编译时间的都是 Swift 的一些常用语法糖，如果不用的话，严重降低开发效率，遂放弃；</li><li>在不拆分主工程的情况下，推动项目整个 Swift 化：由于之前维护项目的前辈离职，导致目前的项目开发人员都对原代码不是十分熟悉，不敢妄加改动，加之业务迭代频繁，开发和测试资源都十分紧张，该工作工作推进十分缓慢。</li></ol><p>可以发现上述尝试的结果都不是十分理想，在与 iOS 组内大佬们进行一些沟通，听取大佬们的意见后，决定对原项目进行「组件化 &#x2F; 模块化拆分」工作，它能带来如下这些好处：</p><ul><li>加快编译速度，不用再编译组件 &#x2F; 模块外没有被依赖到的代码；</li><li>便于将每个模块指定给不同负责人进行管理；</li><li>降低合并难度，减小冲突和出错概率，提高业务开发效率；</li><li>将 Swift 和 OC 代码进行分离，便于进一步 Swift 化工作的推进；</li><li>可为模块编写单元测试，提高工作效率，同时方便测试人员进行有针对性的测试。</li></ul><h2 id="二-目标设定"><a href="#二-目标设定" class="headerlink" title="二. 目标设定"></a>二. 目标设定</h2><ul><li>功能组件独立：保证所有的底层功能组件从主工程抽出，独立与主工程之外，便于复用、业务模块的调用；</li><li>业务模块划分与拆解：将业务按对应用途进行划分和拆解，想办法切断各业务之间的强依赖；</li><li>所有组件 &#x2F; 模块独立编译：所有功能组件和业务模块能够独立于主工程进行编译，有各自的 Demo 工程；</li><li>CocoaPods 发布：在内网 GitLab 进行发布，并且之后对每个模块用 GitFlow 工作流进行管理和后续发布工作。</li></ul><p><img src="https://user-gold-cdn.xitu.io/2018/1/19/1610f02b4ae5935d?w=840&h=351&f=png&s=110856"></p><h2 id="三-计划制定"><a href="#三-计划制定" class="headerlink" title="三. 计划制定"></a>三. 计划制定</h2><p>说到组件化 &#x2F; 模块化，那么什么是组件化 &#x2F; 模块化呢？组件化和模块化的区别又在哪里呢？</p><p>组件，就是我们对功能的封装，一个功能就是一个组件，数据库、网络、文件操作、社会化分享等等这些功能都是组件。我们之所以要搞出组件的概念，是为了能够让我们的上层业务模块能够随时依赖和调用这些基础功能。组件基本上可以分为基础功能组件、通用 UI 组件、基础业务组件等这几类。所以为了满足上述要求，组件必须具有较高的独立性、扩展性以及复用性。</p><p>模块，就是对一系列有内聚性的业务进行整理，将其与其它业务进行切割、拆分，从主工程或原所在位置抽离为一个相对独立的部分。仅仅针对业务而言，比如说我们可以把订单业务独立为为一个模块，可以把个人中心独立为一个模块，把用户登录独立为一个模块等，在 App 中的体现就是一个个独立的 Git 仓库。模块化的一个好处是用到时可以搭积木，比如可以多个工程间复用同一个或几个业务模块，比如腾讯的 QQ 和 TIM，除了 UI 界面外 TIM 显然复用了大量现有的原 QQ 工程的业务模块代码，当然，我们这里暂时并没有这个需求。</p><p>经过小组会议讨论，我们的想法是将共用组件独立出来，然后直接按业务对现有主工程进行拆分同时兼顾 Swift 与 OC 分离，大致划分如下表所示：</p><h3 id="1-组件"><a href="#1-组件" class="headerlink" title="1. 组件"></a>1. 组件</h3><table><thead><tr><th align="left">组件</th><th align="left">库名</th><th align="left">主要内容</th></tr></thead><tbody><tr><td align="left">基础（OC）</td><td align="left">LPDBOCFoundationGarbage</td><td align="left">基础的 OC 组件，各种零散的、混乱的视图、组件、控件、常量、OC 宏定义等，全放在这里，供上层调用。和他的库名一样，其本质就大概就是个垃圾桶。</td></tr><tr><td align="left">基础（Swift）</td><td align="left">LPDBPublicModule</td><td align="left">基础的 Swift 组件，包含一些公用的 Swift 扩展，和模块间解耦的协议。</td></tr><tr><td align="left">网络（OC）</td><td align="left">LPDBNetwork</td><td align="left">网络组件，对 AFNetworking 的浅层封装，同时包含了和网络相关的业务功能。</td></tr><tr><td align="left">…</td><td align="left">…</td><td align="left">…</td></tr></tbody></table><h3 id="2-模块"><a href="#2-模块" class="headerlink" title="2. 模块"></a>2. 模块</h3><table><thead><tr><th align="left">模块</th><th align="left">库名</th><th align="left">主要内容</th></tr></thead><tbody><tr><td align="left">历史（OC）</td><td align="left">LPDBHistoryModule</td><td align="left">历史订单模块，包含和历史订单相关的资源文件、UI、业务逻辑代码等。</td></tr><tr><td align="left">登录（OC）</td><td align="left">LPDBLoginModule</td><td align="left">用户登录模块，包含和登录、注册页面相关的资源文件、UI、业务逻辑代码等。</td></tr><tr><td align="left">用户中心（OC）</td><td align="left">LPDBUserCenterModule</td><td align="left">用户中心模块，包含和用户个人中心以及状态相关的资源文件、UI、业务逻辑代码等。</td></tr><tr><td align="left">…</td><td align="left">…</td><td align="left">…</td></tr></tbody></table><h3 id="3-关系"><a href="#3-关系" class="headerlink" title="3. 关系"></a>3. 关系</h3><p>按照上面的思路，理想化的模块 &#x2F; 组件依赖关系图大概是这个样子的：</p><p><img src="https://user-gold-cdn.xitu.io/2018/1/19/1610f02b4a9c953e?w=548&h=272&f=png&s=22346"></p><p>因为蜂鸟商家版的团队开发人员之前均没有过任何项目的拆分经验，大家也都是摸着石头过河，走一步看一步。所以虽然以上的拆分思路总体是对的，先拆组件后拆业务，但由于各种各样的原因，一些问题就在接下来的工作实施过程中暴露了出来。</p><h2 id="四-工作实施"><a href="#四-工作实施" class="headerlink" title="四. 工作实施"></a>四. 工作实施</h2><p>我们小组主要还是以业务开发为主，所以组件化 &#x2F; 模块化工作都是大家抽空闲时间来完成，并没有进行硬性的排期和设置 Deadline。按照之前制定的计划，我们进行了以下这些工作：</p><h3 id="1-功能组件独立"><a href="#1-功能组件独立" class="headerlink" title="1. 功能组件独立"></a>1. 功能组件独立</h3><h4 id="1-1-LPDBOCFoundationGarbage"><a href="#1-1-LPDBOCFoundationGarbage" class="headerlink" title="1.1 LPDBOCFoundationGarbage"></a>1.1 LPDBOCFoundationGarbage</h4><p>LPDBOCFoundationGarbage 是我们项目最先抽出的部分，这个库将和 LPDBPublicModule 一起，作为整个工程的最底层，再往下就是。这个库的定位和它的名字一样，就是一个垃圾桶，啥都往里放。其中大致包含以下一些东西：</p><ul><li>自定义的 View 和控件，例如：小红点控件、刷新控件、加载控件、Tips 视图等；</li><li>自定义的 Controller，例如：基础控制器 BaseViewController、WebView 基础控制器 BaseWebViewController、自定义的弹框 AlertController等；</li><li>和业务相关的对基本类型或系统控件的扩展：对 NSObject、UIButton、UIImageView、UILabel 等添加的扩展代码 category；</li><li>甚至版本控制模块 LPDBVersionManager 也放在了这里。</li></ul><p>因为我们在进行拆分任务的同时，还在同时维持着项目的开发工作，所以我们暂时没有精力做细致的拆分工作，只能先把这些零散的部分先放在一起进行管理。</p><h4 id="1-2-LPDBPublicModule"><a href="#1-2-LPDBPublicModule" class="headerlink" title="1.2 LPDBPublicModule"></a>1.2 LPDBPublicModule</h4><p>LPDBPublicModule 是基础的 Swift 组件，这个库主要包含：</p><ul><li>一些公用的 Swift 扩展，例如：对 CGFloat、Date、NSString 等系统类型的 extension；</li><li>用于模块间解耦的协议。</li></ul><p>因为工程内的 Swift 代码大多是我们新写的，所以相对旧的 OC 代码而言，整理地更好一些，所以这个仓库干净很多</p><h4 id="1-3-LPDBNetwork"><a href="#1-3-LPDBNetwork" class="headerlink" title="1.3 LPDBNetwork"></a>1.3 LPDBNetwork</h4><p>LPDBNetwork 网络组件是我们项目完成 OC 和 Swift 基础部分后最先抽出的部分，刚开始我们认为这部分仅仅是单纯的业务网络请求操作和对 AFNetworking 的浅层封装，不包含界面 UI 逻辑等。不过当我们拆解完成后，发现其中还包含了一堆奇怪的东西：</p><ul><li>对 AFNetworking 的封装和网络操作的一些定义，例如：LPDBHttpManager、LPDBRequestObject 和 LPDBModel 等；</li><li>UI 操作，例如：等待视图 LPDBLoadingView 和 网络请求失败的提示等。</li></ul><p>这一部分的话，因为都是比较古老的代码，所以当初的开发人员都已经不再继续维护了，所以在只能是我们自己进行拆分的情况下，为了防止大的变更导致发生问题，所以没有对这一块进行更细致的拆解工作。毕竟再烂代码也比不能工作的代码要好。</p><h4 id="1-4-LPDBUIKit"><a href="#1-4-LPDBUIKit" class="headerlink" title="1.4 LPDBUIKit"></a>1.4 LPDBUIKit</h4><p>Swift 的 UI 库，我们将工程中的一些 Swift 视图和控件收集到了这个项目中，主要包含以下这些内容：</p><ul><li>视图，例如：LPDBEmptyDataView、SlideScrollView 等；</li><li>控件，例如：SlideTabKit 等。</li></ul><p>因为 Swift 代码总量还不是很大，所以这个库的东西目前也不是很多，以后会逐渐丰富起来。</p><h3 id="2-业务模块拆分"><a href="#2-业务模块拆分" class="headerlink" title="2. 业务模块拆分"></a>2. 业务模块拆分</h3><p>完成了上面的组件库的独立工作后，业务模块的拆解就相对轻松一些了，目前我们主要完成了三个业务模块的拆分工作。</p><h4 id="2-1-LPDBHistoryModule"><a href="#2-1-LPDBHistoryModule" class="headerlink" title="2.1 LPDBHistoryModule"></a>2.1 LPDBHistoryModule</h4><p>LPDBHistoryModule 历史订单模块，和历史订单页面相关的信息都在该模块中，主要包含以下内容：</p><ul><li>UI，例如：历史订单界面、历史订单列表 Cell、加载视图等；</li><li>数据模型，例如：历史订单模型；</li><li>历史订单列表相关的网络请求。</li></ul><p>因为该模块相对来说比较独立，所以拆分过程也比较顺利，主要依赖了 LPDBPublicModule、LPDBNetwork、LPDBOCFoundationGarbage 组件。</p><h4 id="2-2-LPDBLoginModule"><a href="#2-2-LPDBLoginModule" class="headerlink" title="2.2 LPDBLoginModule"></a>2.2 LPDBLoginModule</h4><p>LPDBLoginModule 用户登录模块是一个与用户登录、注册以及用户登录信息有关的模块，主要包含了以下信息：</p><ul><li>UI，例如：用户登录界面、用户注册界面等；</li><li>数据模型，例如：用户信息模型、用户信息地址模型等；</li><li>登录与注册相关的网络请求。</li></ul><p>该模块相比较历史订单模块复杂了一些，不过仍然比较顺利，主要依赖了 LPDBPublicModule、LPDBOCFoundationGarbage、LPDBNetwork 组件。</p><h4 id="2-3-LPDBUserCenterModule"><a href="#2-3-LPDBUserCenterModule" class="headerlink" title="2.3 LPDBUserCenterModule"></a>2.3 LPDBUserCenterModule</h4><p>LPDBUserCenterModule 用户中心模块是一个与用户个人中心以及用户信息修改有关的模块，主要包含了以下信息：</p><ul><li>UI，例如：用户中心界面、用户电话修改界面、用户密码修改界面等；</li><li>数据模型，例如：用户详细信息模型、用户信息地址模型等；</li><li>用户中心相关的网络请求，例如：修改电话号码、请求验证码等。</li></ul><p>该模块主要依赖了 LPDBOCFoundationGarbage 组件和 LPDBLoginModule 模块。</p><h4 id="2-4-其它"><a href="#2-4-其它" class="headerlink" title="2.4 其它"></a>2.4 其它</h4><p>剩下的其他一些模块仍然处于计划中的状态，暂未进行拆分。到这一步的话，库间依赖关系大致如下图所示：</p><p><img src="https://user-gold-cdn.xitu.io/2018/1/19/1610f02b4a8c0fca?w=1240&h=608&f=png&s=111714"></p><p>可以看到其中存在一些不太合理的依赖关系，如 LPDBUserCenterModule 依赖 LPDBLoginModule 模块，也就是所谓的业务模块横向依赖问题，接下来，我们就要处理这一问题。</p><h3 id="3-解除耦合"><a href="#3-解除耦合" class="headerlink" title="3. 解除耦合"></a>3. 解除耦合</h3><p>由于之前开发过程中从未有过任何模块化的考量，所以蜂鸟商家版的代码非常杂糅，项目依赖关系十分复杂，主要可以分为以下三类耦合：</p><ul><li>界面耦合：App 执行过程中，硬编码的界面间的跳转行为；</li><li>工程耦合：某些模块在运行时需要依赖主工程的代码才能运行或实现完整的功能；</li><li>依赖耦合：两个业务模块之间的有依赖。</li></ul><h4 id="3-1-模块间组件共用"><a href="#3-1-模块间组件共用" class="headerlink" title="3.1 模块间组件共用"></a>3.1 模块间组件共用</h4><p>在拆分业务模块的过程中，经常发生两个业务模块同时引用某一块业务代码的问题，这时我们就需要对这一块代码进行理解，首先区分它到底应不应该划分到业务层来？</p><ul><li>如果是的话，应该划归到哪一个模块中去更合理一些；</li><li>如果不是的话，应该将这一部分代码下沉到哪一个组件库中去比较合适，或者独立为一个组件。</li></ul><p>在 LPDBUserCenterModule 的抽离过程中就遇到了这个问题，LPDBUserCenterModule<br> 和 LPDBLoginModule 共同依赖了几个和用户信息有关的数据模型，导致需要发生模块间横向依赖，所以我们将共用的数据模型抽出，然后下沉到了 LPDBOCFoundationGarbage 中。</p><h4 id="3-2-模块间耦合"><a href="#3-2-模块间耦合" class="headerlink" title="3.2 模块间耦合"></a>3.2 模块间耦合</h4><p>另一个经常遇到的问题就是跨模块调用代码的问题了，不仅是模块与模块间代码的互相调用、模块间页面的跳转，还有模块反向调用主工程代码等问题，这个问题的解决我们分了三步：</p><ul><li>反射调用</li></ul><p>因为工程的复杂性和以前代码的不规范，导致我们在处理切割业务模块时比较痛苦，所以我们在刚开始抽出模块时采用了一种快速但不太安全的方式进行解耦，比如在 LPDBUserCenterModule 模块中需要调用主工程的 getMiddlePageVC 方法时，我们用了如下临时解决方案：</p><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> ([[<span class="built_in">UIApplication</span> sharedApplication].delegate respondsToSelector:<span class="keyword">@selector</span>(getMiddlePageVC)]) &#123;</span><br><span class="line">    <span class="built_in">UIViewController</span> *info = [[<span class="built_in">UIApplication</span> sharedApplication].delegate performSelector:<span class="keyword">@selector</span>(getMiddlePageVC)];</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后在主工程的 中实现这个接口：</p><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="comment">// .h</span></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">AppDelegate</span> : <span class="title">UIResponder</span> &lt;<span class="title">UIApplicationDelegate</span>&gt;</span></span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"><span class="comment">// LPDBUserCenterModule</span></span><br><span class="line">- (<span class="built_in">UIViewController</span> *)getMiddlePageVC;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// .m</span></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">AppDelegate</span></span></span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">UIViewController</span> *)getMiddlePageVC &#123;</span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> xxx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure><p>这一方案的优点就是灵活，利用 NSClassFromString、performSelector 等方式，能够快速解决各种耦合问题，瞬间切割出模块。但缺点也显而易见，字符串硬编码，维护成本大，去掉了编译器检查，容易翻车。</p><ul><li>协议调用</li></ul><p>所以自然而言地，当我们的某个业务模块的拆分工作基本定型时，我们就开始将第一步中的反射调用方式替换为协议的方式进行调用，比如当 LPDBLoginModule 模块需要调用主工程的 getCoordinate 方法时，示例如下：</p><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="type">id</span> delegate = [[<span class="built_in">UIApplication</span> sharedApplication] delegate];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (![delegate conformsToProtocol:<span class="class"><span class="keyword">@protocol</span>(<span class="title">AppDelegateProtocol</span>)]) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">CLLocationCoordinate2D</span> coordinate = [delegate coordinate];</span><br></pre></td></tr></table></figure><p>然后在主工程中实现该方法：</p><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="comment">// .h</span></span><br><span class="line"><span class="meta">#import <span class="string">&quot;AppDelegate.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@import</span> LPDBLoginModule;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">AppDelegate</span> (<span class="title">Protocol</span>)  &lt;<span class="title">AppDelegateProtocol</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// .m</span></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">AppDelegate</span> (<span class="title">Protocol</span>)</span></span><br><span class="line"></span><br><span class="line">- (<span class="built_in">CLLocationCoordinate2D</span>)getCoordinate &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>.coordinate;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure><p>但是，样的改变并不能彻底解决所编写的模块间互相调用的代码缺乏编译器检查的问题，而仅仅是对调用方做了判断加上了容错，并不能在编译期就让开发人员察觉到问题，一定要进行测试才可以，所以这种方式也不是十分理想。</p><ul><li>Lotusoot 解耦工具</li></ul><p>那么为了彻底解决问题，我们开发和引入了组件通信和工具 Lotusoot，调用方式有下列几种可供参考：</p><ul><li>服务调用</li></ul><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> lotus <span class="operator">=</span> s(<span class="type">AccountLotus</span>.<span class="keyword">self</span>) </span><br><span class="line"><span class="keyword">let</span> accountModule: <span class="type">AccountLotus</span> <span class="operator">=</span> <span class="type">LotusootCoordinator</span>.lotusoot(lotus: lotus) <span class="keyword">as!</span> <span class="type">AccountLotus</span></span><br><span class="line">accountModule.login(username: <span class="string">&quot;admin&quot;</span>, password: <span class="string">&quot;wow&quot;</span>) &#123; (error) <span class="keyword">in</span></span><br><span class="line">    <span class="built_in">print</span>(error <span class="operator">??</span> <span class="string">&quot;&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>短链注册</li></ul><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> error: <span class="type">NSError</span>? <span class="operator">=</span> <span class="type">LotusootRouter</span>.register(route: <span class="string">&quot;newproj://account/login&quot;</span>) &#123; (lotusootURL) <span class="keyword">in</span></span><br><span class="line">    accountModule.showLoginVC(username: <span class="string">&quot;admin&quot;</span>, password: <span class="string">&quot;wow&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>短链调用</li></ul><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> param: <span class="type">Dictionary</span> <span class="operator">=</span> [<span class="string">&quot;username&quot;</span> : <span class="string">&quot;admin&quot;</span>,</span><br><span class="line">                                 <span class="string">&quot;password&quot;</span> : <span class="string">&quot;wow&quot;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">// 无回调                                 </span></span><br><span class="line"><span class="type">LotusootRouter</span>.open(route: <span class="string">&quot;newproj://account/login&quot;</span>, params: param)</span><br><span class="line"><span class="comment">// 有回调</span></span><br><span class="line"><span class="type">LotusootRouter</span>.open(route: <span class="string">&quot;newproj://account/login&quot;</span>, params: param).completion &#123; (error) <span class="keyword">in</span></span><br><span class="line">    <span class="built_in">print</span>(error <span class="operator">??</span> <span class="string">&quot;open success&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ⚠️不推荐的用法，用 ?pram0=xxx 这样的形式导致字符串散落在各处，不易管理。</span></span><br><span class="line"><span class="comment">// 但为了保证 Hybrid 项目中 H5 页面的正常跳转，提供了此种调用</span></span><br><span class="line"><span class="type">LotusootRouter</span>.open(url: <span class="string">&quot;newproj://account/login?username=zhoulingyu&quot;</span>).completion &#123; (error) <span class="keyword">in</span></span><br><span class="line">    <span class="built_in">print</span>(error <span class="operator">??</span> <span class="string">&quot;open success&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>具体可以参见 <a href="http://zhoulingyu.com/2017/11/29/iOS-modularized-tool-Lotusoot/">iOS 灵活的 模块化&#x2F;组件化 工具与规范 Lotusoot 解说</a> 一文，在此不多做赘述。类似的工具还有 <a href="https://github.com/alibaba/BeeHive">BeeHive</a> 和 <a href="https://github.com/LPD-iOS/LPDMvvmRouterKit">LPDMvvmRouterKit</a> 等，大家可以自行进一步探索。</p><p>最终结构就变成了如图所示的样子：</p><p><img src="https://user-gold-cdn.xitu.io/2018/1/19/1610f02b4aa60211?w=708&h=408&f=png&s=44455"></p><h2 id="五-问题整理"><a href="#五-问题整理" class="headerlink" title="五. 问题整理"></a>五. 问题整理</h2><h3 id="1-不合理的分层结构和库间依赖"><a href="#1-不合理的分层结构和库间依赖" class="headerlink" title="1. 不合理的分层结构和库间依赖"></a>1. 不合理的分层结构和库间依赖</h3><p>由于参与拆分工作的人员比较缺乏组件化经验，所以导致某些库的拆分不是十分合理，某些应该沉入底层的公用 Model 和常量等没有在开始时就放到一个合理的位置。业务模块之间也存在一些不合理的横向依赖，没有进行一个合理的业务边界划分。这些原因导致我们在进行拆分工作时经常需要回过头来对已经拆出来的模块和组件重新进行整理和处理，重复劳动量很大。</p><h3 id="2-拆分粒度不适中"><a href="#2-拆分粒度不适中" class="headerlink" title="2. 拆分粒度不适中"></a>2. 拆分粒度不适中</h3><p>某些库比如 LPDBOCFoundationGarbage 比较庞大，而像 LPDBUIKit 这样的库中内容却非常少，这一点的处理上存在问题。如果一个拆分完成的库仍然比较臃肿的化，说明仍然存在细化拆分的必余地。</p><h3 id="3-工作进度难以控制"><a href="#3-工作进度难以控制" class="headerlink" title="3. 工作进度难以控制"></a>3. 工作进度难以控制</h3><p>由于没有能提前制定好详细的进度计划表，加上业务工作的挤压，导致我们花在组件化 &#x2F; 模块化工作上的时间比较零散。本意是希望大家能够灵活安排工作，合理处置业务开发与技术改造工作之间的关系，但效果不是很理想，表现就是组件化 &#x2F; 模块化工作的进行没有连续性，大家的积极性和工作效率也都不高。</p><h2 id="六-经验总结"><a href="#六-经验总结" class="headerlink" title="六. 经验总结"></a>六. 经验总结</h2><h3 id="1-工作开始前要进行技术调研"><a href="#1-工作开始前要进行技术调研" class="headerlink" title="1. 工作开始前要进行技术调研"></a>1. 工作开始前要进行技术调研</h3><p>查看和学习一些同类成功的案例资料或者向业内大佬们请教能够对计划的制定带来便利，能够使我们避免很多错误的设计，少走一些弯路，降低返工率。</p><h3 id="2-制定详细整体规划"><a href="#2-制定详细整体规划" class="headerlink" title="2. 制定详细整体规划"></a>2. 制定详细整体规划</h3><blockquote><p>在准备作战时，我常常发现定好的计划没有用处，但计划的过程仍必不可少。—— 德怀特·艾森豪威尔</p></blockquote><p>制定详细的整体规划能够在设计阶段就将一些不合理的地方暴露出来，从而拿出解决方案使问题提前得到解决，或者把不合理的内容删减替换掉，例如分层不合理、库间依赖这样的问题，就会减少很多。拿出细致的任务拆分计划和工作量预估，也能更合理地将任务安排到开发人员手中，在提升工作效率的同时也能尽量避免和业务开发产生冲突。</p><h3 id="3-注意对代码质量的控制"><a href="#3-注意对代码质量的控制" class="headerlink" title="3. 注意对代码质量的控制"></a>3. 注意对代码质量的控制</h3><p>好的代码和编码习惯能够大幅提升项目的可维护性，为之后的工作带来便利。我们之前旧的 OC 代码比较混乱，基本处于无法维护的状态，拆分起来十分痛苦；而新写的 Swift 代码明显质量要高很多（这真的不是我们自夸…），拆分起来就顺利多了。</p><h3 id="4-重视信息的文档化"><a href="#4-重视信息的文档化" class="headerlink" title="4. 重视信息的文档化"></a>4. 重视信息的文档化</h3><p>每一个拆分出的模块及时添加文档，嫌麻烦的话至少要建立一份通用的 README 模板，每一个模块或组件的建立者把模块内容、拆分目的、设计思路等基本信息记录一下，有什么坑或者注意点也可以文档化，是以后的长期项目维护成为可能。</p><h2 id="七-开源成果"><a href="#七-开源成果" class="headerlink" title="七. 开源成果"></a>七. 开源成果</h2><p>我们在组件化 &#x2F; 模块化工作期间，产出的一些库和工具放在了 GitHub 上进行开源，给大家一些借鉴的同时，也希望能够收到大家的意见和建议，提高我们项目本身的质量：</p><table><thead><tr><th align="left">库名</th><th align="left">简介</th><th align="left">仓库地址</th></tr></thead><tbody><tr><td align="left">Lotusoot</td><td align="left">灵活的 Swift 组件解耦和通信工具</td><td align="left"><a href="https://github.com/Vegetarians/Lotusoot">https://github.com/Vegetarians/Lotusoot</a></td></tr><tr><td align="left">Bamboots</td><td align="left">一个面向协议的 Swift 网络库</td><td align="left"><a href="https://github.com/mmoaay/Bamboots">https://github.com/mmoaay/Bamboots</a></td></tr><tr><td align="left">bigkeeper</td><td align="left">一个 iOS &amp; Android 模块化项目效率提升工具</td><td align="left"><a href="https://github.com/BigKeeper/bigkeeper">https://github.com/BigKeeper/bigkeeper</a></td></tr><tr><td align="left">SideNavigation</td><td align="left">一个支持侧滑且可自定义的侧边栏</td><td align="left"><a href="https://github.com/CNKCQ/SideNavigation">https://github.com/CNKCQ/SideNavigation</a></td></tr><tr><td align="left">ViewPagers</td><td align="left">一个支持手势的 Segmented Control</td><td align="left"><a href="https://github.com/CNKCQ/ViewPagers">https://github.com/CNKCQ/ViewPagers</a></td></tr><tr><td align="left">EFAutoScrollLabel</td><td align="left">一个带跑马灯效果的 UILabel</td><td align="left"><a href="https://github.com/EyreFree/EFAutoScrollLabel">https://github.com/EyreFree/EFAutoScrollLabel</a></td></tr></tbody></table><h2 id="八-后记"><a href="#八-后记" class="headerlink" title="八. 后记"></a>八. 后记</h2><p>本文基本描述了蜂鸟商家版 App 到目前为止的组件化 &#x2F; 模块化实践情况，希望本文能够给您的移动项目演进提供一些借鉴。在此过程中我们产出的一些文章、开源库和工具，也希望能给大家带来一定的帮助或者启发。欢迎大家提出各种反馈和建议或，帮助我们继续改进和提高。</p><p>2017 年底，也就是差不多我参与蜂鸟商家版的维护工作满一年的样子，由于业务调整的原因这个 App 已经移交给别的团队进行维护了，导致项目的 Swift 化和组件化 &#x2F; 模块化工作并没有全部完成，这一点有些遗憾。不过还是希望蜂鸟商家版能够越来越好，继续为广大商家朋友们服务。</p><p>好消息是，接下来我主要参与蜂鸟团队版 App 的架构工作，这一次我们根据之前暴露出的问题制定了详细的工作计划，有了蜂鸟商家版的踩坑经验后，我相信这一次我们一定能顺利完成目标。2018，加油，一起拼！</p><p>本文编写过程中参考了以下文章，在此对原作者们表示感谢：</p><ol><li><a href="https://36kr.com/p/5100487.html">即时配送网之于外卖O2O，配送的更高境界是社群经营</a></li><li><a href="https://www.jianshu.com/p/79e4df63f31f">谈谈我的理解-组件化&#x2F;模块化</a></li><li><a href="http://limboy.me/tech/2016/03/10/mgj-components.html">蘑菇街 App 的组件化之路</a></li><li><a href="http://lincode.github.io/Modularity">豆瓣App的模块化实践</a></li><li><a href="http://www.infoq.com/cn/articles/the-road-of-mobile-tmall-decoupling">手机天猫解耦之路</a></li><li><a href="http://www.infoq.com/cn/articles/jd-ios-component-management">京东iOS客户端组件管理实践</a></li></ol><hr><blockquote><p>如有任何知识产权、版权问题或理论错误，还请指正。<br><a href="https://www.eyrefree.org/2018/01/20/LPDBusinessiOS">https://www.eyrefree.org/2018/01/20/LPDBusinessiOS</a><br>如文中无特殊说明，本站均使用以下协议保护：<a href="http://creativecommons.org/licenses/by-nc-nd/3.0/cn/">署名-非商业性使用-禁止演绎</a>。</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Swift </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Git 踩坑：Git Push 远端无分支不提示</title>
      <link href="/2017/12/25/Git-Push/"/>
      <url>/2017/12/25/Git-Push/</url>
      
        <content type="html"><![CDATA[<p>上周遇到一个 Git 配置导致的问题，踩坑过程如下。</p><h2 id="一-问题描述"><a href="#一-问题描述" class="headerlink" title="一. 问题描述"></a>一. 问题描述</h2><ol><li>首先找一个远端 Git 仓库，clone 到本地；</li><li>在本地新建一个分支 test（名字随意，只要远端不存在这个分支即可）并切换到该分支；</li><li>执行 <code>git push</code> 命令后会发现终端显示了 <code>Everything up-to-date</code>，会让人误以为该分支成功推到了远端；</li><li>实际上问题已经出现了，这里 <code>git push</code> 指令并没有正确提示我们远端不存在该分支。我们可以检查一下远端 Git 仓库，的确没有把 test 分支推上去；</li></ol><p><img src="https://user-gold-cdn.xitu.io/2017/12/25/1608c4ec3e087cf1?w=585&h=366&f=png&s=55199"></p><ol start="5"><li>这个问题有多坑呢？假设没察觉这里回显不对，而是把本地分支删了干别的去了，估计就哭了。</li></ol><h2 id="二-问题解决"><a href="#二-问题解决" class="headerlink" title="二. 问题解决"></a>二. 问题解决</h2><ol><li>查了 N 多资料；</li><li>对比了 N 多类似案例；</li><li>耗费了无数脑细胞；</li><li>终于在 <a href="http://timothyqiu.com/">TimothyQiu</a> 大大告诉我解决方法之后解决了该问题，😂；</li><li>问题原因大概是因为 <code>gitconfig</code> 中的 参数设置异常导致的，我们可以执行 <code>git config -l</code>  命令查看当前的 Git 配置，可以看到 <code>push.default</code> 的值为 <code>matching</code>：</li></ol><p><img src="https://user-gold-cdn.xitu.io/2017/12/25/1608c4ec3c4f77f6?w=805&h=381&f=png&s=63849"></p><ol start="6"><li>用 <code>git config --global push.default simple</code> 命令把它改成 <code>simple</code> 即可：</li></ol><p><img src="https://user-gold-cdn.xitu.io/2017/12/25/1608c4ec3c565841?w=804&h=396&f=png&s=69369"></p><ol start="7"><li>然后执行 <code>git push</code> 命令就可以正常获取错误提示信息啦：</li></ol><p><img src="https://user-gold-cdn.xitu.io/2017/12/25/1608c4ec3c6b61bd?w=518&h=103&f=png&s=11300"></p><hr><blockquote><p>如有任何知识产权、版权问题或理论错误，还请指正。<br><a href="https://www.eyrefree.org/2017/12/25/Git-Push">https://www.eyrefree.org/2017/12/25/Git-Push</a><br>如文中无特殊说明，本站均使用以下协议保护：<a href="http://creativecommons.org/licenses/by-nc-nd/3.0/cn/">署名-非商业性使用-禁止演绎</a>。   </p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Git </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>利用 CodeBeat 为你在 GitHub 上的项目进行代码质量管理</title>
      <link href="/2017/12/13/CodeBeat-GitHub/"/>
      <url>/2017/12/13/CodeBeat-GitHub/</url>
      
        <content type="html"><![CDATA[<p>CodeBeat 是一个免费为开源项目进行代码质量管理的工具（付费可以支持私有项目），目前已经支持的编程语言有 Swift、Objective-C、Go、Ruby、Python、Java、Kotlin、Javascript、Typescript、Elixir，无需对原有项目进行任何修改即可获取针对项目的完整质量分析，方便快捷。</p><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>当我们在 GitHub 上的代码仓库发生变更后，会通知 CodeBeat 执行分析操作刷新项目代码质量评分，并在完成后刷新项目评级 &#x2F; 评分的状态或结果，如图所示：</p><p><img src="https://user-gold-cdn.xitu.io/2017/12/13/1604ec0b248e6fda?w=1184&h=673&f=png&s=98888" alt="代码质量效果预览"></p><p>CodeBeat 的同类产品有 Code Climate，目前支持 Ruby、Python、PHP、JavaScript、Java、TypeScript，不过官网显示<br> Swift、Go、Objective-C 的支持在计划中，因为我是 iOS 开发，所以暂时用不了这个，在一个 <a href="https://github.com/BigKeeper/bigstash">Ruby 项目</a>有试过这个，看起来还好，有兴趣的同学也可以一试。</p><p>本文以 <a href="https://github.com/EyreFree/EFQRCode">EFQRCode</a>(一个使用 Swift 作为开发语言的二维码库) 为例，简述怎样为自己的开源项目添加代码质量管理功能。</p><h2 id="1-注册-CodeBeat-账号"><a href="#1-注册-CodeBeat-账号" class="headerlink" title="1. 注册 CodeBeat 账号"></a>1. 注册 CodeBeat 账号</h2><p>打开 <a href="https://codebeat.co/">https://codebeat.co/</a> 注册一个 CodeBeat 账号，也可以通过 GitHub 账户直接登陆。CodeBeat 服务对开源项目是免费的，所以你的私有项目无法享受到免费的持续构建服务。唔，当然，每月支付 20 美刀成为付费用户后可以解锁无限数量私有库的功能。</p><h2 id="2-从-GitHub-添加项目"><a href="#2-从-GitHub-添加项目" class="headerlink" title="2. 从 GitHub 添加项目"></a>2. 从 GitHub 添加项目</h2><p>登陆完成后，点击右边的 <code>Add Repository</code> 按钮即可开始添加自己的 Git 仓库，支持各种 Git 托管平台，甚至自建的也可以：</p><p><img src="https://user-gold-cdn.xitu.io/2017/12/13/1604ec0b27e29b81?w=1168&h=411&f=png&s=35896" alt="Add Repository"></p><h2 id="3-开启代码质量管理"><a href="#3-开启代码质量管理" class="headerlink" title="3. 开启代码质量管理"></a>3. 开启代码质量管理</h2><p>第一次项目导入后会立即进行一次分析，试了一下速度还是比较快的（反正比持续集成快多了），反正我的项目导入以后刷新一下页面就出结果了。</p><p><img src="https://user-gold-cdn.xitu.io/2017/12/13/1604ec0b27f26013?w=1145&h=493&f=png&s=54810"></p><p>唔，细心的同学可能会发现，这一步操作完成后我们在 GitHub 项目 Setting 中的 <code>Webhooks</code> 已经添加了一个属于 <code>codebeat.co</code> 的 Webhook，没错，以后项目代码发生更改后就会自动触发代码质量分析，不需要我们手动操作了。感兴趣的同学可以点击 <code>Edit</code> 按钮查看一下 CodeBeat 具体干了啥：</p><p><img src="https://user-gold-cdn.xitu.io/2017/12/13/1604ec0b294a4d04?w=916&h=360&f=png&s=77638" alt="Webhooks"></p><p>关于 Webhook 感兴趣的同学可以查看 GitHub 官方的资料：<a href="https://developer.github.com/webhooks/">https://developer.github.com/webhooks/</a>。</p><h2 id="4-查看代码质量分析结果"><a href="#4-查看代码质量分析结果" class="headerlink" title="4. 查看代码质量分析结果"></a>4. 查看代码质量分析结果</h2><p>点击进入该项目的分析结果，可以查看到具体的问题，如代码复杂性、代码风格、代码重复等，点击 <code>Quick Wins</code> 这一栏可以查看优先推荐修复的项目，如下图所示：</p><p><img src="https://user-gold-cdn.xitu.io/2017/12/13/1604ec0b2da5c683?w=1162&h=401&f=png&s=70133"></p><p>我们可以对应分析出的代码质量问题对我们的工程代码进行修改，改完直接提交到仓库即可，Webhook 会通知 CodeBeat 进行刷新。</p><h2 id="没了"><a href="#没了" class="headerlink" title="没了"></a>没了</h2><p>在  的项目设置中可以看到更多有意思的玩法，比如将代码质量变化通知发送到 Slack 或邮箱等，也可以将代码质量评级徽标添加到自己的项目 README 中，大佬们可以自行研究…</p><p><img src="https://user-gold-cdn.xitu.io/2017/12/13/1604ec0b2d2ad569?w=1148&h=340&f=png&s=35402" alt="Setting"></p><p>祝操作顺利，🌈</p><hr><blockquote><p>如有任何知识产权、版权问题或理论错误，还请指正。<br><a href="https://www.eyrefree.org/2017/12/13/CodeBeat-GitHub">https://www.eyrefree.org/2017/12/13/CodeBeat-GitHub</a><br>如文中无特殊说明，本站均使用以下协议保护：<a href="http://creativecommons.org/licenses/by-nc-nd/3.0/cn/">署名-非商业性使用-禁止演绎</a>。   </p></blockquote>]]></content>
      
      
      <categories>
          
          <category> GitHub </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CodeBeat </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AppStore 审核 macOS 应用踩坑记录</title>
      <link href="/2017/12/12/AppStore-macOS/"/>
      <url>/2017/12/12/AppStore-macOS/</url>
      
        <content type="html"><![CDATA[<h2 id="1-Guideline-2-3-8-Performance"><a href="#1-Guideline-2-3-8-Performance" class="headerlink" title="1. Guideline 2.3.8 - Performance"></a>1. Guideline 2.3.8 - Performance</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Guideline 2.3.8 - Performance</span><br><span class="line"></span><br><span class="line">We noticed that your app name to be displayed on the App Store does not sufficiently match the name of the app displayed when installed on macOS.</span><br><span class="line"></span><br><span class="line">iTunes Connect Name: EFQRCode</span><br><span class="line"></span><br><span class="line">App Name when Installed: EFQRCode.macos</span><br><span class="line"></span><br><span class="line">App Name when Launched: EFQRCode</span><br><span class="line"></span><br><span class="line">App Name in About/Quit Menu: macOS Example</span><br></pre></td></tr></table></figure><p>大概是说 AppStore 的应用名称和 App 安装后以及 App 内的菜单项目上显示的不符，需要修改每一处到一样后重新打包提交。</p><p>iTunes Connect Name：编辑 iTunes Connect 的 App 信息中 App 名称可更改；<br>App Name when Installed：编辑 Build Setting 中的 Product Name 可更改；</p><h2 id="2-Guideline-5-2-5-Legal"><a href="#2-Guideline-5-2-5-Legal" class="headerlink" title="2. Guideline 5.2.5 - Legal"></a>2. Guideline 5.2.5 - Legal</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Guideline 5.2.5 - Legal</span><br><span class="line"></span><br><span class="line">Your app uses ‘macOS’ in the Installed App Name and Menu Item Names in a manner that is not consistent with Apple&#x27;s trademark guidelines.</span><br><span class="line"></span><br><span class="line">Indicating Mac compatibility in the app name is not necessary for the Mac App Store.</span><br></pre></td></tr></table></figure><p>这条意思是 App 中不应该出现 ‘macOS’ 等不符合苹果商标指南的字样，全局搜索，把不合法的文字出现从按钮 &#x2F; 菜单 &#x2F; 页面去除即可。</p><hr><blockquote><p>如有任何知识产权、版权问题或理论错误，还请指正。<br><a href="https://www.eyrefree.org/2017/12/12/AppStore-macOS">https://www.eyrefree.org/2017/12/12/AppStore-macOS</a><br>如文中无特殊说明，本站均使用以下协议保护：<a href="http://creativecommons.org/licenses/by-nc-nd/3.0/cn/">署名-非商业性使用-禁止演绎</a>。   </p></blockquote>]]></content>
      
      
      <categories>
          
          <category> AppStore </category>
          
      </categories>
      
      
        <tags>
            
            <tag> macOS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>如何将 CocoaPods 库升级到 Swift 4</title>
      <link href="/2017/12/05/CocoaPods-Swift4/"/>
      <url>/2017/12/05/CocoaPods-Swift4/</url>
      
        <content type="html"><![CDATA[<h2 id="零-前言"><a href="#零-前言" class="headerlink" title="零. 前言"></a>零. 前言</h2><p>Swift 版本升级嘛，大家应该都很熟练了，菜单 -&gt; Edit -&gt; Convert -&gt; To Current Swift Syntax…，然后巴拉巴拉一顿操作。emmmn，抱歉，编译过了也不一定能正常使用。</p><p>这次 Swift 3 到 Swift 4 的更新和之前的大版本更新相比，已经平滑了很多，相较之前的动辄几百上千个 error，现在用 Xcode 进行 Convert 之后基本上只需要进行少量人工修正即可，不过仍然有一些点需要注意，本文将会对一些常见的坑或者注意点以及解决方法进行讨论。</p><p>本文以 <a href="https://github.com/EyreFree/EFCountingLabel">EFCountingLabel</a> 的 1.0.3 版本和 Xcode 9.0 为例，主要关于原有的 Swift 3 的 CocoaPods 库到 Swift 4 的升级，仍处于 Swift 2 阶段的同学可暂时忽略本文。</p><h2 id="一-升级流程"><a href="#一-升级流程" class="headerlink" title="一. 升级流程"></a>一. 升级流程</h2><h3 id="1-查看当前版本"><a href="#1-查看当前版本" class="headerlink" title="1. 查看当前版本"></a>1. 查看当前版本</h3><p>首先用 Xcode 打开工程，看一下当前工程设置的 Swift 版本，如果过低的话可能无法直接 Convert，选中需要转换的 target 搜索 <code>swift_ver</code> 即可，如图所示：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-51f2abcb6ffc474c.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p><p>这里 EFCountingLabel 的 Swift 版本为 3.2，如果是 2.x 的话需要自己想办法先转换成 Swift 3.x…</p><h3 id="2-Xcode-代码转换"><a href="#2-Xcode-代码转换" class="headerlink" title="2. Xcode 代码转换"></a>2. Xcode 代码转换</h3><p>接下来，就是利用 Xcode 实现代码转换了，菜单 -&gt; Edit -&gt; Convert -&gt; To Current Swift Syntax…，然后选中需要转换的 target，点击 <code>Next</code> 按钮即可：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-7235c3b6ddb5f4fe.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p><h3 id="3-选择转换模式"><a href="#3-选择转换模式" class="headerlink" title="3. 选择转换模式"></a>3. 选择转换模式</h3><p>然后会出现一个转换模式选项，有 <code>Minimize Inference（recommended）</code> 和 <code>Match Swift 3 Behavior</code> 两个选择，苹果推荐的是第一个选项：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-d603752b86a67dd9.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p><p>苹果官方文档对这两个选项的描述如下，大意是：如果选第一个选项，会仅在必要的时候为方法或属性添加 <code>@objc</code> 标志，不过大部分工作需要用户（也就是你）手动完成，好处是能减少最终生成的二进制文件的大小；如果选择第二个选项，则会按 Swift 3 的方式给所有的地方直接添加 <code>@objc</code> 标志（关于 <code>@objc</code> 标志的介绍大家可以参考 Swift 翻译组的<a href="http://swift.gg/2016/04/20/swift-qa-2016-04-20/">这篇文章</a>），缺点就是不会对生成的二进制文件大小进行优化（也就是跟 Swift 3 一样）：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-0565c3371c173e78.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p><p>这里我们分几种情况：</p><ol><li>如果你的 Swift 库不打算支持 OC 调用的话，选 <code>Minimize Inference（recommended）</code>，检查并且保存自动转换结果即可，然后可以直接跳到下一小节，请忽略下面这一大段；</li><li>如果你的 Swift 库打算支持 OC 调用，但是开发时间紧迫暂时没时间仔细设置 <code>@objc</code> 标志或者对这一点二进制文件体积的缩减并不是十分在意的话，选 <code>Match Swift 3 Behavior</code>，检查并且保存自动转换结果即可，然后可以直接跳到下一小节，请忽略下面这一大段；</li><li>如果你的 Swift 库打算支持 OC 调用，并且打算用推荐的方式进行优化的话，选 <code>Minimize Inference（recommended）</code>，保存更改，然后按下面的操作去做：</li></ol><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1. 编译工程；</span><br><span class="line">2. 修正那些提示你需要添加 @objc 标志的警告（请务必修正，不然即使编译能过运行时也可能会出问题）；</span><br><span class="line">3. 修正 Xcode 提示的不需要添加 @objc 标志的代码，持续构建和测试你的代码，直到没有任何警告出现；</span><br><span class="line">4. 打开工程设置；</span><br><span class="line">5. 选中 target，搜索 `@objc` 找到 `Swift 3 @objc Inference` 选项，设为 `Default`。</span><br></pre></td></tr></table></figure><p>唔，以上这段大概是原文翻译过来的了，官方文档原文如图所示：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-57b6b30c33b54e1f.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p><p>需要注意的是，因为我们这里针对的并不是完整的 iOS 项目，而是 CocoaPods 库，如果你的 OC Demo 没有调用库中需要暴露的功能（或者干脆没有 OC Demo），辣么编译器可能完全不会给你任何提示而是直接通过编译了，直到你某一天在一个 OC 工程中引入这个库才会发现并不能调用到某些方法或获取某些属性。</p><p>所以其实麻烦之处在于，编译器并不会给你任何提示，因为编译器也不知道哪些类 &#x2F; 属性 &#x2F; 方法需要暴露，哪些需要被优化掉，需要开发人员自己决定并手动添加对应的 <code>@objc</code> 标志，总结起来的话有以下几点：</p><ol><li>需要在 OC 中调用一个 Swift 4 的类，需要让这个类继承 NSObject 并且在这个类前加上 @objc 标志；</li><li>需要在 OC 中调用一个 Swift 4 类的方法，需要在方法前加上 @objc 标志（这里有一个坑，如果是普通的函数调用还好，至少编译器会报错，如果是用 <code>#selector</code> 的方式调用的话，能过编译并且在运行时直接找不到对应方法而闪退，建议升完 Swift 4 检查一下所有的 #selector 调用）；</li><li>需要在 OC 中访问一个 Swift 4 类的某个属性，需要在属性前加上 @objc 标志（同上，如果是普通属性访问的话编译器会报错，但是 KVC 的话会在运行时找不到属性而崩溃，记得检查…）；</li><li>需要在 OC 中访问一个 Swift 4 类的扩展，只要在扩展前加上 @objc 标志，该扩展的属性和方法就都能被调用了。</li></ol><h3 id="4-更新-Xcode-设置"><a href="#4-更新-Xcode-设置" class="headerlink" title="4. 更新 Xcode 设置"></a>4. 更新 Xcode 设置</h3><ol><li>如下图所示，根据 Xcode 提示将工程设置进行更新，点击 Warning 后单击 <code>Perform Changes</code> 按钮即可；</li></ol><p><img src="http://upload-images.jianshu.io/upload_images/1018190-450ad5a3dfe1641f.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p><ol start="2"><li>检查设置，将所有 target 的 <code>Swift 3 @objc Inference</code> 设置（如果有的话）改为 <code>Default</code>，之前改过的话就不用改了；</li><li>搜索 <code>swift_ver</code>，可以看到当前的 <code>Swift Language Version</code> 已经是 <code>Swift 4</code> 了。</li></ol><p><img src="http://upload-images.jianshu.io/upload_images/1018190-d10ebceafdcfcb6a.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p><p>剩下少量方法名变动之类的更新大家可以根据提示自行修改，到这里基本就完成了升级过程，不过先别急，接下来我们看注意事项。</p><h2 id="二-注意事项"><a href="#二-注意事项" class="headerlink" title="二. 注意事项"></a>二. 注意事项</h2><p>以下情况必须要给对应的属性或方法添加 <code>@objc</code> 标志（当然，他们所在的类肯定也需要添加 <code>@objc</code> 标志），不管是通过 OC 还是 Swift 调用：</p><ol><li>使用 <code>@selector()</code> 或 <code>#selector()</code> 方式调用的函数；</li><li>使用 KVC 进行访问的属性；</li><li>使用 IBOutlet 或者 IBAction 和 StoryBoard 绑定的函数或属性。</li></ol><p>这些有部分在官方文档中也有提及：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-940d3152de88724d.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p><h2 id="三-一些问题"><a href="#三-一些问题" class="headerlink" title="三. 一些问题"></a>三. 一些问题</h2><ol><li>同一工程的 Pods 库是否可以既有 Swift 3 的也有 Swift 4 的？</li></ol><p>Swift 的版本控制粒度在 framework 层面，也就是说同一个工程中不同的 framework 可以是按不同版本的 Swift 进行编译的，所以并不需要等待项目依赖的所有 Pods 库都支持 Swift 4 后再更新，完全可以将已经升级 Swift 4 的库先用起来。</p><ol start="2"><li><code>Swift 3 @objc Inference</code> 选项是干啥的？</li></ol><p>在 Swift 4 之前，编译器对 Objective-C 自动提供了一些 Swift 声明。例如，编译器会为 NSObject 子类的所有方法创建 Objective-C 入口点，该机制称为 @objc 推断（@objc Inference）。</p><p>在 Swift 4 中，这种自动的 @objc 推断已被废弃，因为生成所有这些 Objective-C 入口点有代价，会增大最终的二进制文件体积。当 <code>Swift 3 @objc Inference</code> 设置为 <code>On</code> 时，它会按照 Swift 4 之前的模式运行，不进行优化，也就是隐式为我们编写的所有 Swift 代码提供 OC 入口。</p><p>但是，当设置为 <code>On</code> 时 Xcode 会报一个警告，建议修复这个警告，并将设置切换到 <code>Default</code>。新的 Swift 项目的默认为“Default”。可以理解为该项设置为 <code>On</code> 时和上文代码转换时选择 <code>Match Swift 3 Behavior</code> 选项效果类似。</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-f32398e06f3f1538.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p><h2 id="四-没了"><a href="#四-没了" class="headerlink" title="四. 没了"></a>四. 没了</h2><p>升级完请务必跑一遍整体测试流程，暗坑无数，以防万一，祝大家线上稳定。</p><hr><blockquote><p>如有任何知识产权、版权问题或理论错误，还请指正。<br><a href="https://www.eyrefree.org/2017/12/05/CocoaPods-Swift4">https://www.eyrefree.org/2017/12/05/CocoaPods-Swift4</a><br>如文中无特殊说明，本站均使用以下协议保护：<a href="http://creativecommons.org/licenses/by-nc-nd/3.0/cn/">署名-非商业性使用-禁止演绎</a>。   </p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Swift </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CocoaPods </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Swift 流水账：踩到一个 Enum 坑（并不是</title>
      <link href="/2017/08/15/Swift-Enum/"/>
      <url>/2017/08/15/Swift-Enum/</url>
      
        <content type="html"><![CDATA[<p>今天，天气晴朗，阳光明媚，我像往常一样赖床赖到了九点半，然后在最后一遍起床闹钟的催促声中穿起了衣服，飞一般地冲出了出租屋，蹬上小区门口的小黄，一路冲刺，在即将迟到的前 1s 到达了工位，和平的日常呢。</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-ee973c8209f8dd57.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p><p>熟练地打开 XCode（我为什么这么熟练呢…）启动项目，开始继续完成产品大大昨天下达的任务。这时，一个枚举进入了我的视野范围内，枚举常量数据类型是 NSUInteger，哼哼，用表驱动法结合 rawValue 的方式，就能优雅地实现这个需求了，完美。</p><p>然而，跑了一下居然发生了运行时错误炸掉了…没道理啊，这也能炸…</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-59ea929cb1b4246e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="EyreFree 眉头一皱，发现事情并不简单"></p><p>点开这个枚举类型，仔细观察了起来…然后发现了一个坑…（应该是我年少无知…</p><p>下面，我带着大家一起跳进这个坑…哦不，一起复现一下这个问题：</p><h3 id="1-新建一个-OC-的-Pod-库"><a href="#1-新建一个-OC-的-Pod-库" class="headerlink" title="1. 新建一个 OC 的 Pod 库"></a>1. 新建一个 OC 的 Pod 库</h3><p>首先，我们需要新建一个 OC 的 Pod 库，然后在其中定义一个枚举类型，指定枚举值从 2 开始（反正不要是默认的 0 就行），大概这个样子就行了：</p><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="meta">#import <span class="string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">NS_ENUM</span>(<span class="built_in">NSUInteger</span>, TestEnum) &#123;</span><br><span class="line">    TestEnumA = <span class="number">2</span>,</span><br><span class="line">    TestEnumB,</span><br><span class="line">    TestEnumC,</span><br><span class="line">    TestEnumD,</span><br><span class="line">    TestEnumE,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> TestEnum EFTestEnumType;</span><br></pre></td></tr></table></figure><p><img src="http://upload-images.jianshu.io/upload_images/1018190-2529d4f32de43374.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="1"></p><h3 id="2-新建一个-Swift-工程"><a href="#2-新建一个-Swift-工程" class="headerlink" title="2. 新建一个 Swift 工程"></a>2. 新建一个 Swift 工程</h3><p>然后，我们再建一个新的 Swift 工程（没错，我司项目是 Swift 的…），在其中引入第一步建好的 CocoaPods 库。到这里，我们可以随便找个地方编写如下测试代码：</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&quot;<span class="subst">\(EFTestEnumType.A.rawValue)</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p>先不要执行蛤，大家按住 command 键点击 EFTestEnumType 进入类型定义可以看到如下代码：</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">TestEnum</span> : <span class="title class_">UInt</span> &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="type">A</span></span><br><span class="line">    <span class="keyword">case</span> <span class="type">B</span></span><br><span class="line">    <span class="keyword">case</span> <span class="type">C</span></span><br><span class="line">    <span class="keyword">case</span> <span class="type">D</span></span><br><span class="line">    <span class="keyword">case</span> <span class="type">E</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">typealias</span> <span class="type">EFTestEnumType</span> <span class="operator">=</span> <span class="type">TestEnum</span></span><br></pre></td></tr></table></figure><p>注意到了么，这里通过 Pod 库中的原始 OC 代码转化出的中间 Swift 代码的枚举中，并没有指定枚举值的起始值。</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-b2e7873bd027cbed.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="2"></p><h3 id="3-编译运行并观察"><a href="#3-编译运行并观察" class="headerlink" title="3. 编译运行并观察"></a>3. 编译运行并观察</h3><p>然后编译运行，观察测试代码的输出会发现，EFTestEnumType.A.rawValue 的值的确是 2…所以，我在主工程中查看了某个枚举类型的定义，而没有注意到 Pod 库中枚举的原始定义是指定了枚举值的起始值的（很好奇为啥这里不一样，搞这么多幺蛾子…），然后就炸了，数组下标越界，初始化失败，随便来一个都会炸掉了…</p><p>小伙伴们看懂了么…（嘛，如果这是常识的话…请告诉我我好删掉这篇水文…逃…</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-94efe02f989268af.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p><p>PS: 文中所用代码可以在 <a href="https://github.com/EyreFree/EFEnumPitDemo">https://github.com/EyreFree/EFEnumPitDemo</a> 找到。</p><hr><p>更新：</p><p>感谢 <a href="http://www.weibo.com/kemchenj">@kemchenj</a> 大大的提示，这里应该需要将鼠标悬浮到枚举值之上才可以查看到对应的原始值，反正我还是觉得坑…[摊手]</p><blockquote><p>@kemchenj：看了很久之后终于懂了，其实主要是 Interface 的锅，Interface 里不会显示枚举值的具体原始值，跟 OC 转 Swift 无关，你可以在 Swift 里定义一个相同的枚举，然后进 Xcode 菜单 -&gt; Navigate -&gt; Jump To Generated Interface，这样就可以看到这个 swift 文件的 Interface 了，也不会具体的 rawValue</p></blockquote><p><img src="http://upload-images.jianshu.io/upload_images/1018190-afadd3defe195ad7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p><hr><blockquote><p>如有任何知识产权、版权问题或理论错误，还请指正。<br><a href="https://www.eyrefree.org/2017/08/15/Swift-Enum">https://www.eyrefree.org/2017/08/15/Swift-Enum</a><br>如文中无特殊说明，本站均使用以下协议保护：<a href="http://creativecommons.org/licenses/by-nc-nd/3.0/cn/">署名-非商业性使用-禁止演绎</a>。   </p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Swift </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Enum </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>GitHub Wiki 页面的添加和设置</title>
      <link href="/2017/07/06/GitHub-Wiki-Introduction/"/>
      <url>/2017/07/06/GitHub-Wiki-Introduction/</url>
      
        <content type="html"><![CDATA[<p>目前大家在 GitHub 上发布的项目，一般使用 Markdown 来编写项目文档和 README.md 等。Markdown 一般情况下能够满足我们的文档编写需求，如果使用得当的话，效果也非常棒。不过当项目文档比较长的时候，阅读体验可能就不是那么理想了，这种情况我想大家应该都曾经遇到过。</p><p>GitHub 每一个项目都有一个独立完整的 Wiki 页面，我们可以用它来实现项目信息管理，为项目提供更加完善的文档。我们可以把 Wiki<br> 作为项目文档的一个重要组成部分，将冗长、具体的文档整理成 Wiki，将精简的、概述性的内容，放到项目中或是 README.md 里。</p><h2 id="一-Wiki-简介"><a href="#一-Wiki-简介" class="headerlink" title="一. Wiki 简介"></a>一. Wiki 简介</h2><blockquote><p>Wiki 是一种在网络上开放且可供多人协同创作的超文本系统，由沃德·坎宁安于 1995 年首先开发，这种超文本系统支持面向社群的协作式写作，同时也包括一组支持这种写作。Wiki 站点可以有多人（甚至任何访问者）维护，每个人都可以发表自己的意见，或者对共同的主题进行扩展或者探讨。</p></blockquote><p>上面这段描述引用自 <a href="http://baike.baidu.com/item/wiki/97755">百度百科</a>，嗯，实际上百度百科本身也是一个 Wiki，最著名的 Wiki 大概是是 <a href="https://zh.wikipedia.org/wiki/%E7%BB%B4%E5%9F%BA%E7%99%BE%E7%A7%91">维基百科</a> 了吧。</p><p>然后 Wiki 页面效果大概可以参考 <a href="https://github.com/onevcat/Kingfisher/wiki">Kingfisher</a>，看起来还是非常棒的：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-51b1b1ab89fc7d4a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Kingfisher 的 Wiki 页面"></p><h2 id="二-Wiki-的开启和关闭"><a href="#二-Wiki-的开启和关闭" class="headerlink" title="二. Wiki 的开启和关闭"></a>二. Wiki 的开启和关闭</h2><p>GitHub 项目的 Wikis 功能默认是开启的，如果你没有找到 Wiki 选项卡，可能是因为该项目关闭了 Wikis 选项，在项目 Setting 中将其选中即可，如图所示：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-55bf326e65831bdb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Wikis 开关"></p><p>如果在之后某一天决定不再继续使用 Wikis 也可以通过取消该功能的勾选将其关闭，即使已经添加了 Wiki 页面也可以。并且会保存之前的 Wiki 页面内容，即关闭 Wiki 功能并不会清除内容，还可以随时再打开。</p><h2 id="三-创建和编辑页面"><a href="#三-创建和编辑页面" class="headerlink" title="三. 创建和编辑页面"></a>三. 创建和编辑页面</h2><p>GitHub 的 Wiki 页面在如图所示选项卡下，默认应该是开启的，但是是空的，我们可以点击中间那个绿色的 <code>Create the first page</code> 按钮创建一个页面。</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-fadd06a0b50a299b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="创建 Wiki 页面"></p><p>如果你没有找到 Wiki 选项卡，可能是因为该项目关闭了 Wikis 选项，在项目 Setting 中将其选中即可，参考上文内容。</p><p>点击 <code>Create the first page</code> 按钮后会进入 Create new page 页面：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-b5082f398cf04cd2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Create new page"></p><p>从上往下进行介绍，顶部的输入框是页面标题；Edit mode 控制编辑页面的标记语言类型，这里默认的是 Markdown，支持的类型如下图所示：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-8955fdc3169fe36c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Edit mode 下拉列表"></p><p>中间的是页面内容，我们可以用 Edit mode 选择的语法在这里编写页面内容；底部编辑框用来输入本次编辑保存时的提交信息；编辑完成后点击 <code>Save Page</code> 按钮即可保存，唔，保存前可以先切换到 Preview 选项卡下进行预览，看一下效果是否是自己想要的。</p><p>然后保存我们新建的页面，大概会是如下效果：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-f3bbc7ae3f87d86a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="新建页面完成"></p><p>点击右上角的 <code>Edit</code> 按钮可以对当前页面进行编辑，也可以点击 <code>New Page</code> 按钮继续添加新的页面。</p><p>唔，这里有一点需要注意的是，默认的主页标题必须为 Home，如果不存在标题为 Home 的页面，切换到项目的 Wiki 选项卡时，会显示一个所有页面组成的列表。所以我们的主页必须以 Home 为标题。</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-ac17b4a9220d4503.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p><p>目前好像没什么内容，感觉比较空额，不过没关系，接下来我们会一步步完善。</p><h2 id="四-添加页脚"><a href="#四-添加页脚" class="headerlink" title="四. 添加页脚"></a>四. 添加页脚</h2><p>点击 Wiki 页面底部的 <code>Add a custom footer</code> 按钮，进入新建页脚页面，如图所示：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-898c1c9b8ff154b1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Add a custom footer"></p><p>新建页脚页面实际上就是一个普通的 Create new page 页面，不过标题需要设为 _Footer 并且不能修改（如果修改了就不会被当作页脚来处理了）。</p><p>我们可以参考 Kingfisher 的页脚代码，放置多个超链接在这里供读者在阅读完某一页后快速跳转到关键的章节或页面去，具体代码和效果如下：</p><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">[<span class="string">Installation</span>](<span class="link">https://github.com/onevcat/Kingfisher/wiki/Installation-Guide</span>) - [<span class="string">Cheat Sheet</span>](<span class="link">https://github.com/onevcat/Kingfisher/wiki/Cheat-Sheet</span>) - [<span class="string">FAQ</span>](<span class="link">https://github.com/onevcat/Kingfisher/wiki/FAQ</span>) - [<span class="string">API Reference</span>](<span class="link">http://onevcat.github.io/Kingfisher/</span>)</span><br></pre></td></tr></table></figure><p><img src="http://upload-images.jianshu.io/upload_images/1018190-ff95cc5b1f8caeb7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Kingfisher 页脚效果"></p><p>当然也可以放一些奇怪的东西，比如，这样的：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-58c20385b24679b8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="+1s"></p><p>如上图所示，点击页脚右侧的编辑按钮，就可以对页脚进行编辑啦，很方便。</p><h2 id="五-添加侧边栏"><a href="#五-添加侧边栏" class="headerlink" title="五. 添加侧边栏"></a>五. 添加侧边栏</h2><p>点击右侧的 <code>Add a custom sidebar</code> 按钮可以添加侧边栏，和页脚同理，页面名为特殊的 _Sidebar：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-d71291cb72c041e0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Add a custom sidebar"></p><p>我们可以参考 Kingfisher 的侧边栏实现，代码和效果如下：</p><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="section">## Getting Started</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">*</span> [<span class="string">Getting Started with Kingfisher</span>](<span class="link">https://github.com/onevcat/Kingfisher/wiki/Getting-Started-with-Kingfisher</span>)</span><br><span class="line"><span class="bullet">    *</span> [<span class="string">Install Kingfisher</span>](<span class="link">https://github.com/onevcat/Kingfisher/wiki/Installation-Guide</span>)</span><br><span class="line"><span class="bullet">    *</span> [<span class="string">Cheat Sheet</span>](<span class="link">https://github.com/onevcat/Kingfisher/wiki/Cheat-Sheet</span>)</span><br><span class="line"><span class="bullet">*</span> [<span class="string">API Reference</span>](<span class="link">http://onevcat.github.io/Kingfisher/</span>)</span><br><span class="line"></span><br><span class="line"><span class="section">## Migration Guide</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">*</span> [<span class="string">3.0 Migration Guide</span>](<span class="link">https://github.com/onevcat/Kingfisher/wiki/Kingfisher-3.0-Migration-Guide</span>)</span><br><span class="line"><span class="bullet">*</span> [<span class="string">2.0 Migration Guide</span>](<span class="link">https://github.com/onevcat/Kingfisher/wiki/Kingfisher-2.0-Migration-Guide</span>)</span><br><span class="line"></span><br><span class="line"><span class="section">## Communication</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">*</span> [<span class="string">FAQ</span>](<span class="link">https://github.com/onevcat/Kingfisher/wiki/FAQ</span>)</span><br><span class="line"><span class="bullet">*</span> [<span class="string">Ask a question</span>](<span class="link">http://stackoverflow.com/search?q=kingfisher</span>)</span><br><span class="line"><span class="bullet">*</span> [<span class="string">Submit an issue</span>](<span class="link">https://github.com/onevcat/Kingfisher/issues/new</span>)</span><br><span class="line"><span class="bullet">*</span> [<span class="string">Open a pull request</span>](<span class="link">https://github.com/onevcat/Kingfisher/compare</span>)</span><br><span class="line"></span><br><span class="line"><span class="section">## Information</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">*</span> [<span class="string">Change Log</span>](<span class="link">https://github.com/onevcat/Kingfisher/blob/master/CHANGELOG.md</span>)</span><br></pre></td></tr></table></figure><p><img src="http://upload-images.jianshu.io/upload_images/1018190-eb156bb5531e33ab.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Kingfisher 的侧边栏"></p><p>这里的话可以自己适当摸索一下，调整标题层级等样式，以获得一个自己比较满意的展示效果。同样的，点击侧边栏右上角的编辑按钮可以对快速侧边栏进行在线编辑。</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-9935667a3e9db865.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="侧边栏编辑按钮"></p><h2 id="六-查看编辑历史"><a href="#六-查看编辑历史" class="headerlink" title="六. 查看编辑历史"></a>六. 查看编辑历史</h2><p>进入某个页面的编辑页面，点击右上角的 <code>Page History</code> 按钮，可以查看该页面的编辑历史，如下图所示：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-4b8793bbd61f8087.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Page History 按钮"></p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-f4738bce2c4201fa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="编辑历史页面"></p><h2 id="七-权限控制"><a href="#七-权限控制" class="headerlink" title="七. 权限控制"></a>七. 权限控制</h2><p>那么问题来了，既然是 Wiki 的话，为啥以上这些内容完全是项目所有者一个人手撸呢，完全没有体现出「多人协作」的特性啊喂。</p><p>嗯，GitHub Wiki 是可以开放给所有人编辑权限的，不过默认是只有项目所有者和合作者才有权限编辑的，只要到 Setting 中将 Restrict editing to collaborators only 选项去除勾选即可。</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-eeda3279fe26cc8f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Restrict editing to collaborators only"></p><p>这样的话，只要有 GitHub 账号的用户，都可以对该项目的 Wiki 进行编辑。如果怕被胡乱篡改，不想开放编辑权限的话，还是保持勾选好了。</p><h2 id="八-本地编辑"><a href="#八-本地编辑" class="headerlink" title="八. 本地编辑"></a>八. 本地编辑</h2><p>唔，上文内容一直在介绍 Wiki 的在线编辑，实际上 Wiki 是一个单独的 Git 仓库，可以 Clone 到本地进行操作</p><h3 id="1-Wiki-仓库下载"><a href="#1-Wiki-仓库下载" class="headerlink" title="1. Wiki 仓库下载"></a>1. Wiki 仓库下载</h3><p>细心的同学应该已经注意到了，Wiki 的右下角处有当前 Wiki 的 Git 仓库地址（我们也可以通过该方法下载他人所属的 Wiki 页面的源代码）：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-23f30e41d4d6981b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Wiki 仓库地址"></p><p>Kingfisher 的 Wiki 仓库结构如下：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-6795f9e7aaa9440a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Kingfisher Wiki 结构"></p><p>接下来就可以直接对 Wiki 页面源文件进行编辑了，实际上就是一堆 Markdown 文件的组合（或者其他比标记语言，看你选的是啥了）。</p><h3 id="2-本地预览"><a href="#2-本地预览" class="headerlink" title="2. 本地预览"></a>2. 本地预览</h3><p>我们在本地手动编辑编辑完成后，只能通过 push 到 GitHub 的方式进行预览，非常不方便，这个时候，就需要借助一个叫 <a href="https://github.com/gollum/gollum">gollum</a> 的工具了。</p><p>Gollum 是 GitHub 上用到的 Wiki 引擎，使用它可以在本地上搭建一个类似的GitHub Wiki 的网站，对本地的 Wiki 页面进行快速预览。执行以下命令即可安装：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo gem install gollum</span><br></pre></td></tr></table></figure><p>安装完成后，将路径切换到 Wiki 的 Git 仓库下然后执行 <code>gollum</code> 命令，然后访问 <a href="http://127.0.0.1:4567/">http://127.0.0.1:4567/</a> 即可进行预览。</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-34b7d6d79ffd94cd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Gollum 预览"></p><h2 id="九-其他"><a href="#九-其他" class="headerlink" title="九. 其他"></a>九. 其他</h2><p>Wiki 不仅仅可以作为项目辅助工具来用，你也可以把它当作一个个人信息知识库来使用，不需要搭建，不需要部署，无需付费，方便快捷，更多功鞥大家可以自行开发。</p><p>如果你觉得上文的报道，哦不，描述可能有偏差，<a href="https://help.github.com/categories/wiki/">GitHub Wiki 的帮助文档</a> 也许能给你带来一些帮助。</p><hr><blockquote><p>如有任何知识产权、版权问题或理论错误，还请指正。<br><a href="https://www.eyrefree.org/2017/07/06/GitHub-Wiki-Introduction">https://www.eyrefree.org/2017/07/06/GitHub-Wiki-Introduction</a><br>如文中无特殊说明，本站均使用以下协议保护：<a href="http://creativecommons.org/licenses/by-nc-nd/3.0/cn/">署名-非商业性使用-禁止演绎</a>。   </p></blockquote>]]></content>
      
      
      <categories>
          
          <category> GitHub </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Wiki </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>GitHub 项目徽章的添加和设置</title>
      <link href="/2017/05/01/GitHub-Badge-Introduction/"/>
      <url>/2017/05/01/GitHub-Badge-Introduction/</url>
      
        <content type="html"><![CDATA[<p>许多同学在 GitHub 上发布了自己的开源项目，有辛苦开发的实用工具、构思巧妙的开源库、别具一格的 App、精心整理的示例代码等等。</p><p>自己花了大把时间和精力构建的项目，当然是希望能够得到更多人的关注，被更多的人知晓或者使用。如何更好滴向他人展示自己的项目，介绍项目相关信息呢？用一些通用的小图标来描述项目相关信息不失为一种很棒的选择，几个好看的徽标能够为自己的项目说明增色不少！</p><h1 id="一-徽标简介"><a href="#一-徽标简介" class="headerlink" title="一. 徽标简介"></a>一. 徽标简介</h1><p>GitHub 项目的 README.md 中可以添加徽章（Badge）对项目进行标记和说明，这些好看的小图标不仅简洁美观，而且还包含了清晰易读的信息。</p><p>徽标主要由图片和对应的链接（当然，你可以不填）组成，徽标图片的话一般由左半部分的名称和右半部分的值组成。</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-3489b47031ed2017.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="一枚普通的徽标"></p><p>GitHub 徽标的官方网站是 <a href="http://shields.io/">http://shields.io/</a>，我萌可以在官网预览绝大部分的徽标样式，然后选择自己喜欢的（当然首先需要适用于自己的目标项目）徽标，添加到自己的项目文档中去。</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-b2676f0571e5684c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Shields.IO"></p><p>下面贴出几个栗子以供参考：</p><ul><li>正在学习的 ReSwift</li></ul><p><a href="https://travis-ci.org/ReSwift/ReSwift"><img src="https://img.shields.io/travis/ReSwift/ReSwift/master.svg?style=flat-square" alt="Build Status"></a> <a href="http://codecov.io/github/ReSwift/ReSwift"><img src="https://img.shields.io/codecov/c/github/ReSwift/ReSwift.svg?style=flat-square" alt="Code coverage status"></a> <a href="https://cocoapods.org/pods/ReSwift"><img src="https://img.shields.io/cocoapods/v/ReSwift.svg?style=flat-square" alt="CocoaPods Compatible"></a> <a href="https://github.com/ReSwift/ReSwift/blob/master/LICENSE.md"><img src="https://img.shields.io/badge/platform-ios%20%7C%20osx%20%7C%20tvos%20%7C%20watchos-lightgrey.svg?style=flat-square" alt="Platform support"></a> <a href="https://github.com/ReSwift/ReSwift/blob/master/LICENSE.md"><img src="https://img.shields.io/badge/license-MIT-blue.svg?style=flat-square" alt="License MIT"></a></p><ul><li>大名鼎鼎的 Kingfisher</li></ul><p align="center"><img src="https://raw.githubusercontent.com/onevcat/Kingfisher/master/images/logo.png" alt="Kingfisher" title="Kingfisher" width="557"/></p><p align="center"><a href="https://travis-ci.org/onevcat/Kingfisher"><img src="https://img.shields.io/travis/onevcat/Kingfisher/master.svg"></a><a href="https://github.com/Carthage/Carthage/"><img src="https://img.shields.io/badge/Carthage-compatible-4BC51D.svg?style=flat"></a><a href="https://swift.org/package-manager/"><img src="https://img.shields.io/badge/SPM-ready-orange.svg"></a><a href="http://onevcat.github.io/Kingfisher/"><img src="https://img.shields.io/cocoapods/v/Kingfisher.svg?style=flat"></a><a href="https://raw.githubusercontent.com/onevcat/Kingfisher/master/LICENSE"><img src="https://img.shields.io/cocoapods/l/Kingfisher.svg?style=flat"></a><a href="http://onevcat.github.io/Kingfisher/"><img src="https://img.shields.io/cocoapods/p/Kingfisher.svg?style=flat"></a><a href="https://codebeat.co/projects/github-com-onevcat-kingfisher"><img alt="codebeat badge" src="https://codebeat.co/assets/svg/badges/A-398b39-669406e9e1b136187b91af587d4092b0160370f271f66a651f444b990c2730e9.svg" /></a><img src="https://img.shields.io/badge/made%20with-%3C3-orange.svg"></p><ul><li>家喻户晓的 Alamofire</li></ul><p><img src="https://raw.githubusercontent.com/Alamofire/Alamofire/assets/alamofire.png" alt="Alamofire: Elegant Networking in Swift"></p><p><a href="https://travis-ci.org/Alamofire/Alamofire"><img src="https://travis-ci.org/Alamofire/Alamofire.svg?branch=master" alt="Build Status"></a><br><a href="https://img.shields.io/cocoapods/v/Alamofire.svg"><img src="https://img.shields.io/cocoapods/v/Alamofire.svg" alt="CocoaPods Compatible"></a><br><a href="https://github.com/Carthage/Carthage"><img src="https://img.shields.io/badge/Carthage-compatible-4BC51D.svg?style=flat" alt="Carthage Compatible"></a><br><a href="http://cocoadocs.org/docsets/Alamofire"><img src="https://img.shields.io/cocoapods/p/Alamofire.svg?style=flat" alt="Platform"></a><br><a href="http://twitter.com/AlamofireSF"><img src="https://img.shields.io/badge/twitter-@AlamofireSF-blue.svg?style=flat" alt="Twitter"></a><br><a href="https://gitter.im/Alamofire/Alamofire?utm_source=badge&utm_medium=badge&utm_campaign=pr-badge"><img src="https://badges.gitter.im/Alamofire/Alamofire.svg" alt="Gitter"></a></p><p>徽标并不是添加的越多越好，合理地选择适合项目的徽标做具有针对性地添加才是理性的做法，像 <a href="https://github.com/EyreFree/EFQRCode">EFQRCode</a> 这样堆积徽标的无脑行为并不是十分可取，在这里提出这一点，希望大家不要盲目追求数量。</p><ul><li>腊鸡 EFQRCode</li></ul><p><img src="https://raw.githubusercontent.com/EyreFree/EFQRCode/assets/EFQRCode.jpg"></p><p align="center"><a href="https://travis-ci.org/EyreFree/EFQRCode"><img src="http://img.shields.io/travis/EyreFree/EFQRCode.svg"></a><a href="https://codecov.io/gh/EyreFree/EFQRCode"><img src="https://codecov.io/gh/EyreFree/EFQRCode/branch/master/graph/badge.svg"></a><a href="https://github.com/Carthage/Carthage/"><img src="https://img.shields.io/badge/Carthage-compatible-4BC51D.svg?style=flat"></a><a href="https://swift.org/package-manager/"><img src="https://img.shields.io/badge/SPM-ready-orange.svg"></a><a href="http://cocoapods.org/pods/EFQRCode"><img src="https://img.shields.io/cocoapods/v/EFQRCode.svg?style=flat"></a><a href="http://cocoapods.org/pods/EFQRCode"><img src="https://img.shields.io/cocoapods/p/EFQRCode.svg?style=flat"></a><a href="https://github.com/apple/swift"><img src="https://img.shields.io/badge/language-swift-orange.svg"></a><a href="https://codebeat.co/projects/github-com-eyrefree-efqrcode-master"><img src="https://codebeat.co/badges/01f53e9d-542c-4c22-adc7-d1dbff0d2a6f"></a><a href="https://raw.githubusercontent.com/EyreFree/EFQRCode/master/LICENSE"><img src="https://img.shields.io/cocoapods/l/EFQRCode.svg?style=flat"></a><a href="https://gitter.im/EFQRCode/Lobby"><img src="https://badges.gitter.im/EyreFree/EFQRCode.svg"></a><a href="https://twitter.com/EyreFree777"><img src="https://img.shields.io/badge/twitter-@EyreFree777-blue.svg?style=flat"></a><a href="http://weibo.com/eyrefree777"><img src="https://img.shields.io/badge/weibo-@EyreFree-red.svg?style=flat"></a></p><p>当然如果个人比较喜欢的话，请随意添加。</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-bd12202658a6a391.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="请随意"></p><h1 id="二-常用徽标添加"><a href="#二-常用徽标添加" class="headerlink" title="二. 常用徽标添加"></a>二. 常用徽标添加</h1><p>常用的徽标主要有持续集成状态、项目版本信息、代码测试覆盖率、项目支持平台、项目语言、代码分析等，下面我萌就来依次添加这些可爱的徽标！</p><h2 id="1-持续集成状态"><a href="#1-持续集成状态" class="headerlink" title="1. 持续集成状态"></a>1. 持续集成状态</h2><p>持续集成的话推荐 <a href="https://travis-ci.org/">Travis CI</a>，针对开源项目免费，所以你的私有项目无法享受到免费的持续构建服务，不过我们的目的貌似就是给开源项目添加徽标。</p><p>同类型的产品还有 <a href="https://circleci.com/">CircleCI</a>，不过目前跑 OS X 项目需要额外付费，免费版提供一个 Linux 项目队列，作为非付费用户在这里不多做评价，大佬们可以自己试下。其他还有诸如 <a href="https://jenkins.io/">Jenkins</a><br> 和 <a href="https://codeship.com/">Codeship</a> 等，大家可以在 <a href="http://shields.io/">http://shields.io/</a> 的 <code>Build</code> 这一栏自行翻阅。</p><p>接下来就是 Travis CI 的集成工作了，首先打开 <a href="https://travis-ci.org/">https://travis-ci.org/</a> 注册一个 Travis-CI 账号，可以通过 GitHub 账户直接登陆。</p><p>然后参考 <a href="https://docs.travis-ci.com/user/getting-started/">官方文档</a>，根据你的项目语言或类型选择具体的配置方式，主要就是在项目中添加一个 <code>.travis.yml</code> 配置文件，告诉 Travis CI 怎样对你的项目进行编译或测试。这里有一个 Swift CocoaPods 库的集成示例，可以参考一下：<a href="http://www.jianshu.com/p/beaa9ec9183d">http://www.jianshu.com/p/beaa9ec9183d</a>。</p><p>然后徽标图片地址是这个样子的：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://img.shields.io/travis/&#123;GitHub 用户名&#125;/&#123;项目名称&#125;.svg</span><br></pre></td></tr></table></figure><p>将上面 URL 中的 {GitHub 用户名} 和 {项目名称} 替换为你的即可，再加上该项目在 Travis CI 上的地址，以 Alamofire 为例，最后集成完成的 Markdown 代码和效果大概是这个样子：</p><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">[<span class="string">![</span>](<span class="link">https://travis-ci.org/Alamofire/Alamofire.svg?branch=master</span>)](<span class="link">https://travis-ci.org/Alamofire/Alamofire</span>)</span><br></pre></td></tr></table></figure><p><a href="https://travis-ci.org/Alamofire/Alamofire"><img src="https://travis-ci.org/Alamofire/Alamofire.svg?branch=master"></a></p><p>当然如果你的编译没跑过或者发生错误之类的，会出现其他的状态，比如酱紫的：</p><p><img src="https://img.shields.io/codeship/d6c1ddd0-16a3-0132-5f85-2e35c05e22b1.svg"></p><p><img src="https://img.shields.io/vso/build/larsbrinkhoff/953a34b9-5966-4923-a48a-c41874cfb5f5/1.svg"></p><p><img src="https://img.shields.io/snap-ci/ThoughtWorksStudios/eb_deployer/master.svg"></p><p>这里需要指出的是，开源项目的 Travis CI 也是公开的，包括日志和历史记录在内，都是针对所有人可见的，所以小伙伴们一定不要把密码、私钥等重要信息暴露了。</p><h2 id="2-项目下载量"><a href="#2-项目下载量" class="headerlink" title="2. 项目下载量"></a>2. 项目下载量</h2><p>项目被下载的次数，这个的话各个平台的统计都是独立的，比如发布在 CocoaPods 的项目下载量徽标图片地址如下，以 AFNetworking 为例：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">总下载量：https://img.shields.io/cocoapods/dt/AFNetworking.svg</span><br><span class="line">月下载量：https://img.shields.io/cocoapods/dm/AFNetworking.svg</span><br><span class="line">周下载量：https://img.shields.io/cocoapods/dw/AFNetworking.svg</span><br></pre></td></tr></table></figure><p>效果如下：</p><p><img src="https://img.shields.io/cocoapods/dt/AFNetworking.svg"><br><img src="https://img.shields.io/cocoapods/dm/AFNetworking.svg"><br><img src="https://img.shields.io/cocoapods/dw/AFNetworking.svg"></p><p>如果你的库已经发布到 CocoaPods 的话，我们只要把上面的 AFNetworking 改为自己的项目名称即可。更多其他发布方式如 apm、npm、Gem 等可查阅 <a href="http://shields.io/">http://shields.io/</a> 的 <code>Downloads</code> 一栏。</p><h2 id="3-项目版本信息"><a href="#3-项目版本信息" class="headerlink" title="3. 项目版本信息"></a>3. 项目版本信息</h2><p>这个的话，因为我的 iOS 库是发布在 CocoaPods 的，我用的是 CocoaPods 提供的，URL 如下：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://img.shields.io/cocoapods/v/&#123;项目名称&#125;.svg?style=flat</span><br></pre></td></tr></table></figure><p>以 Alamofire 为例，Markdown 代码和效果如下：</p><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">![](<span class="link">https://img.shields.io/cocoapods/v/Alamofire.svg?style=flat</span>)</span><br></pre></td></tr></table></figure><p><img src="https://img.shields.io/cocoapods/v/Alamofire.svg?style=flat"></p><p>如果你的库已经发布到 CocoaPods 的话，我们只要把上面的 Alamofire 改为自己的项目名称即可。更多其他发布方式如 apm、npm、Gem 等可查阅 <a href="http://shields.io/">http://shields.io/</a> 的 <code>Version</code> 一栏，这里提供一个可以查询已发布的各种包的版本号徽标地址的网站 <a href="https://badge.fury.io/">https://badge.fury.io/</a>，可以轻松获取对应包的徽标代码，如下图所示</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-a6257e9b997c4a7f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p><p>如果你的发布工具不提供项目版本信息的徽标的话，可以用自定义徽标的方式实现，具体可参考下文自定义徽标一节，这里给出徽标代码：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://img.shields.io/badge/&#123;发布方式&#125;-&#123;版本号&#125;-519dd9.svg</span><br></pre></td></tr></table></figure><p>将 {发布方式} 和 {版本号} 替换为你的项目目前的发布方式和版本号即可，例如通过 360 应用商店发布，发布版本号为 v1.2.3：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">![](https://img.shields.io/badge/360_store-v1.2.3-519dd9.svg)</span><br></pre></td></tr></table></figure><p><img src="https://img.shields.io/badge/360_store-v1.2.3-519dd9.svg"></p><h2 id="4-代码测试覆盖率"><a href="#4-代码测试覆盖率" class="headerlink" title="4. 代码测试覆盖率"></a>4. 代码测试覆盖率</h2><p>代码测试覆盖率的话推荐 <a href="https://codecov.io/">Codecov</a>。同类产品有 <a href="https://coveralls.io/">Coveralls</a>，不过网站风格略复古，文档也不详细，安装过程也复杂，需要配置一大堆奇怪的东西，遂不推荐。</p><p>同样的，Codecov 可以直接使用 GitHub 账号登陆，需要结合 Travis CI 使用，在 <code>.travis.yml</code> 文件中添加一个回调触发 Codecov 的刷新，同时需要打开工程中的测试覆盖信息收集，XCode 中的设置如下</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-a1fceb0028ce645a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Paste_Image.png"></p><p>更多信息可参考 <a href="https://docs.codecov.io/docs">官方文档</a> 和 <a href="https://github.com/codecov">示例</a>。</p><p>然后，我们就可以在 Setting 中的 Badge 一栏找到添加图标的代码啦：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-95306d0d263235c2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Paste_Image.png"></p><p>最终效果如下：</p><p><a href="https://codecov.io/gh/EyreFree/EFQRCode"><img src="https://codecov.io/gh/EyreFree/EFQRCode/branch/master/graph/badge.svg" alt="codecov"></a></p><h2 id="5-项目支持平台"><a href="#5-项目支持平台" class="headerlink" title="5. 项目支持平台"></a>5. 项目支持平台</h2><p>这个的话，因为我的 iOS 库是发布在 CocoaPods 的，我用的是 CocoaPods 提供的，URL 如下：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://img.shields.io/cocoapods/p/&#123;项目名称&#125;.svg?style=flat</span><br></pre></td></tr></table></figure><p>以 Alamofire 为例，Markdown 代码和效果如下：</p><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">![](<span class="link">https://img.shields.io/cocoapods/p/Alamofire.svg?style=flat</span>)</span><br></pre></td></tr></table></figure><p><img src="https://img.shields.io/cocoapods/p/Alamofire.svg?style=flat"></p><p>如果你的库已经发布到 CocoaPods 的话，我们只要把上面的 Alamofire 改为自己的项目名称即可。如果你的发布工具不提供项目支持平台的徽标的话，可以用自定义徽标的方式实现，具体可参考下文自定义徽标一节，这里给出徽标代码：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://img.shields.io/badge/platform-&#123;项目支持平台&#125;-lightgrey.svg</span><br></pre></td></tr></table></figure><p>将 {项目支持平台} 替换为你的项目目前的版本号即可，例如 ios：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">![](https://img.shields.io/badge/platform-ios-lightgrey.svg)</span><br></pre></td></tr></table></figure><p><img src="https://img.shields.io/badge/platform-ios-lightgrey.svg"></p><h2 id="6-项目语言"><a href="#6-项目语言" class="headerlink" title="6. 项目语言"></a>6. 项目语言</h2><p>嗯，这个完全是用自定义徽标实现的，具体可参考下文自定义徽标一节，这里给出徽标代码：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://img.shields.io/badge/language-&#123;项目语言&#125;-&#123;背景色&#125;.svg</span><br></pre></td></tr></table></figure><p>将 {项目语言} 和 {背景色} 替换为你的项目目前的语言和你想要的背景色即可，这里以 Swift 为例，我们用上 Swift 官方橘色：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">![](https://img.shields.io/badge/language-swift-orange.svg)</span><br></pre></td></tr></table></figure><p><img src="https://img.shields.io/badge/language-swift-orange.svg"></p><p>完美!</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-7aaab9c7de41a78c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Swift"></p><h2 id="7-代码分析"><a href="#7-代码分析" class="headerlink" title="7. 代码分析"></a>7. 代码分析</h2><blockquote><p><a href="https://codebeat.co/">Codebeat</a> 可以计算全局项目评分、GPA、和不同命名空间的等级来帮助您量化技术债务和发现重构机会，你唯一需要做的就是连接你的 Github 库，获得反馈就好了。</p></blockquote><p>嗯，上面是官方自述，大概意思就是每次 push 或者 merge 之后会对代码进行分，给出评分，然后告诉你哪些地方复杂度过高需要进行重构之类的。用 GitHub 登陆后绑定项目即可，无需对原有项目进行修改（其实是 codebeat 在你的项目设置里加了一个 Webhook，通知它重新计算评分）。</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-271c429613a8d34e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Webhooks"></p><p>照着引导巴拉巴拉一顿操作之后就可以获取图标啦，在项目的 Setting 中可以获取徽标代码，自己复制出来就可以。</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-080b0705f241d072.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Setting"></p><p>最终效果如下：</p><p><a href="https://codebeat.co/projects/github-com-eyrefree-efqrcode-master"><img src="https://codebeat.co/badges/01f53e9d-542c-4c22-adc7-d1dbff0d2a6f" alt="codebeat badge"></a></p><h2 id="8-开源协议类型"><a href="#8-开源协议类型" class="headerlink" title="8. 开源协议类型"></a>8. 开源协议类型</h2><p>这个的话，因为我的 iOS 库是发布在 CocoaPods 的，我用的是 CocoaPods 提供的，URL 如下：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://img.shields.io/cocoapods/l/&#123;项目名称&#125;.svg?style=flat</span><br></pre></td></tr></table></figure><p>以 Alamofire 为例，Markdown 代码和效果如下：</p><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">![](<span class="link">https://img.shields.io/cocoapods/l/Alamofire.svg?style=flat</span>)</span><br></pre></td></tr></table></figure><p><img src="https://img.shields.io/cocoapods/l/Alamofire.svg?style=flat"></p><p>如果你的库已经发布到 CocoaPods 的话，我们只要把上面的 Alamofire 改为自己的项目名称即可。如果你的发布工具不提供开源协议类型的徽标的话，可以用自定义徽标的方式实现，具体可参考下文自定义徽标一节，这里给出徽标代码：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://img.shields.io/badge/license-&#123;协议名称&#125;-000000.svg</span><br></pre></td></tr></table></figure><p>将 {协议名称} 替换为你的项目所使用的协议名称即可，例如 MIT：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">![](https://img.shields.io/badge/license-MIT-000000.svg)</span><br></pre></td></tr></table></figure><p><img src="https://img.shields.io/badge/license-MIT-000000.svg"></p><h1 id="三-自定义徽标"><a href="#三-自定义徽标" class="headerlink" title="三. 自定义徽标"></a>三. 自定义徽标</h1><h2 id="1-标题／内容／颜色／链接"><a href="#1-标题／内容／颜色／链接" class="headerlink" title="1. 标题／内容／颜色／链接"></a>1. 标题／内容／颜色／链接</h2><p>如果以上这些徽标没有满足你的需求，我们还可以定制自己的个性化徽标，<code>shields.io</code> 提供了添加自定义徽标的功能，通过修改如下 URL 即可获取自定义徽标图片：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://img.shields.io/badge/&#123;徽标标题&#125;-&#123;徽标内容&#125;-&#123;徽标颜色&#125;.svg</span><br></pre></td></tr></table></figure><p>{徽标标题}：徽标左半部分的文本（短线：–，下划线：__，空格： 或_）；  <br>{徽标内容}：徽标右半部分的文本，同上；  <br>{徽标颜色}：徽标右半部分背景颜色，可以是 red、green、blue 等颜色英文单词，也可以直接写十六进制的颜色值，如 ff69b4，示例如下：</p><p><img src="https://img.shields.io/badge/color-brightgreen-brightgreen.svg?maxAge=2592000"><br><img src="https://img.shields.io/badge/color-green-green.svg?maxAge=2592000"><br><img src="https://img.shields.io/badge/color-yellowgreen-yellowgreen.svg?maxAge=2592000"><br><img src="https://img.shields.io/badge/color-yellow-yellow.svg?maxAge=2592000"><br><img src="https://img.shields.io/badge/color-orange-orange.svg?maxAge=2592000"><br><img src="https://img.shields.io/badge/color-red-red.svg?maxAge=2592000"><br><img src="https://img.shields.io/badge/color-lightgrey-lightgrey.svg?maxAge=2592000"><br><img src="https://img.shields.io/badge/color-blue-blue.svg?maxAge=2592000"><br><img src="https://img.shields.io/badge/color-ff69b4-ff69b4.svg?maxAge=2592000"></p><p>将其中的 {徽标标题}、{徽标内容}、{徽标颜色} 分别替换为需要的内容即可，例如我的微博徽标图片地址如下：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://img.shields.io/badge/weibo-@EyreFree-red.svg</span><br></pre></td></tr></table></figure><p>再结合我的微博地址 <a href="http://weibo.com/eyrefree777">http://weibo.com/eyrefree777</a> 后完整徽标代码和效果如下（如果这段代码用在 GitHub 的话，点击该徽标会打开对应的 URL 地址，即直接跳到我的微博）：</p><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">[<span class="string">![</span>](<span class="link">https://img.shields.io/badge/weibo-@EyreFree-red.svg</span>)](<span class="link">http://weibo.com/eyrefree777</span>)</span><br></pre></td></tr></table></figure><p><a href="http://weibo.com/eyrefree777"><img src="https://img.shields.io/badge/weibo-@EyreFree-red.svg"></a></p><p>同理我的推特徽标代码和效果如下：</p><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">[<span class="string">![</span>](<span class="link">https://img.shields.io/badge/twitter-@EyreFree777-blue.svg</span>)](<span class="link">https://twitter.com/EyreFree777</span>)</span><br></pre></td></tr></table></figure><p><a href="https://twitter.com/EyreFree777"><img src="https://img.shields.io/badge/twitter-@EyreFree777-blue.svg"></a></p><h2 id="2-附加参数"><a href="#2-附加参数" class="headerlink" title="2. 附加参数"></a>2. 附加参数</h2><p>可以在徽标图片 URL 后面带上一些参数来控制徽标的样式，这一部分是可选的，不想折腾的话默认的样式就挺好了，可以不看这里的。</p><p>使用方法就是在徽标图片 URL 后面跟上 <code>?&#123;参数名&#125;=&#123;参数值&#125;</code></p><p>多个参数联用的话就是 <code>?&#123;参数名1&#125;=&#123;参数值1&#125;&amp;&#123;参数名2&#125;=&#123;参数值2&#125;...</code></p><h3 id="1-style"><a href="#1-style" class="headerlink" title="1. style"></a>1. style</h3><p>style 控制徽标的主体样式，有四种，不设置的话默认是 <code>flat</code> 的，示例代码和效果如下：</p><h4 id="plastic"><a href="#plastic" class="headerlink" title="plastic"></a>plastic</h4><p>塑料？大概是指立体效果</p><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">![](<span class="link">https://img.shields.io/cocoapods/v/Alamofire.svg?style=plastic</span>)</span><br></pre></td></tr></table></figure><p><img src="https://img.shields.io/cocoapods/v/Alamofire.svg?style=plastic"></p><h4 id="flat"><a href="#flat" class="headerlink" title="flat"></a>flat</h4><p>正常的样子，扁平化</p><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">![](<span class="link">https://img.shields.io/cocoapods/v/Alamofire.svg?style=flat</span>)</span><br></pre></td></tr></table></figure><p><img src="https://img.shields.io/cocoapods/v/Alamofire.svg?style=flat"></p><h4 id="flat-square"><a href="#flat-square" class="headerlink" title="flat-square"></a>flat-square</h4><p>扁平化 + 去除圆角</p><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">![](<span class="link">https://img.shields.io/cocoapods/v/Alamofire.svg?style=flat-square</span>)</span><br></pre></td></tr></table></figure><p><img src="https://img.shields.io/cocoapods/v/Alamofire.svg?style=flat-square"></p><h4 id="social"><a href="#social" class="headerlink" title="social"></a>social</h4><p>社交样式</p><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">![](<span class="link">https://img.shields.io/cocoapods/v/Alamofire.svg?style=social</span>)</span><br></pre></td></tr></table></figure><p><img src="https://img.shields.io/cocoapods/v/Alamofire.svg?style=social"></p><h3 id="2-label"><a href="#2-label" class="headerlink" title="2. label"></a>2. label</h3><p>该参数可以用来强制覆盖原有的徽标标题文字，效果如下，原有的 pod 字样已经被覆盖了：</p><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">![](<span class="link">https://img.shields.io/cocoapods/v/Alamofire.svg?label=healthinesses</span>)</span><br></pre></td></tr></table></figure><p><img src="https://img.shields.io/cocoapods/v/Alamofire.svg?label=healthinesses"></p><h3 id="3-logo"><a href="#3-logo" class="headerlink" title="3. logo"></a>3. logo</h3><p>该参数可以用来为徽标添加 logo，logo 图片会出现在左半部分的徽标标题左边，logo 图片高度必须 ≥ 14px，logo 图片需要先转为 base64 编码然后直接插入到 URL 中（可以用 <a href="http://b64.io/">http://b64.io/</a> 将图片转为 base64 编码的字符串），格式如下。</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?logo=&#123;base64 编码后的图片数据&#125;</span><br></pre></td></tr></table></figure><p>示例代码和效果如下：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">![](https://img.shields.io/badge/gadget-Raspberry%20Pi-pink.svg?logo=data%3Aimage%2Fpng%3Bbase64%2CiVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAACJ0lEQVR4AW2Qy0tUfxjGv3Pm3O%2BXGec3jnMZZ9Rxxp%2BWkYpJ2QkVIzDpkkoGBSOpBZmWgRIkWSs30SJchC26B9aijKLaFET9Be1q46ayRVDU5uk9Q8seeOG8X573eT%2FnZbwQqo5l5Rube52PQdH3BcaY4SbEiy2%2B%2FWFLv7ueblJv0luJmRHBHzqfwuyDRkzfKqB8pRZeQnwzuZynvgHTtwsYvZRBs2%2BVGSU5nfsjX2bocexqDsMLKXgZCQfmkzi6lK0EDJxOfNJdoYORQl5O3OeXY5%2BH59PI5XXUMh3RuIQR6v2J2Ld8h3488FXMBWb2TJkNPw9GUzirF3HX2oZFrQUD0Rqc84rfVcaPs0D%2FcTK%2FQ6y6N6eVsJX3MCglcUzJYVytw6CYxKRSj1Elu0bWCBNCXCnPGz96pTieOTvxyN6OIm%2Fhid2Nx1SzWhGxsLwR4aQ9rFOMPl8lwwQlvXZ78NLZhRbBwZrTjReOjzuENKc1YUTOrLJ%2BKf7%2BsrEJhIL7dhfOaI34n7cxpRWwYnbghFqPMmENyelXzOLE0d1SNbrFGOKcgmDwnduH61Y7zJCAvVINDisZJMPqNEuHVeOQnPr11u3FESWLa2ZbBecp8VNaZXBBb15njHUxmxPC7YK3uGS0YkzNo1VwcZJWtwkeThHKMg33SfEVMqsskBeSjLqwMZYKa18ppXKRwESIv0u8NVPFyRb7hxK0ZYX%2BfIPO95D6KBXH%2FuoPnu%2FBfZ7Zxb0AAAAASUVORK5CYII)</span><br></pre></td></tr></table></figure><p><img src="https://img.shields.io/badge/gadget-Raspberry%20Pi-pink.svg?logo=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAACJ0lEQVR4AW2Qy0tUfxjGv3Pm3O+XGec3jnMZZ9Rxxp+WkYpJ2QkVIzDpkkoGBSOpBZmWgRIkWSs30SJchC26B9aijKLaFET9Be1q46ayRVDU5uk9Q8seeOG8X573eT/nZbwQqo5l5Rube52PQdH3BcaY4SbEiy2+/WFLv7ueblJv0luJmRHBHzqfwuyDRkzfKqB8pRZeQnwzuZynvgHTtwsYvZRBs2+VGSU5nfsjX2bocexqDsMLKXgZCQfmkzi6lK0EDJxOfNJdoYORQl5O3OeXY5+H59PI5XXUMh3RuIQR6v2J2Ld8h3488FXMBWb2TJkNPw9GUzirF3HX2oZFrQUD0Rqc84rfVcaPs0D/cTK/Q6y6N6eVsJX3MCglcUzJYVytw6CYxKRSj1Elu0bWCBNCXCnPGz96pTieOTvxyN6OIm/hid2Nx1SzWhGxsLwR4aQ9rFOMPl8lwwQlvXZ78NLZhRbBwZrTjReOjzuENKc1YUTOrLJ+Kf7+srEJhIL7dhfOaI34n7cxpRWwYnbghFqPMmENyelXzOLE0d1SNbrFGOKcgmDwnduH61Y7zJCAvVINDisZJMPqNEuHVeOQnPr11u3FESWLa2ZbBecp8VNaZXBBb15njHUxmxPC7YK3uGS0YkzNo1VwcZJWtwkeThHKMg33SfEVMqsskBeSjLqwMZYKa18ppXKRwESIv0u8NVPFyRb7hxK0ZYX+fIPO95D6KBXH/uoPnu/BfZ7Zxb0AAAAASUVORK5CYII"></p><h3 id="4-logoWidth"><a href="#4-logoWidth" class="headerlink" title="4. logoWidth"></a>4. logoWidth</h3><p>该参数可以设置在上一个参数 logo 中添加的图标的宽度，设为 0 的话即为忽略该参数，示例代码和效果如下：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">![](https://img.shields.io/badge/gadget-Raspberry%20Pi-pink.svg?logoWidth=100&amp;logo=data%3Aimage%2Fpng%3Bbase64%2CiVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAACJ0lEQVR4AW2Qy0tUfxjGv3Pm3O%2BXGec3jnMZZ9Rxxp%2BWkYpJ2QkVIzDpkkoGBSOpBZmWgRIkWSs30SJchC26B9aijKLaFET9Be1q46ayRVDU5uk9Q8seeOG8X573eT%2FnZbwQqo5l5Rube52PQdH3BcaY4SbEiy2%2B%2FWFLv7ueblJv0luJmRHBHzqfwuyDRkzfKqB8pRZeQnwzuZynvgHTtwsYvZRBs2%2BVGSU5nfsjX2bocexqDsMLKXgZCQfmkzi6lK0EDJxOfNJdoYORQl5O3OeXY5%2BH59PI5XXUMh3RuIQR6v2J2Ld8h3488FXMBWb2TJkNPw9GUzirF3HX2oZFrQUD0Rqc84rfVcaPs0D%2FcTK%2FQ6y6N6eVsJX3MCglcUzJYVytw6CYxKRSj1Elu0bWCBNCXCnPGz96pTieOTvxyN6OIm%2Fhid2Nx1SzWhGxsLwR4aQ9rFOMPl8lwwQlvXZ78NLZhRbBwZrTjReOjzuENKc1YUTOrLJ%2BKf7%2BsrEJhIL7dhfOaI34n7cxpRWwYnbghFqPMmENyelXzOLE0d1SNbrFGOKcgmDwnduH61Y7zJCAvVINDisZJMPqNEuHVeOQnPr11u3FESWLa2ZbBecp8VNaZXBBb15njHUxmxPC7YK3uGS0YkzNo1VwcZJWtwkeThHKMg33SfEVMqsskBeSjLqwMZYKa18ppXKRwESIv0u8NVPFyRb7hxK0ZYX%2BfIPO95D6KBXH%2FuoPnu%2FBfZ7Zxb0AAAAASUVORK5CYII)</span><br></pre></td></tr></table></figure><p><img src="https://img.shields.io/badge/gadget-Raspberry%20Pi-pink.svg?logoWidth=100&logo=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAACJ0lEQVR4AW2Qy0tUfxjGv3Pm3O+XGec3jnMZZ9Rxxp+WkYpJ2QkVIzDpkkoGBSOpBZmWgRIkWSs30SJchC26B9aijKLaFET9Be1q46ayRVDU5uk9Q8seeOG8X573eT/nZbwQqo5l5Rube52PQdH3BcaY4SbEiy2+/WFLv7ueblJv0luJmRHBHzqfwuyDRkzfKqB8pRZeQnwzuZynvgHTtwsYvZRBs2+VGSU5nfsjX2bocexqDsMLKXgZCQfmkzi6lK0EDJxOfNJdoYORQl5O3OeXY5+H59PI5XXUMh3RuIQR6v2J2Ld8h3488FXMBWb2TJkNPw9GUzirF3HX2oZFrQUD0Rqc84rfVcaPs0D/cTK/Q6y6N6eVsJX3MCglcUzJYVytw6CYxKRSj1Elu0bWCBNCXCnPGz96pTieOTvxyN6OIm/hid2Nx1SzWhGxsLwR4aQ9rFOMPl8lwwQlvXZ78NLZhRbBwZrTjReOjzuENKc1YUTOrLJ+Kf7+srEJhIL7dhfOaI34n7cxpRWwYnbghFqPMmENyelXzOLE0d1SNbrFGOKcgmDwnduH61Y7zJCAvVINDisZJMPqNEuHVeOQnPr11u3FESWLa2ZbBecp8VNaZXBBb15njHUxmxPC7YK3uGS0YkzNo1VwcZJWtwkeThHKMg33SfEVMqsskBeSjLqwMZYKa18ppXKRwESIv0u8NVPFyRb7hxK0ZYX+fIPO95D6KBXH/uoPnu/BfZ7Zxb0AAAAASUVORK5CYII"></p><h3 id="5-link"><a href="#5-link" class="headerlink" title="5. link"></a>5. link</h3><p>据说该参数是用来设置 style 为 social 类型点击后跳转的 URL 的（嗯，俗称超链接），并且应该能够设置左右两边为不同的 URL，官方描述如下：</p><ul><li>Specify what clicking on the left&#x2F;right of a badge should do (esp. for social badge style)</li></ul><p>如果把 URL 贴到浏览器中直接访问的确是这样的，比如直接在浏览器中打开下面这个链接，点击左半部分会跳到百度，右半部分则跳到 Google（感谢 <a href="https://github.com/yuzhouwww">@yuzhouwww</a> 同学的提示）：</p><p><a href="https://img.shields.io/badge/weibo-@EyreFree-red.svg?style=social&link=https://www.baidu.com&link=https://www.google.com">https:&#x2F;&#x2F;img.shields.io&#x2F;badge&#x2F;weibo-@EyreFree-red.svg?style=social&link=https://www.baidu.com&link=https://www.google.com</a></p><p>不过如果直接添加在 Markdown 中显示貌似没啥效果？如果有大佬知道的求指点，感谢！</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">![](https://img.shields.io/badge/weibo-@EyreFree-red.svg?style=social&amp;link=https://www.baidu.com&amp;link=https://www.google.com)</span><br></pre></td></tr></table></figure><p><img src="https://img.shields.io/badge/weibo-@EyreFree-red.svg?style=social&link=https://www.baidu.com&link=https://www.google.com"></p><h3 id="6-colorA"><a href="#6-colorA" class="headerlink" title="6. colorA"></a>6. colorA</h3><p>该参数用来控制徽标左半部分的背景色，只能用十六进制的颜色作为参数哦，不能直接写 red、green、blue 之类的，这里将左半部分的背景色改为 0xabcdef，代码和效果如下：</p><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">![](<span class="link">https://img.shields.io/badge/twitter-@EyreFree777-blue.svg?colorA=abcdef</span>)</span><br></pre></td></tr></table></figure><p><img src="https://img.shields.io/badge/twitter-@EyreFree777-blue.svg?colorA=abcdef"></p><h3 id="7-colorB"><a href="#7-colorB" class="headerlink" title="7. colorB"></a>7. colorB</h3><p>该参数用来控制徽标右半部分的背景色，同上，只能用十六进制的颜色作为参数哦，不能直接写 red、green、blue 之类的，这里将右半部分的背景色改为 0xabcdef，代码和效果如下：</p><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">![](<span class="link">https://img.shields.io/badge/twitter-@EyreFree777-blue.svg?colorB=abcdef</span>)</span><br></pre></td></tr></table></figure><p><img src="https://img.shields.io/badge/twitter-@EyreFree777-blue.svg?colorB=abcdef"></p><h3 id="8-maxAge"><a href="#8-maxAge" class="headerlink" title="8. maxAge"></a>8. maxAge</h3><p>该参数用来设置 HTTP 缓存时间，以秒为单位，直接在 svg 地址后跟 <code>?maxAge=&#123;缓存秒数&#125;</code> 即可，好像没啥好预览的，不放效果图了。</p><h3 id="备注"><a href="#备注" class="headerlink" title="备注"></a>备注</h3><p>这里需要注意的是，如果你是引用的第三方 svg 然后添加自己的样式，如果该样式之前已经被第三方添加过，是不一定会覆盖第三方的设置的，也就是说自己设置的属性不一定会生效…例如下面的代码设置 colorB 就没生效：</p><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">![](<span class="link">https://img.shields.io/cocoapods/v/Alamofire.svg?colorB=000000</span>)</span><br></pre></td></tr></table></figure><p>右半部分应该变成黑色，但是毫无效果的说：</p><p><img src="https://img.shields.io/cocoapods/v/Alamofire.svg?colorB=000000"></p><h1 id="四-其他"><a href="#四-其他" class="headerlink" title="四. 其他"></a>四. 其他</h1><p>默认的徽标是居左排列的，如果需要居中排列需要使用 HTML 的方式来插入徽标，可参考 <a href="https://github.com/onevcat/Kingfisher">Kingfisher</a>，代码和效果如下：</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">align</span>=<span class="string">&quot;center&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;https://travis-ci.org/onevcat/Kingfisher&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://img.shields.io/travis/onevcat/Kingfisher/master.svg&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;https://github.com/Carthage/Carthage/&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://img.shields.io/badge/Carthage-compatible-4BC51D.svg?style=flat&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;https://swift.org/package-manager/&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://img.shields.io/badge/SPM-ready-orange.svg&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;http://onevcat.github.io/Kingfisher/&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://img.shields.io/cocoapods/v/Kingfisher.svg?style=flat&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;https://raw.githubusercontent.com/onevcat/Kingfisher/master/LICENSE&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://img.shields.io/cocoapods/l/Kingfisher.svg?style=flat&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;http://onevcat.github.io/Kingfisher/&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://img.shields.io/cocoapods/p/Kingfisher.svg?style=flat&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;https://codebeat.co/projects/github-com-onevcat-kingfisher&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">alt</span>=<span class="string">&quot;codebeat badge&quot;</span> <span class="attr">src</span>=<span class="string">&quot;https://codebeat.co/assets/svg/badges/A-398b39-669406e9e1b136187b91af587d4092b0160370f271f66a651f444b990c2730e9.svg&quot;</span> /&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><p align="center"><a href="https://travis-ci.org/onevcat/Kingfisher"><img src="https://img.shields.io/travis/onevcat/Kingfisher/master.svg"></a><a href="https://github.com/Carthage/Carthage/"><img src="https://img.shields.io/badge/Carthage-compatible-4BC51D.svg?style=flat"></a><a href="https://swift.org/package-manager/"><img src="https://img.shields.io/badge/SPM-ready-orange.svg"></a><a href="http://onevcat.github.io/Kingfisher/"><img src="https://img.shields.io/cocoapods/v/Kingfisher.svg?style=flat"></a><a href="https://raw.githubusercontent.com/onevcat/Kingfisher/master/LICENSE"><img src="https://img.shields.io/cocoapods/l/Kingfisher.svg?style=flat"></a><a href="http://onevcat.github.io/Kingfisher/"><img src="https://img.shields.io/cocoapods/p/Kingfisher.svg?style=flat"></a><a href="https://codebeat.co/projects/github-com-onevcat-kingfisher"><img alt="codebeat badge" src="https://codebeat.co/assets/svg/badges/A-398b39-669406e9e1b136187b91af587d4092b0160370f271f66a651f444b990c2730e9.svg" /></a></p><p>没了，🙄</p><hr><blockquote><p>如有任何知识产权、版权问题或理论错误，还请指正。<br><a href="https://www.eyrefree.org/2017/05/01/GitHub-Badge-Introduction">https://www.eyrefree.org/2017/05/01/GitHub-Badge-Introduction</a><br>如文中无特殊说明，本站均使用以下协议保护：<a href="http://creativecommons.org/licenses/by-nc-nd/3.0/cn/">署名-非商业性使用-禁止演绎</a>。   </p></blockquote>]]></content>
      
      
      <categories>
          
          <category> GitHub </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Badge </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iOS 在 App 中使用自定义字体</title>
      <link href="/2017/03/23/UIFont-TTF/"/>
      <url>/2017/03/23/UIFont-TTF/</url>
      
        <content type="html"><![CDATA[<p>最近在做一个神奇的 App 需要添加楷体，检查了一下发现 iOS 默认并不会安装这种字体，需要我们自己将字体文件添加到 App 中，本文主要记录了添加自定义字体的过程、添加完成后的效果以及遇到的一些坑，文中 iOS 代码主要为 Swift 3。</p><hr><h1 id="1-查看全部可用字体"><a href="#1-查看全部可用字体" class="headerlink" title="1. 查看全部可用字体"></a>1. 查看全部可用字体</h1><p>在进行操作之前，我们先查看默认情况下，系统的可用字体有哪些，利用如下代码可以将系统全部字体的 FontFamilyName 以及它们的 FontName 进行打印：</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> fontFamily <span class="keyword">in</span> <span class="type">UIFont</span>.familyNames &#123;</span><br><span class="line">    <span class="built_in">print</span>(fontFamily)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> font <span class="keyword">in</span> <span class="type">UIFont</span>.fontNames(forFamilyName: fontFamily) &#123;</span><br><span class="line">        <span class="built_in">print</span>(fontFamily <span class="operator">+</span> <span class="string">&quot;: &quot;</span> <span class="operator">+</span> font)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>我们可以在日志输出窗口搜索我们需要的楷体，可以看到默认并没有安装，效果如图所示：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-7350c33cc8513393.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="查看全部可用字体"></p><h1 id="2-获取字体文件"><a href="#2-获取字体文件" class="headerlink" title="2. 获取字体文件"></a>2. 获取字体文件</h1><p>首先，我们需要获取字体文件，一般文件类型为 ttf 或 ttc 的就是字体文件了，如图所示：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-8128dda0b2489f39.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="字体文件"></p><p>可以在 <a href="http://www.zitikoudai.com/">字体口袋</a>，<a href="http://www.sozi.cn/">搜字网</a> 之类的网站找到很多可供下载的资源：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-510dc0d1628c7b4e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="字体口袋"></p><p>或者也可以在 OS X 的系统字体册找到我们想要的字体，可以从应用程序列表中打开字体册：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-ec156aacb9194153.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="字体册"></p><p>选择 <code>所有字体</code> 然后在搜索栏内键入需要查找的字体名即可列出匹配的项目：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-29901f9b4632925f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="在字体册中查找字体"></p><p>右键点击想要的字体选择 <code>在 Finder 中显示</code> 即可找到对应的字体文件。</p><h1 id="3-添加字体文件到工程"><a href="#3-添加字体文件到工程" class="headerlink" title="3. 添加字体文件到工程"></a>3. 添加字体文件到工程</h1><p>将我们获取的字体文件直接拖到工程中的合适位置，如图所示：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-2aad3e8abae38ee9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="添加字体文件"></p><p>添加完成后选中对应的字体文件可进行预览：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-5f5b457a8bdda98b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="预览"></p><p>我们还需要在 <code>Info.plist</code> 文件中添加 Fonts provided by application 项，如图所示：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-be03386c8a892c1f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Info.plist 添加 Fonts provided by application 项"></p><p>也可通过直接添加代码的方式完成，例如这里添加两个字体文件 STKaiti.ttf 和 Kaiti-SC.ttf 的代码如下：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;key&gt;UIAppFonts&lt;/key&gt;</span><br><span class="line">&lt;array&gt;</span><br><span class="line">    &lt;string&gt;STKaiti.ttf&lt;/string&gt;</span><br><span class="line">    &lt;string&gt;Kaiti-SC.ttf&lt;/string&gt;</span><br><span class="line">&lt;/array&gt;</span><br></pre></td></tr></table></figure><p>这时，我们对工程进行编译，再次查看可用的全部字体，这时我们可以看到，我们需要的楷体已经添加了进来：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-35090eacafa8f523.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="成功添加楷体"></p><h1 id="4-字体的使用"><a href="#4-字体的使用" class="headerlink" title="4. 字体的使用"></a>4. 字体的使用</h1><h2 id="1-StoryBoard"><a href="#1-StoryBoard" class="headerlink" title="1. StoryBoard"></a>1. StoryBoard</h2><p>在 StoryBoard 中使用的话，只需要设置控件的 Font 属性为，选择 Custom，然后再从 Family 中选择需要的字体即可。</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-ae1d2f52ed178db2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="在 StoryBoard 中使用"></p><h2 id="2-代码"><a href="#2-代码" class="headerlink" title="2. 代码"></a>2. 代码</h2><p>我们直接通过如下代码直接生成一个楷体的字体对象，将其赋给 UIButton 或者 UILabel 等空间对应的属性即可。</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="type">UIFont</span>(name: <span class="string">&quot;STKaiti&quot;</span>, size: <span class="number">20</span>)</span><br></pre></td></tr></table></figure><p>这里需要注意的是 UIFont 的 name 字符串必须是上面我们打印出的字体名称，和字体文件的文件名或者其他信息无关。如果这里我们输入了一个无效的字体名称，可能会返回一个空的对象，所以我的使用方式如下：</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">UIFont</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">func</span> <span class="title function_">boldKaiti</span>(<span class="params">ofSize</span> <span class="params">fontSize</span>: <span class="type">CGFloat</span>) -&gt; <span class="type">UIFont</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">UIFont</span>(name: <span class="string">&quot;Kaiti SC Black&quot;</span>, size: fontSize) <span class="operator">??</span> <span class="type">UIFont</span>.systemFont(ofSize: fontSize)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">func</span> <span class="title function_">kaiti</span>(<span class="params">ofSize</span> <span class="params">fontSize</span>: <span class="type">CGFloat</span>) -&gt; <span class="type">UIFont</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">UIFont</span>(name: <span class="string">&quot;Kaiti SC&quot;</span>, size: fontSize) <span class="operator">??</span> <span class="type">UIFont</span>.systemFont(ofSize: fontSize)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>使用楷体前后效果对比，可以看到换个字体以后感觉整个 feel 就不一样了，可见我们要好好听设计师蜀黍们的话，该用啥字体用啥字体，不能偷懒，😂 （嘛，控件位置还没调整，第二段可能有点放不下了）：</p><table><thead><tr><th align="center">添加字体前</th><th align="center">添加字体后</th></tr></thead><tbody><tr><td align="center"><img src="http://upload-images.jianshu.io/upload_images/1018190-af181721cca8c174.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></td><td align="center"><img src="http://upload-images.jianshu.io/upload_images/1018190-e089745639153fd7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></td></tr></tbody></table><h1 id="5-一些坑"><a href="#5-一些坑" class="headerlink" title="5. 一些坑"></a>5. 一些坑</h1><h4 id="1-字体文件过大"><a href="#1-字体文件过大" class="headerlink" title="1. 字体文件过大"></a>1. 字体文件过大</h4><p>如果你用的字体文件是 TTC 格式的，可以考虑去下载单独的 TTF 字体文件，TTC 是几个 TTF 合成的字库，里面包含不止一种字体类型。</p><p>然后多个类似的字体，可以和设计师商量一下统一使用同一种字体。</p><p>唔，如果是单个 TTF 文件过大的话，暂时木有找到好的解决办法，可以考虑多下几个不同来源的同种字体的文件，挑一个体积最小的。或者对现有的 TTF 文件进行编辑，将一些低频字符进行删除。</p><h4 id="2-字体重名问题"><a href="#2-字体重名问题" class="headerlink" title="2. 字体重名问题"></a>2. 字体重名问题</h4><p>在导入同一种字体的不同风格时，比如这里楷体的粗体 <code>Kaiti-SC-Black</code> 和普通体 <code>Kaiti-SC-Regular</code> ，在 App 中打印出的 FontName 居然只有一个楷体的，这是为啥呢，推测可能是字体文件生成的时候填写字体名偷工减料，没有填写完整的字体名或者字体名识别异常导致的。</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-cd76f9fd80856fbf.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="只有一个楷体"></p><p>然后我找了一个 OS X 下可用的免费字体编辑工具 BirdFont 对字体文件进行查看想一探究竟，官网地址 <a href="https://birdfont.org/">https://birdfont.org/</a>，我用的是 <a href="http://eyrefree.coding.me/FileKeeper/birdfont-2.15.5-free.dmg">2.15.5</a> 版本，大家可以自行去官网下载最新版。</p><p>在 Finder 中打开我们的字体文件，右键选择用 BirdFont 进行打开即可，因为字体文件数据量较大，打开过程可能会有些长，需要耐心等待几分钟，具体时长根据数据量而定，等软件右上角的 Loading 消失即表示打开完成。</p><p>点击右上角菜单，选择 Name and Description 选项可打开字体描述信息编辑页面：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-f0a8629b4d2b6382.png" alt="Name and Description"></p><p>在这里我们可以看到，Kaiti-SC-Black 和 Kaiti-SC-Regular 两个字体文件的 <code>Name</code> 一栏确实是只写了 Kaiti SC，和我们之前在 App 中输出的字体名称一致，<code>Style</code> 一栏虽然有所区别，但是我们在 App 中是无法通过 <code>Style</code> 这个参数来找到某个字体的（反正我没找到，如果真的有办法希望可以教我，蟹蟹，😂 ），所以这应该就是我们只能在 App 中找到一个楷体的原因了。</p><table><thead><tr><th align="center">BirdFont Kaiti-SC-Black</th><th align="center">BirdFont Kaiti-SC-Regular</th><th align="center">App</th></tr></thead><tbody><tr><td align="center"><img src="http://upload-images.jianshu.io/upload_images/1018190-36d14efc746d886a.png"></td><td align="center"><img src="http://upload-images.jianshu.io/upload_images/1018190-c828d1f366a82258.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></td><td align="center"><img src="http://upload-images.jianshu.io/upload_images/1018190-4b11a9f1122e702b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></td></tr></tbody></table><p>然后我们对其中一个字体的 <code>Name</code> 做一下修改，反正使俩字体文件的 Name 不一样就行，然后我这里将 Kaiti-SC-Black 的 <code>Name</code> 改为 Kaiti SC Black，改完之后需要先 Save，然后选择 Import and Export：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-c27be693b5abdae5.png" alt="Import and Export"></p><p>然后再选择 Export Fonts：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-0d4f161f80baa28a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Export Fonts"></p><p>然后会弹出 Export Settings 页面进行一些参数设置，注意将 Formats 中的 TTF 选项勾选即可，其他的两个选项可以去掉，加快导出速度。</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-2a2a4271cfbc9133.png" alt="Export Settings"></p><p>然后单击下面的 Export 按钮即可开始导出工作，右上角会出现一个 Loading 视图，等它消失就表示导出完成了，导出完成后会在 Finder 中打开对应字体文件。</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-06962a1c5acf94a3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="导出完成"></p><p>我们将其添加到工程中再看下能不能找到它：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-96d28c83f011ed0c.png" alt="新增 Kaiti SC Black 字体"></p><p>可以看到这一次多了一个名为 Kaiti SC Black 的字体，完成！</p><p>PS：</p><p>最后吐槽一下，BirdFont 这工具真的好慢，巨慢，慢到爆炸，🙄 。大家在操作过过程中尽量挑体积小一点的字体文件进行操作。不过还好，使用过程中还没遇到闪退之类的状况，功能上没问题。希望后续版本能够提高处理速度。</p><hr><blockquote><p>如有任何知识产权、版权问题或理论错误，还请指正。<br><a href="https://www.eyrefree.org/2017/03/23/UIFont-TTF">https://www.eyrefree.org/2017/03/23/UIFont-TTF</a><br>如文中无特殊说明，本站均使用以下协议保护：<a href="http://creativecommons.org/licenses/by-nc-nd/3.0/cn/">署名-非商业性使用-禁止演绎</a>。   </p></blockquote>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> TTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>利用 Travis-CI 让你在 GitHub 上的 CocoaPods 库持续构建</title>
      <link href="/2017/03/16/Travis-CI/"/>
      <url>/2017/03/16/Travis-CI/</url>
      
        <content type="html"><![CDATA[<p>Travis-CI 是一个专门为开源项目打造的持续集成环境，目前已经支持绝大部分主流语言，它采用 yaml 格式，简洁清新独树一帜（感谢百度百科，2333）。</p><p>每次 Commit 后会执行构建操作，并在 GitHub 对应的 Commit 后显示构建状态或结果，如图所示：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-87b43c1d2d1e9c1c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="持续构建效果预览"></p><p>本文以 <a href="https://github.com/EyreFree/EFQRCode">EFQRCode</a>(一个使用 Swift 作为开发语言的 CocoaPods 开源库) 为例，简述怎样为自己的开源项目添加持续构建功能。</p><h1 id="1-指定-Swift-版本"><a href="#1-指定-Swift-版本" class="headerlink" title="1. 指定 Swift 版本"></a>1. 指定 Swift 版本</h1><p>在根目录下添加一个 .swift-version 文件，在其中填写 Swift 版本号，例如这里 EFQRCode 库使用 Swift 3.0 进行开发，所以这里填写的是：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">3.0</span><br></pre></td></tr></table></figure><h1 id="2-添加-Travis-CI-配置文件"><a href="#2-添加-Travis-CI-配置文件" class="headerlink" title="2. 添加 Travis-CI 配置文件"></a>2. 添加 Travis-CI 配置文件</h1><p>在根目录下添加一个 .travis.yml 文件，在其中填写配置信息：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">osx_image: xcode8</span><br><span class="line">language: objective-c</span><br><span class="line"></span><br><span class="line">cache: cocoapods</span><br><span class="line">podfile: Example/Podfile</span><br><span class="line"></span><br><span class="line">env:</span><br><span class="line">  global:</span><br><span class="line">    - LANG=en_US.UTF-8</span><br><span class="line">    - LC_ALL=en_US.UTF-8</span><br><span class="line">    - XCODE_WORKSPACE=Example/EFQRCode.xcworkspace</span><br><span class="line">  matrix:</span><br><span class="line">    - SCHEME=&quot;EFQRCode-Example&quot;</span><br><span class="line"></span><br><span class="line">before_install:</span><br><span class="line">  - gem install xcpretty --no-rdoc --no-ri --no-document --quiet</span><br><span class="line">  - gem install cocoapods --pre --no-rdoc --no-ri --no-document --quiet</span><br><span class="line">  - pod install --project-directory=Example</span><br><span class="line"></span><br><span class="line">script:</span><br><span class="line">  - set -o pipefail</span><br><span class="line">  - xcodebuild -workspace &quot;$XCODE_WORKSPACE&quot; -scheme &quot;$SCHEME&quot; -configuration Debug clean build CODE_SIGN_IDENTITY=&quot;&quot; CODE_SIGNING_REQUIRED=NO | xcpretty -c</span><br><span class="line">  - xcodebuild -workspace &quot;$XCODE_WORKSPACE&quot; -scheme &quot;$SCHEME&quot; -configuration Release clean build CODE_SIGN_IDENTITY=&quot;&quot; CODE_SIGNING_REQUIRED=NO | xcpretty -c</span><br><span class="line">  - pod lib lint --no-clean</span><br><span class="line"></span><br><span class="line">after_success:</span><br><span class="line">  - sleep 5</span><br></pre></td></tr></table></figure><h1 id="3-注册-Travis-CI-账号"><a href="#3-注册-Travis-CI-账号" class="headerlink" title="3. 注册 Travis-CI 账号"></a>3. 注册 Travis-CI 账号</h1><p>打开 <a href="https://travis-ci.org/">https://travis-ci.org/</a> 注册一个 Travis-CI 账号，也可以通过 GitHub 账户直接登陆。Travis-CI 服务对开源项目是免费的，所以你的私有项目无法享受到免费的持续构建服务。</p><h1 id="4-从-GitHub-同步项目"><a href="#4-从-GitHub-同步项目" class="headerlink" title="4. 从 GitHub 同步项目"></a>4. 从 GitHub 同步项目</h1><p>第一次进入时会自动从 GitHub 同步项目数据，可能需要等待一段的时间进行同步，同步完成后可以看到如下的项目列表：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-d01facdae4cb29f5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="项目列表"></p><p>一般情况下每隔一定的时间 Travis-CI 都会从 GitHub 自动同步数据，如果新添加的项目想要立刻同步到 Travis-CI 的话，可以手动点击右上角的 Sync account 同步按钮，如图所示：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-d14d4450f3790330.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="同步按钮"></p><h1 id="5-开启持续集成"><a href="#5-开启持续集成" class="headerlink" title="5. 开启持续集成"></a>5. 开启持续集成</h1><p>然后接下来就是开启对应项目的持续构建，大家应该已经猜到该怎么做了吧…将对应项目之前的 Switch 按钮设为启用绿色勾选状态即可，如图所示：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-2085dfac1d55e776.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="勾选状态"></p><h1 id="6-观察错误日志"><a href="#6-观察错误日志" class="headerlink" title="6. 观察错误日志"></a>6. 观察错误日志</h1><p>若发生构建失败，可通过查看错误日志的方式来定位具体问题原因，可点击工程名，选择出错的那一次构建即可：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-a483be7d32c674bb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="构建日志"></p><h1 id="7-一些废话"><a href="#7-一些废话" class="headerlink" title="7. 一些废话"></a>7. 一些废话</h1><p>本文只提供了针对 Swift CocoaPods 库的操作步骤，Travis-CI 具体到每种语言／项目的构建配置各不相同，参数各异，有的时候还需要根据自己的项目特性做一些个性化的调整，需要我们多思考，多调试，多尝试，总之不要轻易放弃哇。别问我是怎么知道的，😂 ：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-7cbf867d9314dbbc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="坑"></p><hr><blockquote><p>如有任何知识产权、版权问题或理论错误，还请指正。<br><a href="https://www.eyrefree.org/2017/03/16/Travis-CI">https://www.eyrefree.org/2017/03/16/Travis-CI</a><br>如文中无特殊说明，本站均使用以下协议保护：<a href="http://creativecommons.org/licenses/by-nc-nd/3.0/cn/">署名-非商业性使用-禁止演绎</a>。   </p></blockquote>]]></content>
      
      
      <categories>
          
          <category> GitHub </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Travis-CI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iOS 利用 NEHotspotHelper 获取 WiFi 列表</title>
      <link href="/2017/03/09/NEHotspotHelper/"/>
      <url>/2017/03/09/NEHotspotHelper/</url>
      
        <content type="html"><![CDATA[<p>iOS 9 发布之后，苹果推出了 NetworkExtension，利用这个框架可以实现很多和网络相关的操作。本文主要介绍怎样使用其中的 NEHotspotHelper 进行设备 WiFi 列表的获取。</p><p>Demo 地址：<a href="https://github.com/EyreFree/EFNEHotspotHelperDemo">https://github.com/EyreFree/EFNEHotspotHelperDemo</a></p><h1 id="一-注意事项"><a href="#一-注意事项" class="headerlink" title="一. 注意事项"></a>一. 注意事项</h1><ol><li>首先，NEHotspotHelper 只在 iOS 9 及以上版本得到支持，之前版本的 iOS 并不支持该功能；</li><li>然后，你需要有一个开发者账号；</li><li>最后，该框架目前还没有大规模开放使用，所以需要向苹果发送申请并且审核通过才能够获得使用该框架的权限，大致内容就是描述一下你需要使用该框架的原因之类的，然后我是用的英文进行描述（感谢百度以及谷歌翻译），不过据说中文也行。提交申请后大概一周内会收到反馈邮件，申请地址为： <a href="https://developer.apple.com/contact/network-extension/">https://developer.apple.com/contact/network-extension/</a> 。</li></ol><h1 id="二-创建-App-ID"><a href="#二-创建-App-ID" class="headerlink" title="二. 创建 App ID"></a>二. 创建 App ID</h1><p>打开苹果开发者中心，登陆然后找到 App IDs 选项，点击右上角按钮创建一个 App ID 用于接下来创建 Provisioning Profile，地址为： <a href="https://developer.apple.com/account/ios/identifier/bundle/">https://developer.apple.com/account/ios/identifier/bundle/</a>  ，如图所示：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-f447bfbbb6095d33.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="创建 App ID"></p><p>首先，填写 Name 以及 Bundle ID，这里统一填写为 EFNEHotspotHelperDemo，如图所示：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-1fda13b55d6683a6.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="填写 Name"></p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-a51c01c1bb8e0ef9.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="填写 Bundle ID"></p><p>接下来这一步注意需要勾选 Wireless Accessory Configuration 这一选项，如图所示：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-5acb269c05aacea5.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="勾选 Wireless Accessory Configuration"></p><p>然后观察到如图所示状态表明已成功打开：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-73d2e00e40181d9b.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="状态显示"></p><p>在 App IDs 列表中查看刚创建完成的 App ID：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-2d0024f561ed17ab.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="App IDs 列表"></p><h1 id="三-创建-Provisioning-Profile"><a href="#三-创建-Provisioning-Profile" class="headerlink" title="三. 创建 Provisioning Profile"></a>三. 创建 Provisioning Profile</h1><p>找到 Provisioning Profiles 选项，点击右上角按钮创建一个 Provisioning Profile 用于接下来创建示例工程，地址为： <a href="https://developer.apple.com/account/ios/profile/">https://developer.apple.com/account/ios/profile/</a>  ，如图所示：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-911e7761ba3c44e3.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="创建 Provisioning Profile"></p><p>首先选择 Profile 类型，这里我选择的是 iOS App Development，可以根据自己的具体需要自由选择：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-d5061ad530a3f724.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="选择 Profile 类型"></p><p>接下来选择我们在第二步创建好的 App ID，如图所示：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-4e017ec4c1c09402.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="选择 App ID"></p><p>然后选择证书和设备，全选即可：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-9c675e9238d1da11.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="选择证书"></p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-58a130484fdfed6c.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="选择设备"></p><p>在额外权限这一步需要选中我们申请到的 Network Extension 权限，可以看到其中包含我们需要使用的 NEHotspotHelper 权限，如图所示：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-a6abfce07b76a017.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="选中 Network Extension 权限"></p><p>填写完 Profile Name 之后，即可成功创建我们需要的 Profile：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-2f602ebf05102c28.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="填写 Profile Name"></p><p>点击 Download 将它下载到本地：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-1bf8b38560227b93.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="下载 Profile"></p><p>双击打开，即可将 Profile 添加到本机：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-42e294701187033a.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="添加 Profile"></p><p>可以到 XCode 的账户设置里查看已安装的 Profile，若未安装成功可以尝试点击 Action 中的 Download 按钮重新下载：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-99fff3c8f41706d3.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="查看已安装的 Profile"></p><h1 id="四-创建工程"><a href="#四-创建工程" class="headerlink" title="四. 创建工程"></a>四. 创建工程</h1><p>接下来我们创建一个示例工程，演示如何获取 WiFi 列表。首先，将 Bundle ID 改为之前设置的 EFNEHotspotHelperDemo：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-a39aced31600687a.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="修改 Bundle ID"></p><p>然后在 Info.plist 中添加后台模式权限数组：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-1870d94c708379d7.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="添加后台模式代码"></p><p>代码如下：</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">key</span>&gt;</span>UIBackgroundModes<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">string</span>&gt;</span>network-authentication<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br></pre></td></tr></table></figure><p>添加完成后可以在 Target -&gt; Capabilities 中看到后台模式已处于开启状态：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-99c24463ac8fa56f.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="后台模式已开启"></p><p>接下来在 Capabilities 找到 Wireless Accessory Configuration 并将其打开：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-8eb012d9732a3197.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="打开 Wireless Accessory Configuration"></p><p> 在工程中找到后缀为 {工程名}.entitlements 的文件 EFNEHotspotHelperDemo.entitlements，在其中加入 HotspotHelper 权限代码：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-065ba9d93185a539.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="添加 HotspotHelper 权限代码"></p><p>代码如下：</p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">key</span>&gt;</span>com.apple.developer.networking.HotspotHelper<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">true</span>/&gt;</span></span><br></pre></td></tr></table></figure><p>好了，到这里已经完成了各种乱七八糟的配置工作，可以尝试进行 Build。如果没有提示错误信息的话，接下来就可以愉快地使用 HotspotHelper 了；如果有问题的话，请检查之前的步骤是否都已正确完成或者根据错误信息修改具体项目。</p><h1 id="五-核心代码"><a href="#五-核心代码" class="headerlink" title="五. 核心代码"></a>五. 核心代码</h1><p>首先，在需要使用 HotspotHelper 的地方添加头文件引用，这里以 Objective-C 代码为例：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#import &lt;NetworkExtension/NetworkExtension.h&gt;</span><br></pre></td></tr></table></figure><p>然后使用如下代码即可将 WiFi 列表信息打印到 XCode 控制台，注意：这里需要打开系统 <code>设置</code> 中的 <code>无线局域网</code> 页面才可以触发回调：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">- (void)scanWifiInfos&#123;</span><br><span class="line">    NSLog(@&quot;1.Start&quot;);</span><br><span class="line"></span><br><span class="line">    NSMutableDictionary* options = [[NSMutableDictionary alloc] init];</span><br><span class="line">    [options setObject:@&quot;EFNEHotspotHelperDemo&quot; forKey: kNEHotspotHelperOptionDisplayName];</span><br><span class="line">    dispatch_queue_t queue = dispatch_queue_create(&quot;EFNEHotspotHelperDemo&quot;, NULL);</span><br><span class="line"></span><br><span class="line">    NSLog(@&quot;2.Try&quot;);</span><br><span class="line">    BOOL returnType = [NEHotspotHelper registerWithOptions: options queue: queue handler: ^(NEHotspotHelperCommand * cmd) &#123;</span><br><span class="line"></span><br><span class="line">        NSLog(@&quot;4.Finish&quot;);</span><br><span class="line">        NEHotspotNetwork* network;</span><br><span class="line">        if (cmd.commandType == kNEHotspotHelperCommandTypeEvaluate || cmd.commandType == kNEHotspotHelperCommandTypeFilterScanList) &#123;</span><br><span class="line">            // 遍历 WiFi 列表，打印基本信息</span><br><span class="line">            for (network in cmd.networkList) &#123;</span><br><span class="line">                NSString* wifiInfoString = [[NSString alloc] initWithFormat: @&quot;---------------------------\nSSID: %@\nMac地址: %@\n信号强度: %f\nCommandType:%ld\n---------------------------\n\n&quot;, network.SSID, network.BSSID, network.signalStrength, (long)cmd.commandType];</span><br><span class="line">                NSLog(@&quot;%@&quot;, wifiInfoString);</span><br><span class="line"></span><br><span class="line">                // 检测到指定 WiFi 可设定密码直接连接</span><br><span class="line">                if ([network.SSID isEqualToString: @&quot;测试 WiFi&quot;]) &#123;</span><br><span class="line">                    [network setConfidence: kNEHotspotHelperConfidenceHigh];</span><br><span class="line">                    [network setPassword: @&quot;123456789&quot;];</span><br><span class="line">                    NEHotspotHelperResponse *response = [cmd createResponse: kNEHotspotHelperResultSuccess];</span><br><span class="line">                    NSLog(@&quot;Response CMD: %@&quot;, response);</span><br><span class="line">                    [response setNetworkList: @[network]];</span><br><span class="line">                    [response setNetwork: network];</span><br><span class="line">                    [response deliver];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;];</span><br><span class="line"></span><br><span class="line">    // 注册成功 returnType 会返回一个 Yes 值，否则 No</span><br><span class="line">    NSLog(@&quot;3.Result: %@&quot;, returnType == YES ? @&quot;Yes&quot; : @&quot;No&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="六-演示"><a href="#六-演示" class="headerlink" title="六. 演示"></a>六. 演示</h1><p>唔，Demo 运行效果如下，点击 <code>Open WiFi Setting</code> 按钮可直接打开 <code>无线局域网</code> 页面：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-761d24d00368fc0d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="运行效果"></p><p>具体可尝试下载 Demo 并完成相应配置后体验：<a href="https://github.com/EyreFree/EFNEHotspotHelperDemo">https://github.com/EyreFree/EFNEHotspotHelperDemo</a></p><h1 id="七-备注"><a href="#七-备注" class="headerlink" title="七. 备注"></a>七. 备注</h1><p>参考以下资料完成本 Demo，在此表示感谢：</p><p><a href="http://blog.csdn.net/i374711088/article/details/51655526">IOS NetworkExtension 框架使用笔记</a><br><a href="http://blog.csdn.net/toto18369905359/article/details/52622115">iOS NEHotspotHelper使用</a><br><a href="https://github.com/42vio/iOS-NetworkExtension-NEHotspotHelper">iOS-NetworkExtension-NEHotspotHelper</a><br><a href="https://developer.apple.com/reference/networkextension">API Reference - NetworkExtension</a></p><hr><blockquote><p>如有任何知识产权、版权问题或理论错误，还请指正。<br><a href="https://www.eyrefree.org/2017/03/09/NEHotspotHelper">https://www.eyrefree.org/2017/03/09/NEHotspotHelper</a><br>如文中无特殊说明，本站均使用以下协议保护：<a href="http://creativecommons.org/licenses/by-nc-nd/3.0/cn/">署名-非商业性使用-禁止演绎</a>。   </p></blockquote>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> NEHotspotHelper </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>十分钟开发一款 iOS 表情包 App</title>
      <link href="/2016/11/24/Coding-Emoji/"/>
      <url>/2016/11/24/Coding-Emoji/</url>
      
        <content type="html"><![CDATA[<p>在最近更新的 iOS 10 系统中，苹果开放了 iMessage Stickers 的开发，通俗的说法就是我们现在可以为 iMessage 开发表情包了。<br>表情包的开发十分简单，不需要写一行代码，只需要准备好图片资源即可。本文主要以 Coding 的<a href="https://coding.net/u/coding/p/Onion-Monkey-Emoji/git">洋葱猴系列表情</a>为例快速开发一款表情包 App。</p><p>本文所需所有素材以及工程文件地址：  <br><a href="https://github.com/EyreFree/CodingEmoji">https://github.com/EyreFree/CodingEmoji</a></p><hr><h1 id="一-注意事项"><a href="#一-注意事项" class="headerlink" title="一.注意事项"></a>一.注意事项</h1><p>开发环境：XCode 8.0 及以上；<br>运行环境：iOS 10 及以上；<br>其他：表情包图片的格式可以是 JPG, PNG, GIF 等，不过单张图片最大不能超过 500KB。</p><h1 id="二-准备图片"><a href="#二-准备图片" class="headerlink" title="二.准备图片"></a>二.准备图片</h1><p>下载洋葱猴表情包，找到其中的表情图片。<br>（下载地址：<a href="https://coding.net/u/coding/p/Onion-Monkey-Emoji/git%EF%BC%89">https://coding.net/u/coding/p/Onion-Monkey-Emoji/git）</a></p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-5bcefc958791bbeb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="洋葱猴表情包"></p><h1 id="三-建立工程"><a href="#三-建立工程" class="headerlink" title="三.建立工程"></a>三.建立工程</h1><h2 id="1-新建工程"><a href="#1-新建工程" class="headerlink" title="1.新建工程"></a>1.新建工程</h2><p>打开 XCode，新建 Sticker Pack Application 工程，如图所示：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-0b7408065e8b9efa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="新建 Sticker Pack Application 工程"></p><h2 id="2-添加图标"><a href="#2-添加图标" class="headerlink" title="2.添加图标"></a>2.添加图标</h2><p>Sticker Pack Application 的图标和一般的 iOS 应用不太一样，它部分图标是扁的，详细尺寸如下（最后一个为 App Store 需要上传的图标尺寸。其他为工程内用到的应用图标）：</p><table><thead><tr><th align="center">No</th><th align="center">Size</th><th align="center">PS</th></tr></thead><tbody><tr><td align="center">1</td><td align="center">54 x 40</td><td align="center"></td></tr><tr><td align="center">2</td><td align="center">58 x 58</td><td align="center"></td></tr><tr><td align="center">3</td><td align="center">64 x 48</td><td align="center"></td></tr><tr><td align="center">4</td><td align="center">81 x 60</td><td align="center"></td></tr><tr><td align="center">5</td><td align="center">87 x 87</td><td align="center"></td></tr><tr><td align="center">6</td><td align="center">96 x 72</td><td align="center"></td></tr><tr><td align="center">7</td><td align="center">120 x 90</td><td align="center"></td></tr><tr><td align="center">8</td><td align="center">134 x 100</td><td align="center"></td></tr><tr><td align="center">9</td><td align="center">148 x 110</td><td align="center"></td></tr><tr><td align="center">10</td><td align="center">180 x 135</td><td align="center"></td></tr><tr><td align="center">11</td><td align="center">1024 x 768</td><td align="center"></td></tr><tr><td align="center">12</td><td align="center">1024 x 1024</td><td align="center">App Store 应用图标</td></tr></tbody></table><p><img src="http://upload-images.jianshu.io/upload_images/1018190-7a4a2618c8a958f2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="应用图标"></p><h2 id="3-导入表情图片"><a href="#3-导入表情图片" class="headerlink" title="3.导入表情图片"></a>3.导入表情图片</h2><p>接下来，可以将我们想要添加到表情包里的图片拖到 Sticker Pack 目录中，如图所示：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-dde7f28f09c1cf87.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="导入表情图片"></p><h2 id="4-修改表情包名称"><a href="#4-修改表情包名称" class="headerlink" title="4.修改表情包名称"></a>4.修改表情包名称</h2><p>我们可以通过修改 Display Name 的方式来修改表情包在设备上显示的名称：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-9bcbb6f8e0315fcf.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="修改表情包名称"></p><h1 id="四-测试"><a href="#四-测试" class="headerlink" title="四.测试"></a>四.测试</h1><p>完成上面这些步骤后，就可以编译然后进行测试了，模拟器中运行效果如图所示：</p><p><img src="http://upload-images.jianshu.io/upload_images/1018190-248481f796531dbf.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="最终运行效果"></p><h1 id="五-提交审核"><a href="#五-提交审核" class="headerlink" title="五.提交审核"></a>五.提交审核</h1><p>（这一步不算在 10 分钟里哦，不属于开发过程唉，顺带提一下凑字数，🙄，购买开发者账号要等好几天呢）<br>若已经准备好了 iOS 开发者账号，就可以直接提交审核了，嗯，这个时候需要准备两张运行效果的屏幕截图，分别是 iPhone 和 iPad 的。</p><table><thead><tr><th align="center">Device</th><th align="center">Size</th></tr></thead><tbody><tr><td align="center">iPhone</td><td align="center">1242 x 2208</td></tr><tr><td align="center">iPad</td><td align="center">2048 x 2732</td></tr></tbody></table><p>然后应用图标使用之前准备好的 1024 x 1024 的应用图标即可，接下来填写好应用的各种信息，然后存储-提交审核即可。</p><p>本文 App 已经通过审核，iOS 10 以上系统的同学可以下载体验：<br><a href="https://itunes.apple.com/cn/app/yang-cong-hou-biao-qing-bao/id1166254758?mt=8">https://itunes.apple.com/cn/app/yang-cong-hou-biao-qing-bao/id1166254758?mt=8</a></p><p>同时预祝各位同学顺利开发出属于自己的表情包应用。</p><hr><blockquote><p>如有任何知识产权、版权问题或理论错误，还请指正。<br><a href="https://www.eyrefree.org/2016/11/24/Coding-Emoji">https://www.eyrefree.org/2016/11/24/Coding-Emoji</a><br>如文中无特殊说明，本站均使用以下协议保护：<a href="http://creativecommons.org/licenses/by-nc-nd/3.0/cn/">署名-非商业性使用-禁止演绎</a>。   </p></blockquote>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Sticker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iOS 为 App 添加 3D Touch 快捷菜单</title>
      <link href="/2016/09/22/3D-Touch/"/>
      <url>/2016/09/22/3D-Touch/</url>
      
        <content type="html"><![CDATA[<p>iOS 为 App 图标添加 3D Touch 快捷启动菜单，Demo 地址：<a href="https://github.com/EyreFree/EF3DTouchDemo">https://github.com/EyreFree/EF3DTouchDemo</a></p><hr><h1 id="1-注意事项"><a href="#1-注意事项" class="headerlink" title="1.注意事项"></a>1.注意事项</h1><p>3D Touch 只在 iOS 9 及以上版本得到支持，之前版本的 iOS 并不支持该功能；<br>3D Touch 只在 iPhone 6s 及以后型号的 iPhone 或 iPad Pro 上可用，更早的设备并不支持该功能。<br>具体可通过如下代码进行判断：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if self.traitCollection.forceTouchCapability == UIForceTouchCapability.available &#123;</span><br><span class="line">    print(&quot;支持 3D Touch&quot;)</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    print(&quot;不支持 3D Touch&quot;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="2-添加按钮"><a href="#2-添加按钮" class="headerlink" title="2.添加按钮"></a>2.添加按钮</h1><p>右键点击工程中的 Info.plist 文件选择打开方式为 Source Code：</p><center>![以 Source Code 方式打开 Info.plist](/images/3D-Touch-1.png)</center><p>在其中填写如下代码：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;key&gt;UIApplicationShortcutItems&lt;/key&gt;</span><br><span class="line">&lt;array&gt;</span><br><span class="line">    &lt;dict&gt;</span><br><span class="line">        &lt;key&gt;UIApplicationShortcutItemIconType&lt;/key&gt;</span><br><span class="line">        &lt;string&gt;UIApplicationShortcutIconTypeShuffle&lt;/string&gt;</span><br><span class="line">        &lt;key&gt;UIApplicationShortcutItemTitle&lt;/key&gt;</span><br><span class="line">        &lt;string&gt;3D Touch 测试按钮&lt;/string&gt;</span><br><span class="line">        &lt;key&gt;UIApplicationShortcutItemType&lt;/key&gt;</span><br><span class="line">        &lt;string&gt;0&lt;/string&gt;</span><br><span class="line">    &lt;/dict&gt;</span><br><span class="line">    &lt;dict&gt;</span><br><span class="line">        &lt;key&gt;UIApplicationShortcutItemIconType&lt;/key&gt;</span><br><span class="line">        &lt;string&gt;UIApplicationShortcutIconTypeLove&lt;/string&gt;</span><br><span class="line">        &lt;key&gt;UIApplicationShortcutItemTitle&lt;/key&gt;</span><br><span class="line">        &lt;string&gt;出来吧，小火龙！&lt;/string&gt;</span><br><span class="line">        &lt;key&gt;UIApplicationShortcutItemType&lt;/key&gt;</span><br><span class="line">        &lt;string&gt;1&lt;/string&gt;</span><br><span class="line">    &lt;/dict&gt;</span><br><span class="line">&lt;/array&gt;</span><br></pre></td></tr></table></figure><p>其中 UIApplicationShortcutItemIconType 项代表按钮图标，更多图标可以参见： <a href="https://developer.xamarin.com/api/type/UIKit.UIApplicationShortcutIconType/">https://developer.xamarin.com/api/type/UIKit.UIApplicationShortcutIconType/</a></p><center>![在 Info.plist 添加按钮代码](/images/3D-Touch-2.png)</center><p>这段代码添加了两个 3D Touch 按钮，“3D Touch 测试按钮”和“3D 出来吧，小火龙！”。</p><center>![成功添加 3D Touch 按钮](/images/3D-Touch-3.png)</center><h1 id="3-添加功能代码"><a href="#3-添加功能代码" class="headerlink" title="3.添加功能代码"></a>3.添加功能代码</h1><p>打开 AppDelegate.swift 在其中添加如下代码，这段代码对点击按钮操作进行了处理，点击按钮后会进入 App 弹出一个显示按钮名称的对话框：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">func application(_ application: UIApplication, performActionFor shortcutItem: UIApplicationShortcutItem, completionHandler: @escaping (Bool) -&gt; Void) &#123;</span><br><span class="line"></span><br><span class="line">    var sourceButtonTitle: String?</span><br><span class="line"></span><br><span class="line">    //根据按钮标题进行进一步操作</span><br><span class="line">    switch shortcutItem.localizedTitle &#123;</span><br><span class="line">    case &quot;3D Touch 测试按钮&quot;:</span><br><span class="line">        sourceButtonTitle = &quot;来源按钮：3D Touch 测试按钮&quot;</span><br><span class="line">        break</span><br><span class="line">    case &quot;出来吧，小火龙！&quot;:</span><br><span class="line">        sourceButtonTitle = &quot;来源按钮：出来吧，小火龙！&quot;</span><br><span class="line">        break</span><br><span class="line">    default:</span><br><span class="line">        break</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //测试操作：弹出一个对话框显示来源按钮</span><br><span class="line">    if let trySourceButtonTitle = sourceButtonTitle &#123;</span><br><span class="line">        let alert = UIAlertController(title: nil, message: trySourceButtonTitle, preferredStyle: .alert)</span><br><span class="line">        alert.addAction(UIAlertAction(title: &quot;知道啦&quot;, style: .cancel, handler: nil))</span><br><span class="line">        self.window?.rootViewController?.present(alert, animated: true, completion: nil)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><center>![在 AppDelegate.swift 添加功能代码](/images/3D-Touch-4.png)</center><p>我们可以在这里添加代码从而实现根据不同来源按钮而执行不同的操作，结果如图所示：</p><center>![操作结果](/images/3D-Touch-5.png)</center><h1 id="4-其他"><a href="#4-其他" class="headerlink" title="4.其他"></a>4.其他</h1><p>1.需要注意的是，快捷启动按钮最多只能添加 4 个。<br>2.最新的 iOS 10 系统会给所有的 App 额外添加一个 3D Touch 分享按钮，点击后不打开 App 而是调用系统分享该应用的 App Store 下载地址。</p><hr><p>参考资料：</p><p><a href="http://iostuts.io/2015/10/08/how-to-add-quick-actions/">http://iostuts.io/2015/10/08/how-to-add-quick-actions/</a><br><a href="http://stackoverflow.com/questions/36369058/how-to-check-3d-touch-available-in-iphone-programatically">http://stackoverflow.com/questions/36369058/how-to-check-3d-touch-available-in-iphone-programatically</a></p><hr><blockquote><p>如有任何知识产权、版权问题或理论错误，还请指正。<br><a href="https://www.eyrefree.org/2016/09/22/3D-Touch">https://www.eyrefree.org/2016/09/22/3D-Touch</a><br>如文中无特殊说明，本站均使用以下协议保护：<a href="http://creativecommons.org/licenses/by-nc-nd/3.0/cn/">署名-非商业性使用-禁止演绎</a>。   </p></blockquote>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 3D Touch </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OS X 下统计项目代码行数</title>
      <link href="/2016/07/19/Wrap-Count/"/>
      <url>/2016/07/19/Wrap-Count/</url>
      
        <content type="html"><![CDATA[<p>这是一条普通的计算代码行数的命令，在终端中切换到源码文件所在目录下执行即可：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">find . &quot;(&quot; -name &quot;*.m&quot; -or -name &quot;*.mm&quot; -or -name &quot;*.swift&quot; -or -name &quot;*.cpp&quot; -or -name &quot;*.h&quot; -or -name &quot;*.rss&quot; &quot;)&quot; -print | xargs wc -l</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>可以计算代码行数，源码文件类型在命令里哦，可以根据自己需要修改，上面这条是计算 iOS 项目的，效果如下：</p><p><img src="/images/Wrap-Count-1.png" alt="Wrap-Count-1.png"></p><hr><blockquote><p>如有任何知识产权、版权问题或理论错误，还请指正。<br><a href="https://www.eyrefree.org/2016/07/19/Wrap-Count">https://www.eyrefree.org/2016/07/19/Wrap-Count</a><br>如文中无特殊说明，本站均使用以下协议保护：<a href="http://creativecommons.org/licenses/by-nc-nd/3.0/cn/">署名-非商业性使用-禁止演绎</a>。   </p></blockquote>]]></content>
      
      
      <categories>
          
          <category> OS X </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Nothing </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iOS 获取当前 WiFi 信息</title>
      <link href="/2016/03/30/iOS-WiFi-Info/"/>
      <url>/2016/03/30/iOS-WiFi-Info/</url>
      
        <content type="html"><![CDATA[<p>此处以 Swift 代码为例</p><hr><h1 id="1-添加模块引用"><a href="#1-添加模块引用" class="headerlink" title="1.添加模块引用"></a>1.添加模块引用</h1><p>首先我们在需要获取 WiFi 信息的地方引用需要的模块：</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> SystemConfiguration.CaptiveNetwork</span><br></pre></td></tr></table></figure><h1 id="2-添加获取代码"><a href="#2-添加获取代码" class="headerlink" title="2.添加获取代码"></a>2.添加获取代码</h1><p>接下来编写获取 WiFi 信息的代码，如下：</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="comment">//获取 WiFi 信息</span></span><br><span class="line"><span class="keyword">func</span> <span class="title function_">getWifiInfo</span>() -&gt; (ssid: <span class="type">String</span>, mac: <span class="type">String</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> cfas: <span class="type">NSArray</span> <span class="operator">=</span> <span class="type">CNCopySupportedInterfaces</span>() &#123;</span><br><span class="line">        <span class="keyword">for</span> cfa <span class="keyword">in</span> cfas &#123;</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">let</span> dict <span class="operator">=</span> <span class="type">CFBridgingRetain</span>(</span><br><span class="line">                <span class="type">CNCopyCurrentNetworkInfo</span>(cfa <span class="keyword">as!</span> <span class="type">CFString</span>)</span><br><span class="line">                ) &#123;</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">let</span> ssid <span class="operator">=</span> dict[<span class="string">&quot;SSID&quot;</span>] <span class="keyword">as?</span> <span class="type">String</span>,</span><br><span class="line">                    <span class="keyword">let</span> bssid <span class="operator">=</span> dict[<span class="string">&quot;BSSID&quot;</span>] <span class="keyword">as?</span> <span class="type">String</span> &#123;</span><br><span class="line">                    <span class="keyword">return</span> (ssid, bssid)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (<span class="string">&quot;未知&quot;</span>, <span class="string">&quot;未知&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="3-获取-WiFi-信息"><a href="#3-获取-WiFi-信息" class="headerlink" title="3.获取 WiFi 信息"></a>3.获取 WiFi 信息</h1><p>然后在我们需要获取 WiFi 信息的位置添加如下代码即可：</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> wifiInfo <span class="operator">=</span> getWifiInfo()</span><br><span class="line"><span class="type">NSLog</span>(<span class="string">&quot;SSID(WiFi名称): <span class="subst">\(wifiInfo.<span class="number">0</span>)</span>&quot;</span>)</span><br><span class="line"><span class="type">NSLog</span>(<span class="string">&quot;BSSID(Mac地址): <span class="subst">\(wifiInfo.<span class="number">1</span>)</span>&quot;</span>)</span><br></pre></td></tr></table></figure><h1 id="4-输出结果"><a href="#4-输出结果" class="headerlink" title="4.输出结果"></a>4.输出结果</h1><center>![iOS-WiFi-Info-1](/images/iOS-WiFi-Info-1.png)</center><hr><blockquote><p>如有任何知识产权、版权问题或理论错误，还请指正。<br><a href="https://www.eyrefree.org/2016/03/30/iOS-WiFi-Info">https://www.eyrefree.org/2016/03/30/iOS-WiFi-Info</a><br>如文中无特殊说明，本站均使用以下协议保护：<a href="http://creativecommons.org/licenses/by-nc-nd/3.0/cn/">署名-非商业性使用-禁止演绎</a>。   </p></blockquote>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Nothing </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OS X 下使用 Hexo 和 Coding Pages 搭建静态博客</title>
      <link href="/2016/03/23/Hexo-Coding-Pages/"/>
      <url>/2016/03/23/Hexo-Coding-Pages/</url>
      
        <content type="html"><![CDATA[<p><a href="https://github.com/hexojs/hexo">Hexo</a> 是一款基于 Node.js 的静态博客框架, 目前在 GitHub 上已有 9133 star 和 1499 fork。Hexo 生成的静态页面可以部署在 Github 或 Coding 上，并且能够免费绑定自己的域名，可以用来很方便地搭建个人博客。</p><hr><h1 id="1，Git-安装"><a href="#1，Git-安装" class="headerlink" title="1，Git 安装"></a>1，Git 安装</h1><p>搭建博客需要用到 git，下面这条命令可查看本机是否已安装 git，若未安装可参考<a href="http://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000/00137396287703354d8c6c01c904c7d9ff056ae23da865a000/">这篇博文</a>进行安装。</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git --version</span><br></pre></td></tr></table></figure><h1 id="2，安装-Node-js"><a href="#2，安装-Node-js" class="headerlink" title="2，安装 Node.js"></a>2，安装 Node.js</h1><p>Mac下最简单的做法便是直接下载pkg文件进行安装，最新版本的下载地址如下，选择后缀为pkg的文件下载安装即可：  <br><a href="https://nodejs.org/download/release/latest/">https://nodejs.org/download/release/latest/</a>  <br>完装完成后，要将以下路径计入你的系统环境变量 &#x2F;usr&#x2F;local&#x2F;bin，步骤如下：<br>用vim 打开该文件：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span>; vi .bash_profile</span><br></pre></td></tr></table></figure><p>在文件中加入该语句：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> PATH=/usr/local/bin:<span class="variable">$PATH</span></span><br></pre></td></tr></table></figure><p>并保存退出，重新加载shell让设置的环境变量生效：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">source</span> ~/.bash_profile</span><br></pre></td></tr></table></figure><h1 id="3，将-npm-的源替换成淘宝的源"><a href="#3，将-npm-的源替换成淘宝的源" class="headerlink" title="3，将 npm 的源替换成淘宝的源"></a>3，将 npm 的源替换成淘宝的源</h1><p>由于众所周知的原因，国内访问官方默认 npmjs.org 源速度不是十分理想，所以建议切换成国内的，利用以下命令将其替换为淘宝的 npm 源： </p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm config <span class="built_in">set</span> registry http://registry.npm.taobao.org/</span><br></pre></td></tr></table></figure><h1 id="4，安装-Hexo"><a href="#4，安装-Hexo" class="headerlink" title="4，安装 Hexo"></a>4，安装 Hexo</h1><p>利用 npm 命令安装：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo npm install -g hexo</span><br></pre></td></tr></table></figure><p>因为可能有文件读写权限的问题，这里推荐用 sudo，输入密码后会开始安装，时间可能比较长，耐心等待，如果长时间卡在某一步 Ctrl + C 终止当前任务后重试即可。</p><h1 id="5，本地建立博客"><a href="#5，本地建立博客" class="headerlink" title="5，本地建立博客"></a>5，本地建立博客</h1><p>安装完成后，新建一个目录如 myblog 用于存放博客，切换到该目录下执行以下指令，Hexo 即会在目标文件夹初步生成博客所需要的所有文件：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo init</span><br></pre></td></tr></table></figure><p>然后切换到该目录下执行如下命令，安装所需要的依赖：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo npm install</span><br></pre></td></tr></table></figure><p>网上有大量开发者们分享的模板可供选择使用，将它们的 Git 仓库 Clone 以后放到博客目录下的 themes 文件夹中即可：  <br><a href="https://github.com/hexojs/hexo/wiki/Themes">Github Hexo Themes</a>  <br><a href="http://www.zhihu.com/question/24422335">有哪些好看的 Hexo 主题？</a>  <br>本博客的搭建我选择了使用该主题：  <br><a href="https://github.com/forsigner/fexo">https://github.com/forsigner/fexo</a>  <br>在这里对原作者 forsigner 表示感谢，🙏</p><h1 id="6，安装-Server-组件"><a href="#6，安装-Server-组件" class="headerlink" title="6，安装 Server 组件"></a>6，安装 Server 组件</h1><p>保持在本地博客路径下，在终端中执行如下命令：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo</span><br></pre></td></tr></table></figure><p>因为这并不是一个完整的命令，所以这时我们可以看到 hexo 输出的帮助信息，如下图所示：</p><center>![Hexo-Coding-Pages-1](/images/Hexo-Coding-Pages-1.png)</center><p>我们可以在左边的 Commands 列表中查看我们需要的命令是否已成功安装，因为某些版本的 Hexo 的 Server 模块需要独立安装所以这里我们并没有看到 server 命令，我们可以执行下面这条命令来进行安装，如果有的话可以跳过这一步：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo npm install hexo-server --save</span><br></pre></td></tr></table></figure><p>如果安装过程中出现一些问题导致某些模块没有安装成功的也可以通过类似的方式单独安装某个模块进行修复。</p><h1 id="7，安装-RSS-插件（可忽略）"><a href="#7，安装-RSS-插件（可忽略）" class="headerlink" title="7，安装 RSS 插件（可忽略）"></a>7，安装 RSS 插件（可忽略）</h1><p>到博客所在目录 myblog 下，利用该命令安装 RSS 插件，暂时不需添加 RSS 功能的同学可忽略该步骤：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo npm install hexo-generator-feed --save</span><br></pre></td></tr></table></figure><p>编辑 myblog 目录下的 _config.yml，添加如下代码开启 RSS 功能：  </p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">rss: /atom.xml</span><br></pre></td></tr></table></figure><p>RSS 地址保持默认即可，不需要多做修改。</p><h1 id="8，本地效果预览"><a href="#8，本地效果预览" class="headerlink" title="8，本地效果预览"></a>8，本地效果预览</h1><p>在终端使用 cd 命令切换到博客所在目录 myblog，执行如下命令生成静态博客页面并启动本地服务器，若成功可在浏览器中访问 <a href="http://localhost:4000/">http://localhost:4000/</a> 进行预览。 </p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo generate</span><br><span class="line">hexo server</span><br></pre></td></tr></table></figure><p>或者如下的缩写形式也可以：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo g</span><br><span class="line">hexo s</span><br></pre></td></tr></table></figure><h1 id="9，部署到-Coding-Pages"><a href="#9，部署到-Coding-Pages" class="headerlink" title="9，部署到 Coding Pages"></a>9，部署到 Coding Pages</h1><p>在 Coding 新建一个项目，假设为 myblog，然后修改本地博客目录下的 _config.yml 文件，根据<a href="https://hexo.io/docs/deployment.html">官方文档</a>的描述，修改以下几个参数，这些参数一般在文件底部：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">deploy:</span><br><span class="line"><span class="built_in">type</span>: git               <span class="comment">#部署方式，这里我们用的是Coding的Git</span></span><br><span class="line">repo: &lt;repository url&gt;  <span class="comment">#仓库地址，例如我的是git@git.coding.net:eyrefree/myblog.git   </span></span><br><span class="line">branch: [branch]        <span class="comment">#分支名，可任意填写，我填写的是master</span></span><br><span class="line">message: [message]      <span class="comment">#可不填，这是显示在提交记录里的描述信息，默认为日期</span></span><br></pre></td></tr></table></figure><p>参数修改完成后，我们需要在终端中切换到博客所在目录安装 deploy 组建，执行以下命令将生成的博客静态页面 push 到我们上面在 Coding 创建的 myblog 仓库中：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure><p>然后执行依次执行清理命令：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo clean</span><br></pre></td></tr></table></figure><p>生成命令：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo g</span><br></pre></td></tr></table></figure><p>部署命令：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo d</span><br></pre></td></tr></table></figure><p>如果在 _config.yml 的 repo 处填写的仓库地址是 https 形式的，在部署时可能需要输入你的 Coding 账号和密码。  <br>然后切换到该项目的 Pages 标签，开启 pages 服务，分支名填写为我们在_config.yml 文件中设定的分支，我的是 master。</p><h1 id="10，服务器效果预览"><a href="#10，服务器效果预览" class="headerlink" title="10，服务器效果预览"></a>10，服务器效果预览</h1><p>pages 服务开启完成后，Coding 会提供一个类似 {user_name}.coding.me&#x2F;{project_name} 的链接用于访问，例如用户名为 eyrefree 项目名为 myblog 的链接应该是： </p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://eyrefree.coding.me/myblog</span><br></pre></td></tr></table></figure><p>访问该链接即可进行预览，由于我们引用的资源很多是和域名相关的，导致这里可能会有资源加载失败的情况，只能出现部分文字，接下来我们将域名绑定后即可恢复正常。</p><h1 id="11，绑定域名"><a href="#11，绑定域名" class="headerlink" title="11，绑定域名"></a>11，绑定域名</h1><p>默认提供的链接可能过长或者不便于日常使用，我们也可以绑定自己的域名。  <br>首先，需要提前准备一个域名，然后打开自己的域名控制面板，新建一个 CNAME 解析到 {user_name}.coding.me，例如我的是将 <a href="http://www.eyrefree.org/">www.eyrefree.org</a> 解析到 eyrefree.coding.me；  <br>然后，打开 Coding 项目页面切换到 pages 项，填入刚才的设置解析的域名 <a href="http://www.eyrefree.org,点击“添加域名绑定”按钮即可,在浏览器中直接访问/">www.eyrefree.org，点击“添加域名绑定”按钮即可，在浏览器中直接访问</a> <a href="http://www.eyrefree.org/">www.eyrefree.org</a> 就能成功打开。  <br>有时可能由于缓存或者解析时间的问题，稍等片刻即可。 </p><h1 id="12，编写博文"><a href="#12，编写博文" class="headerlink" title="12，编写博文"></a>12，编写博文</h1><p>接下来就是日常的博文编写啦，这里是使用 markdown 格式的，编写完成后添加到 source&#x2F;_posts 目录下然后按照第 8 步的方法部署到 Coding 服务器即可，具体可参考<a href="http://www.jianshu.com/p/3c7ddd48bfa9">这篇博文</a>，Markdown 的一些语法可以参考：  <br><a href="http://wowubuntu.com/markdown/">http://wowubuntu.com/markdown/</a></p><h1 id="13，常见问题"><a href="#13，常见问题" class="headerlink" title="13，常见问题"></a>13，常见问题</h1><p>若执行 hexo 命令时出现如下警告信息：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&#123; [Error: Cannot find module <span class="string">&#x27;./build/Release/DTraceProviderBindings&#x27;</span>] code: <span class="string">&#x27;MODULE_NOT_FOUND&#x27;</span> &#125;</span><br><span class="line">&#123; [Error: Cannot find module <span class="string">&#x27;./build/default/DTraceProviderBindings&#x27;</span>] code: <span class="string">&#x27;MODULE_NOT_FOUND&#x27;</span> &#125;</span><br><span class="line">&#123; [Error: Cannot find module <span class="string">&#x27;./build/Debug/DTraceProviderBindings&#x27;</span>] code: <span class="string">&#x27;MODULE_NOT_FOUND&#x27;</span> &#125;</span><br></pre></td></tr></table></figure><p>可以尝试执行以下命令修复：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo npm install hexo --no-optional</span><br></pre></td></tr></table></figure><hr><p>嘛，大概就是这些内容了，有遗漏的话会继续补充，😝。<a href="http://www.eyrefree.org/">我的博客</a>是用 Hexo 生成的使用了 Fexo 模版，开启了 Google 统计，Disqus 评论，RSS 订阅，站内搜索等，详情参见我的 Coding 仓库的 Hexo 分支：<br><a href="https://coding.net/u/eyrefree/p/blog.eyrefree.org/git">https://coding.net/u/eyrefree/p/blog.eyrefree.org/git</a></p><hr><blockquote><p>如有任何知识产权、版权问题或理论错误，还请指正。<br><a href="https://www.eyrefree.org/2016/03/23/Hexo-Coding-Pages">https://www.eyrefree.org/2016/03/23/Hexo-Coding-Pages</a><br>如文中无特殊说明，本站均使用以下协议保护：<a href="http://creativecommons.org/licenses/by-nc-nd/3.0/cn/">署名-非商业性使用-禁止演绎</a>。   </p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Blog </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iOS 在 App 中获取 XCode 构建信息</title>
      <link href="/2016/03/08/iOS-Build-Info/"/>
      <url>/2016/03/08/iOS-Build-Info/</url>
      
        <content type="html"><![CDATA[<p>iOS 在 App 中获取当前版本的构建时间和 Git Hash 值，Demo 地址：  <br><a href="https://github.com/EyreFree/EFBuildInfoDemo">https://github.com/EyreFree/EFBuildInfoDemo</a></p><hr><h1 id="1-添加-Run-Script"><a href="#1-添加-Run-Script" class="headerlink" title="1.添加 Run Script"></a>1.添加 Run Script</h1><p>打开需要获取构建信息的工程，选中工程，切换到 Build Phases 选项卡，点击左边的“+”号选择“New Run Script Phase”一项添加一个新的 Run Script：</p><center>![iOS-Build-Info-1](/images/iOS-Build-Info-1.png)</center><p>并将其命名为“Build Config”，然后将其拖动到“Target Dependencies”的下面：</p><center>![iOS-Build-Info-2](/images/iOS-Build-Info-2.png)</center><h1 id="2-为-Run-Script-添加代码"><a href="#2-为-Run-Script-添加代码" class="headerlink" title="2.为 Run Script 添加代码"></a>2.为 Run Script 添加代码</h1><p>点开“Build Config”左边的小三角，在其中填写如下代码：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">myFile=<span class="string">&quot;BuildConfig.plist&quot;</span></span><br><span class="line"></span><br><span class="line">myDate=`<span class="built_in">date</span> +%Y-%m-%dT%H:%M:%S%z`</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$myDate</span></span><br><span class="line">myHash=`git rev-parse --short HEAD`</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$myHash</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ ! -f <span class="string">&quot;<span class="variable">$myFile</span>&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">    /usr/libexec/PlistBuddy -c <span class="string">&quot;Add :BUILD_TIME string <span class="variable">$myDate</span>&quot;</span> <span class="string">&quot;<span class="variable">$myFile</span>&quot;</span></span><br><span class="line">    /usr/libexec/PlistBuddy -c <span class="string">&quot;Add :GIT_SHA string <span class="variable">$myHash</span>&quot;</span> <span class="string">&quot;<span class="variable">$myFile</span>&quot;</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    /usr/libexec/PlistBuddy -c <span class="string">&quot;Set :BUILD_TIME <span class="variable">$myDate</span>&quot;</span> <span class="string">&quot;<span class="variable">$myFile</span>&quot;</span></span><br><span class="line">    /usr/libexec/PlistBuddy -c <span class="string">&quot;Set :GIT_SHA <span class="variable">$myHash</span>&quot;</span> <span class="string">&quot;<span class="variable">$myFile</span>&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure><center>![iOS-Build-Info-3](/images/iOS-Build-Info-3.png)</center><h1 id="3-生成-BuildConfig-plist-文件"><a href="#3-生成-BuildConfig-plist-文件" class="headerlink" title="3.生成 BuildConfig.plist 文件"></a>3.生成 BuildConfig.plist 文件</h1><p>然后我们编译一次就可以发现，这段代码会在编译时在工程所在目录下生成一个 BuildConfig.plist 文件，其中包含了本次构建的时间和当前版本的 GitHash，以后每一次 XCode 构建时都会自动更新该文件，详细内容如下：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="line">&lt;!DOCTYPE plist PUBLIC <span class="string">&quot;-//Apple//DTD PLIST 1.0//EN&quot;</span> <span class="string">&quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;</span>&gt;</span><br><span class="line">&lt;plist version=<span class="string">&quot;1.0&quot;</span>&gt;</span><br><span class="line">&lt;dict&gt;</span><br><span class="line">        &lt;key&gt;BUILD_TIME&lt;/key&gt;</span><br><span class="line">        &lt;string&gt;2016-03-30T09:38:04+0800&lt;/string&gt;</span><br><span class="line">        &lt;key&gt;GIT_SHA&lt;/key&gt;</span><br><span class="line">        &lt;string&gt;3e4d213&lt;/string&gt;</span><br><span class="line">&lt;/dict&gt;</span><br><span class="line">&lt;/plist&gt;</span><br></pre></td></tr></table></figure><center>![iOS-Build-Info-4](/images/iOS-Build-Info-4.png)</center><h1 id="4-获取-BuildConfig-plist-文件内容"><a href="#4-获取-BuildConfig-plist-文件内容" class="headerlink" title="4.获取 BuildConfig.plist 文件内容"></a>4.获取 BuildConfig.plist 文件内容</h1><p>将 BuildConfig.plist 添加到我们的工程中：</p><center>![iOS-Build-Info-5](/images/iOS-Build-Info-5.png)</center><p>然后在需要获取构建信息的位置添加如下代码就能成功获取构建时间和 Git Hash 值：</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="comment">//输出构建信息</span></span><br><span class="line"><span class="keyword">var</span> bulidTime: <span class="type">String</span>!</span><br><span class="line"><span class="keyword">var</span> gitSha: <span class="type">String</span>!</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> buildConfigFilePath <span class="operator">=</span> <span class="type">NSBundle</span>.mainBundle()</span><br><span class="line">    .pathForResource(<span class="string">&quot;BuildConfig&quot;</span>, ofType: <span class="string">&quot;plist&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> dict <span class="operator">=</span> <span class="type">NSDictionary</span>(contentsOfFile: buildConfigFilePath) &#123;</span><br><span class="line">        bulidTime <span class="operator">=</span> dict[<span class="string">&quot;BUILD_TIME&quot;</span>] <span class="keyword">as?</span> <span class="type">String</span> <span class="operator">??</span> <span class="string">&quot;未知&quot;</span></span><br><span class="line">        gitSha <span class="operator">=</span> dict[<span class="string">&quot;GIT_SHA&quot;</span>] <span class="keyword">as?</span> <span class="type">String</span> <span class="operator">??</span> <span class="string">&quot;未知&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;BUILD_TIME: <span class="subst">\(bulidTime)</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;GIT_SHA: <span class="subst">\(gitSha)</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p>结果如图所示：</p><center>![iOS-Build-Info-6](/images/iOS-Build-Info-6.png)</center><hr><blockquote><p>如有任何知识产权、版权问题或理论错误，还请指正。<br><a href="https://www.eyrefree.org/2016/03/08/iOS-Build-Info">https://www.eyrefree.org/2016/03/08/iOS-Build-Info</a><br>如文中无特殊说明，本站均使用以下协议保护：<a href="http://creativecommons.org/licenses/by-nc-nd/3.0/cn/">署名-非商业性使用-禁止演绎</a>。   </p></blockquote>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Nothing </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OS X 下使用 Jekyll 和 Coding Pages 搭建静态博客</title>
      <link href="/2016/03/01/Jekyll-Coding-Pages/"/>
      <url>/2016/03/01/Jekyll-Coding-Pages/</url>
      
        <content type="html"><![CDATA[<p>Jekyll 是一个免费的简单静态网页生成工具，可以配合第三方服务例如 Disqus 实现一些扩展功能，不需要数据库支持。并且 Jekyll 可以部署在Github 或 Coding 上，可以绑定自己的域名，而且目前这是完全免费的。</p><hr><h1 id="1，Git-安装"><a href="#1，Git-安装" class="headerlink" title="1，Git 安装"></a>1，Git 安装</h1><p>搭建博客需要用到 git，git –version 命令可查看本机是否已安装 git，若未安装可参考<a href="http://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000/00137396287703354d8c6c01c904c7d9ff056ae23da865a000/">这篇博文</a>进行安装。</p><h1 id="2，Gem-安装-x2F-设置"><a href="#2，Gem-安装-x2F-设置" class="headerlink" title="2，Gem 安装&#x2F;设置"></a>2，Gem 安装&#x2F;设置</h1><p>安装 Jekyll 需要用到包管理器 gem，gem -v 命令可查看本机是否已安装 gem，若未安装请自行安装。<br>由于众所周知的原因，国内访问官方默认 gem sources 源速度不是十分理想，所以建议切换成国内的，利用 gem sources -l 命令可查看当前 gem sources 源：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gem sources --remove http://rubygems.org/</span><br></pre></td></tr></table></figure><p>然后利用以下命令将其替换为淘宝的（注意：这里的 <a href="http://rubygems.org/">http://rubygems.org/</a> 替换成当前 gem sources 源地址）： </p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gem sources -a https://ruby.taobao.org/</span><br></pre></td></tr></table></figure><h1 id="3，安装-Jekyll-到本地"><a href="#3，安装-Jekyll-到本地" class="headerlink" title="3，安装 Jekyll 到本地"></a>3，安装 Jekyll 到本地</h1><p>因为打算在 Coding Pages 上搭建，根据 <a href="https://coding.net/help/doc/pages/index.html">Coding 帮助文档</a>，Coding Pages 目前支持 jekyll 2.4.0，所以我们需要指定版本安装 Jekyll，终端执行以下命令： </p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo gem install jekyll -v <span class="string">&#x27;2.4.0&#x27;</span></span><br></pre></td></tr></table></figure><p>输入密码后等待安装完成，执行以下命令尝试查看 Jekyll 版本号： </p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">jekyll -v</span><br></pre></td></tr></table></figure><p>若能正确显示版本号 jekyll 2.4.0 表示安装成功。 </p><h1 id="4，本地建立博客"><a href="#4，本地建立博客" class="headerlink" title="4，本地建立博客"></a>4，本地建立博客</h1><p>从零开始手动编写的话可以参考：<a href="http://www.blogways.net/blog/2013/04/13/jekyll-usage.html">这篇博文</a>，同时网上有大量开发者们分享的模板可供选择使用：<br><a href="http://jekyllthemes.org/">Jekyll Themes</a><br><a href="https://github.com/jekyll/jekyll/wiki/Sites">Github Jekyll Sites</a><br>本博客的搭建我选择了在该<a href="https://github.com/sl4m/skim.cc">模板</a>的基础上进行修改，在这里对原作者表示感谢，🙏<br>在终端中切换到合适的目录下执行以下命令：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/sl4m/skim.cc.git</span><br></pre></td></tr></table></figure><p>将模板 git 仓库下载到本地。</p><h1 id="5，本地效果预览"><a href="#5，本地效果预览" class="headerlink" title="5，本地效果预览"></a>5，本地效果预览</h1><p>终端中用 cd 命令切换到本地博客所在目录，即 skim.cc 目录下，执行 jekyll server 命令启动本地服务器，若启动成功可在浏览器中访问 <a href="http://0.0.0.0:4000/">http://0.0.0.0:4000/</a> 进行预览。 </p><h1 id="6，上传到-Coding-Pages"><a href="#6，上传到-Coding-Pages" class="headerlink" title="6，上传到 Coding Pages"></a>6，上传到 Coding Pages</h1><p>在 Coding 新建一个项目，将博客所在项目 push 到新建的项目中，推荐的做法是创建一个新的 coding-pages 分支来作为启动 Coding Pages 之用（其他分支名也可以），然后切换到 Pages 标签，开启 pages 服务，分支名填写为我们需要的分支，这里是 coding-pages。</p><h1 id="7，服务器效果预览"><a href="#7，服务器效果预览" class="headerlink" title="7，服务器效果预览"></a>7，服务器效果预览</h1><p>这时 Coding 会提供一个类似 {user_name}.coding.me&#x2F;{project_name} 的链接用于访问，例如本博客的是： </p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[http://eyrefree.coding.me/blog.eyrefree.org](http://eyrefree.coding.me/blog.eyrefree.org)</span><br></pre></td></tr></table></figure><h1 id="8，绑定域名"><a href="#8，绑定域名" class="headerlink" title="8，绑定域名"></a>8，绑定域名</h1><p>默认提供的链接可能过长或者不便于日常使用，我们也可以绑定自己的域名。<br>首先，需要提前准备一个域名，然后打开自己的域名控制面板，新建一个 CNAME 解析到 {user_name}.coding.me，例如我的是将 blog.eyrefree.org 解析到 eyrefree.coding.me；<br>然后，打开 Coding 项目页面切换到 pages 项，填入刚才的设置解析的域名 blog.eyrefree.org，点击“添加域名绑定”按钮即可，在浏览器中直接访问 blog.eyrefree.org 就能成功打开。<br>有时可能由于缓存或者解析时间的问题，稍等片刻即可。 </p><h1 id="9，编写博文"><a href="#9，编写博文" class="headerlink" title="9，编写博文"></a>9，编写博文</h1><p>接下来就是日常的博文编写啦，这里是使用 markdown 格式的，编写完成后添加到 _posts 目录下 push 到 Coding 服务器即可，具体可参考<a href="https://segmentfault.com/a/1190000000406013">这篇博文</a>。</p><hr><p>嘛，大概就是这些内容了，有遗漏的话后期会继续补充，😝，<a href="http://www.eyrefree.org/">我的博客</a>在原模版基础上将 Google 统计，Disqus 评论，feedburner 等替换为了自己的，其他的一些修改详情参见我的 Coding 仓库的 Jekyll 分支：<br><a href="https://coding.net/u/eyrefree/p/blog.eyrefree.org/git">https://coding.net/u/eyrefree/p/blog.eyrefree.org/git</a></p><hr><blockquote><p>如有任何知识产权、版权问题或理论错误，还请指正。<br><a href="https://www.eyrefree.org/2016/03/01/Jekyll-Coding-Pages">https://www.eyrefree.org/2016/03/01/Jekyll-Coding-Pages</a><br>如文中无特殊说明，本站均使用以下协议保护：<a href="http://creativecommons.org/licenses/by-nc-nd/3.0/cn/">署名-非商业性使用-禁止演绎</a>。</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Blog </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Jekyll </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iOS 集成广点通移动 App 激活数据统计 API 上报方案</title>
      <link href="/2016/02/18/iOS-GuangDianTong/"/>
      <url>/2016/02/18/iOS-GuangDianTong/</url>
      
        <content type="html"><![CDATA[<p>iOS 集成广点通移动 App 激活数据统计 API 上报方案。</p><p>Demo 地址：<a href="https://github.com/EyreFree/EFGuangDianTongDemo">https://github.com/EyreFree/EFGuangDianTongDemo</a></p><hr><h1 id="一，获取参数"><a href="#一，获取参数" class="headerlink" title="一，获取参数"></a>一，获取参数</h1><h2 id="1，Apple-ID"><a href="#1，Apple-ID" class="headerlink" title="1，Apple ID"></a>1，Apple ID</h2><p>Apple ID 是一个数字，每一个 iOS 应用都有一个 Apple ID，打开 <a href="http://itunesconnect.apple.com/">iTunesConnect</a>，点击我们所需要集成广点通的 App 进入详情页面，点击左边的“App 信息”，找到其中的“综合信息”一项，其中包含我们需要的 Apple ID，如下图所示：</p><center>![iOS-GuangDianTong-1](/images/iOS-GuangDianTong-1.png)</center><h2 id="2，UID"><a href="#2，UID" class="headerlink" title="2，UID"></a>2，UID</h2><p>UID 是一个数字，它是我们在广点通的账户 ID，打开<a href="http://e.qq.com/">广点通</a>进入管理平台，在最顶部的显示的账户信息中的“账户 ID”就是我们需要的 UID，如下图所示：</p><center>![iOS-GuangDianTong-2](/images/iOS-GuangDianTong-2.png)</center><h2 id="3，EncryptKey-和-SignKey"><a href="#3，EncryptKey-和-SignKey" class="headerlink" title="3，EncryptKey 和 SignKey"></a>3，EncryptKey 和 SignKey</h2><p>每一个 AppID 广点通会分配给我们一个加密密钥 encrypt_key 和一个签名密钥 sign_key，打开<a href="http://e.qq.com/">广点通</a>进入管理平台，点击左边的“工具箱”然后选择“转化跟踪”，然后点击“创建新转化”，依次输入信息创建对应 App 的转化，注意“转化方案”一项选择“API方案二”，提交后会在列表中出现一个我们新创建的转化，点击“查看”，就会得到我们需要的 encrypt_key 和 sign_key，如下图所示：</p><center>![iOS-GuangDianTong-3](/images/iOS-GuangDianTong-3.png)</center><h1 id="二，实现-API-上报方案"><a href="#二，实现-API-上报方案" class="headerlink" title="二，实现 API 上报方案"></a>二，实现 API 上报方案</h1><p>根据文档实现了 API 上报方案流程，代码参见：<a href="https://github.com/EyreFree/EFGuangDianTongDemo/blob/master/EFGuangDianTongDemo/EFGuangDianTong.swift">https://github.com/EyreFree/EFGuangDianTongDemo/blob/master/EFGuangDianTongDemo/EFGuangDianTong.swift</a></p><h1 id="三，调用方式"><a href="#三，调用方式" class="headerlink" title="三，调用方式"></a>三，调用方式</h1><h2 id="1，添加第三方库"><a href="#1，添加第三方库" class="headerlink" title="1，添加第三方库"></a>1，添加第三方库</h2><p>需要添加 Alamofire 用于网络操作，Demo 中是通过 CocoaPods 的方式引用，所以在将 Demo Clone 下来后要先进行 pod install 操作，具体内容可参考这篇博文：<a href="http://code4app.com/article/cocoapods-install-usage">CocoaPods安装和使用教程</a></p><h2 id="2，添加头文件"><a href="#2，添加头文件" class="headerlink" title="2，添加头文件"></a>2，添加头文件</h2><p>由于实现 API 上报方案的过程中需要用到 MD5 加密，所以需要添加相应的 Objective-C 头文件：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#import &lt;CommonCrypto/CommonDigest.h&gt;</span><br></pre></td></tr></table></figure><p>由于我们这里是 Swift 工程，所以添加 OC 头文件需要通过给项目添加一个用于桥接的头文件，具体过程可参考：<a href="http://blog.sina.com.cn/s/blog_8d1bc23f0102v5tl.html">IOS — OC与Swift混编</a></p><h2 id="3，添加实现代码"><a href="#3，添加实现代码" class="headerlink" title="3，添加实现代码"></a>3，添加实现代码</h2><p>将 Demo 中的 EFGuangDianTong.swift 文件添加到需要集成广点通统计的项目中。</p><h2 id="4，调用-API-上报方法"><a href="#4，调用-API-上报方法" class="headerlink" title="4，调用 API 上报方法"></a>4，调用 API 上报方法</h2><p>在 AppDelegate 的 didFinishLaunchingWithOptions 方法中合适的地方添加如下代码：</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="type">EFGuangDianTong</span>.sharedInstance.<span class="type">Schema2</span>(</span><br><span class="line">      appid: <span class="number">111111111</span>,              <span class="comment">//替换为我们的 Apple ID</span></span><br><span class="line">      uid: <span class="number">222222</span>,                   <span class="comment">//替换为我们的 UID</span></span><br><span class="line">      signKey: <span class="string">&quot;xxxxxxxxxxxxxxxx&quot;</span>,   <span class="comment">//替换为我们的 sign_key</span></span><br><span class="line">      encryptKey: <span class="string">&quot;zzzzzzzzzzzzzzzz&quot;</span> <span class="comment">//替换为我们的 encrypt_key</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><h2 id="5，查看返回状态"><a href="#5，查看返回状态" class="headerlink" title="5，查看返回状态"></a>5，查看返回状态</h2><p>若上报成功，则 XCode 下方的控制台会输出“广点通上报:成功”；<br>若失败则会根据返回码输出具体失败原因，可以根据输出的错误信息来做相应的检查。</p><h1 id="四，备注"><a href="#四，备注" class="headerlink" title="四，备注"></a>四，备注</h1><p>集成广点通需要使用 IDFA，请在 App 提交审核时注意勾选相应选项，否则容易导致二进制文件被拒绝。</p><hr><blockquote><p>如有任何知识产权、版权问题或理论错误，还请指正。<br><a href="https://www.eyrefree.org/2016/02/18/iOS-GuangDianTong">https://www.eyrefree.org/2016/02/18/iOS-GuangDianTong</a><br>如文中无特殊说明，本站均使用以下协议保护：<a href="http://creativecommons.org/licenses/by-nc-nd/3.0/cn/">署名-非商业性使用-禁止演绎</a>。   </p></blockquote>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Nothing </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Swift UIColor 添加从十六进制值初始化的扩展</title>
      <link href="/2015/09/10/Swift-UIColor-Hex/"/>
      <url>/2015/09/10/Swift-UIColor-Hex/</url>
      
        <content type="html"><![CDATA[<p>在实际开发中，我们拿到的设计图上的颜色往往标注的是十六进制的，而在不添加第三方库的情况下 UIColor 并不支持从十六进制数字初始化，手动将十六进制颜色转化为 RGB 形式十分浪费精力，我们可以通过为 UIColor 添加扩展的方式来支持直接从十六进制数值初始化从而为我们的开发带来便利。</p><hr><h1 id="1-添加文件"><a href="#1-添加文件" class="headerlink" title="1.添加文件"></a>1.添加文件</h1><p>在项目中添加一个用于编写扩展代码的文件，将其命名为 <code>UIColor+valueRGB.swift</code>。</p><h1 id="2-添加扩展代码"><a href="#2-添加扩展代码" class="headerlink" title="2.添加扩展代码"></a>2.添加扩展代码</h1><p>在第一步创建的文件中添加如下代码：</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">UIColor</span> &#123;</span><br><span class="line">    <span class="comment">//用数值初始化颜色，便于生成设计图上标明的十六进制颜色</span></span><br><span class="line">    <span class="keyword">convenience</span> <span class="keyword">init</span>(<span class="params">valueRGB</span>: <span class="type">UInt</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.<span class="keyword">init</span>(</span><br><span class="line">            red: <span class="type">CGFloat</span>((valueRGB <span class="operator">&amp;</span> <span class="number">0xFF0000</span>) <span class="operator">&gt;&gt;</span> <span class="number">16</span>) <span class="operator">/</span> <span class="number">255.0</span>,</span><br><span class="line">            green: <span class="type">CGFloat</span>((valueRGB <span class="operator">&amp;</span> <span class="number">0x00FF00</span>) <span class="operator">&gt;&gt;</span> <span class="number">8</span>) <span class="operator">/</span> <span class="number">255.0</span>,</span><br><span class="line">            blue: <span class="type">CGFloat</span>(valueRGB <span class="operator">&amp;</span> <span class="number">0x0000FF</span>) <span class="operator">/</span> <span class="number">255.0</span>,</span><br><span class="line">            alpha: <span class="type">CGFloat</span>(<span class="number">1.0</span>)</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="3-调用"><a href="#3-调用" class="headerlink" title="3.调用"></a>3.调用</h1><p>然后我们就可以在工程中以如下方式直接从十六进制数字初始化 UIColor 了：</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> testColor <span class="operator">=</span> <span class="type">UIColor</span>(valueRGB: <span class="number">0x666666</span>)</span><br></pre></td></tr></table></figure><hr><p>实际上这里没有做十六进制的限定，只需要是 UInt 类型都可以，但是貌似暂时没发现什么实际意义，用来生成随机颜色？或者是画颜色表？大家可以自行挖掘下，😊</p><hr><blockquote><p>如有任何知识产权、版权问题或理论错误，还请指正。<br><a href="https://www.eyrefree.org/2015/09/10/Swift-UIColor-Hex">https://www.eyrefree.org/2015/09/10/Swift-UIColor-Hex</a><br>如文中无特殊说明，本站均使用以下协议保护：<a href="http://creativecommons.org/licenses/by-nc-nd/3.0/cn/">署名-非商业性使用-禁止演绎</a>。   </p></blockquote>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Swift </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>XCode 中 Swift / Objective-C / C / C++ 混合编程</title>
      <link href="/2015/09/06/XCode-Swift-Objective-C-C-C++/"/>
      <url>/2015/09/06/XCode-Swift-Objective-C-C-C++/</url>
      
        <content type="html"><![CDATA[<p>Swift 是苹果于2014年 WWDC 发布的一种新的用于编写 iOS 和 OS X 应用的编程语言，可与 Objective-C &#x2F; C &#x2F; C++ 进行混合编程。</p><hr><h1 id="1-Objective-C-调用-C"><a href="#1-Objective-C-调用-C" class="headerlink" title="1.Objective-C 调用 C"></a>1.Objective-C 调用 C</h1><p>Objective-C 是 C 的超集，所以 Objective-C 完全兼容 C，可以直接在 Objective-C 代码中写 C 代码无需修改。</p><h1 id="2-Objective-C-调用-C"><a href="#2-Objective-C-调用-C" class="headerlink" title="2.Objective-C 调用 C++"></a>2.Objective-C 调用 C++</h1><p>Xcode 需要源文件以 .mm 为扩展名，这样才能启动编译器的 Objective-C++ 扩展，在 .mm 文件内可以编写 C++ 代码也可以编写 Objective-C 代码，支持大部分的 C++ 的特性，几乎完全兼容 GNU C&#x2F;C++。</p><h1 id="3-Swift-调用-Objective-C"><a href="#3-Swift-调用-Objective-C" class="headerlink" title="3.Swift 调用 Objective-C"></a>3.Swift 调用 Objective-C</h1><h2 id="1-添加桥接文件"><a href="#1-添加桥接文件" class="headerlink" title="1.添加桥接文件"></a>1.添加桥接文件</h2><p>添加一个新的头文件到工程中作为桥接文件，建议命名为 <code>&#123;project_name&#125;-Bridging-Header.h</code>，这里我命名为 SwiftMixedDemo-Bridging-Header.h，如图所示：</p><center>![XCode-Swift-Objective-C-C-C++-1](/images/XCode-Swift-Objective-C-C-C++-1.png)</center><h2 id="2-设置-Objective-C-Bridging-Header"><a href="#2-设置-Objective-C-Bridging-Header" class="headerlink" title="2.设置 Objective-C Bridging Header"></a>2.设置 Objective-C Bridging Header</h2><p>选中工程名，切换到 Build Settings 选项卡，选中 All，在右上角的搜索栏中输入 bridging 找到 <code>Objective-C Bridging Header</code> 一项，并将其设为 <code>&#123;project_name&#125;/&#123;project_name&#125;-Bridging-Header.h</code>，这里我设为 SwiftMixedDemo&#x2F;SwiftMixedDemo-Bridging-Header.h，如图所示：</p><center>![XCode-Swift-Objective-C-C-C++-2](/images/XCode-Swift-Objective-C-C-C++-2.png)</center><h2 id="3-添加-Objective-C-文件"><a href="#3-添加-Objective-C-文件" class="headerlink" title="3.添加 Objective-C 文件"></a>3.添加 Objective-C 文件</h2><p>将需要引入的 Objective-C 文件添加到项目，然后将相应的头文件添加到桥接文件 SwiftMixedDemo-Bridging-Header.h 中：</p><center>![XCode-Swift-Objective-C-C-C++-3](/images/XCode-Swift-Objective-C-C-C++-3.png)</center><p>接下来即可正常调用 Objective-C 文件中的代码。</p><h2 id="4-Swift-调用-C-x2F-C"><a href="#4-Swift-调用-C-x2F-C" class="headerlink" title="4.Swift 调用 C&#x2F;C++"></a>4.Swift 调用 C&#x2F;C++</h2><p>并且 Swift 不能直接调用 C&#x2F;C++，但可以通过调用 Objective-C 代码的方式间接调用 C&#x2F;C++。</p><hr><p>PS：<code>&#123;project_name&#125;</code> 代指工程名。</p><hr><blockquote><p>如有任何知识产权、版权问题或理论错误，还请指正。<br><a href="https://www.eyrefree.org/2015/09/06/XCode-Swift-Objective-C-C-C++">https://www.eyrefree.org/2015/09/06/XCode-Swift-Objective-C-C-C++</a><br>如文中无特殊说明，本站均使用以下协议保护：<a href="http://creativecommons.org/licenses/by-nc-nd/3.0/cn/">署名-非商业性使用-禁止演绎</a>。   </p></blockquote>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Swift </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>在需要兼容 iOS 7.0 及以下的项目中使用 Alamofire</title>
      <link href="/2015/08/14/iOS7-Alamofire/"/>
      <url>/2015/08/14/iOS7-Alamofire/</url>
      
        <content type="html"><![CDATA[<p>Alamofire 是 iOS 和 OS X 上最受欢迎的第三方库之一，它在 <a href="https://github.com/Alamofire/Alamofire">Github</a> 上面获得了 15638 个 stars 和2304 个 forks，是使用最广的开源项目之一。</p><hr><h1 id="1-官方描述"><a href="#1-官方描述" class="headerlink" title="1.官方描述"></a>1.官方描述</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Embedded frameworks require a minimum deployment target of iOS 8 or OS X Mavericks.</span><br><span class="line">To use Alamofire with a project targeting iOS 7, you must include all Swift files located inside the Source directory directly in your project. See the ‘Source File’ section for additional instructions.</span><br></pre></td></tr></table></figure><p>官方文档指出在需要兼容 iOS 7 的项目中一定要包含所有 Alamofire 源文件。</p><h1 id="2-添加方法"><a href="#2-添加方法" class="headerlink" title="2.添加方法"></a>2.添加方法</h1><h2 id="1-添加-Alamofire-子模块"><a href="#1-添加-Alamofire-子模块" class="headerlink" title="1.添加 Alamofire 子模块"></a>1.添加 Alamofire 子模块</h2><p>首先添加 submodule，将 Alamofire 作为当前项目的一个子模块：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#添加子模块：</span></span><br><span class="line">git submodule add https://github.com/Alamofire/Alamofire.git Alamofire</span><br><span class="line"><span class="comment">#初始化子模块：</span></span><br><span class="line">git submodule init</span><br><span class="line"><span class="comment">#更新子模块：</span></span><br><span class="line">git submodule update</span><br></pre></td></tr></table></figure><h2 id="2-添加源文件到工程"><a href="#2-添加源文件到工程" class="headerlink" title="2.添加源文件到工程"></a>2.添加源文件到工程</h2><p>将 Alamofire 目录下的 Source 目录中的所有 <code>.swift</code> 文件以引用方式添加到项目中去，如图所示：</p><center>![iOS7-Alamofire-1](/images/iOS7-Alamofire-1.png)</center><h1 id="3-调用方法"><a href="#3-调用方法" class="headerlink" title="3.调用方法"></a>3.调用方法</h1><p>直接调用方法即可，不需要通过 <code>Alamofire.</code> 前缀，如图所示：</p><center>![iOS7-Alamofire-2](/images/iOS7-Alamofire-2.png)</center><hr><blockquote><p>如有任何知识产权、版权问题或理论错误，还请指正。<br><a href="https://www.eyrefree.org/2015/08/14/iOS7-Alamofire">https://www.eyrefree.org/2015/08/14/iOS7-Alamofire</a><br>如文中无特殊说明，本站均使用以下协议保护：<a href="http://creativecommons.org/licenses/by-nc-nd/3.0/cn/">署名-非商业性使用-禁止演绎</a>。   </p></blockquote>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Alamofire </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iOS 设置 Launch Image 启动图片</title>
      <link href="/2015/06/01/iOS-LaunchImage/"/>
      <url>/2015/06/01/iOS-LaunchImage/</url>
      
        <content type="html"><![CDATA[<h1 id="1、添加图片资源"><a href="#1、添加图片资源" class="headerlink" title="1、添加图片资源"></a>1、添加图片资源</h1><p>打开工程，进入 <code>Images.xcassets</code>，出现图片资源列表，对列表空白处右击单击，在弹出菜单中选择 <code>New Launch Image</code>，出现 <code>LaunchImage</code> 的空文件夹，按要求添加若干尺寸的 Launch 图片：</p><center>![iOS-LaunchImage-1](/images/iOS-LaunchImage-1.jpg)</center> # 2、修改工程设置选中工程名，然后在 Targets 中再次选中，接着选择 General，找到 `App Icons and Launch Images`，将第二项 `Launch Image Source` 设为第一步中创建的 LaunchImage，将第三项 `Launch Screen File` 设为空即可。<center>![iOS-LaunchImage-2](/images/iOS-LaunchImage-2.jpg)</center><p>接下来 Run 一下工程，启动 App 时就可以出现我们上面设置的启动图片啦，😊</p><hr><blockquote><p>如有任何知识产权、版权问题或理论错误，还请指正。<br><a href="https://www.eyrefree.org/2015/06/01/iOS-LaunchImage">https://www.eyrefree.org/2015/06/01/iOS-LaunchImage</a><br>如文中无特殊说明，本站均使用以下协议保护：<a href="http://creativecommons.org/licenses/by-nc-nd/3.0/cn/">署名-非商业性使用-禁止演绎</a>。   </p></blockquote>]]></content>
      
      
      <categories>
          
          <category> iOS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Nothing </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WordPress 使用笔记</title>
      <link href="/2015/05/31/WordPress-Notes/"/>
      <url>/2015/05/31/WordPress-Notes/</url>
      
        <content type="html"><![CDATA[<p>最近在看一些有意思的东西，想要写一些笔记作为记录，时间久了不记得了还可以回头来看看。然后其实本来是用 CSDN 博客的，但是不知道为啥米（正文加了链接？），最近每次修改或者发布都需要审核（不嗨森），然后就想自己搭一个玩一下，嗯，酱紫！<br> <br>买了国内某服务器发现需要备案（然后百度了一下发现别人都是备好了案才买服务器的，年少无知，囧），然后备好了案发现域名服务提供商还不提供域名隐私保护（不支持.org的为虾米，不嗨森），好了不管了，反正填的资料真真假假的，233333，开始玩弄 WP 吧。 </p><h1 id="1、选择主题"><a href="#1、选择主题" class="headerlink" title="1、选择主题"></a>1、选择主题</h1><p>首先，挑一个好看（或者自认为好看）的主题（什么，你问主题在哪里？外观-&gt;主题-&gt;添加 哟，是不是一下子粗来好多~，嘛，要是没出来好多，或者出来好多边框和标题但是没有看到缩略图的话，您可能需要一个梯子，别问我什么是梯子，我不懂，0_o）。 </p><h1 id="2、设置用户头像"><a href="#2、设置用户头像" class="headerlink" title="2、设置用户头像"></a>2、设置用户头像</h1><p>主题换好以后，发现用户头像那里是空的耶（或者是个占位图？总之好蓝看）。默认情况下用户头像是木有的（可能是由于模板的原因？反正我的没有，有的话请跳过本步骤），这时候我们可以使用一个叫 Simple Local Avatar 的插件来实现添加用户头像的功能（插件-&gt;安装插件-&gt;搜索），安装完插件并且开启后就会在 用户-&gt;个人资料 中出现 Avatar 的选项，选择自己喜欢的头像图片上传即可。 </p><h1 id="3、添加友链"><a href="#3、添加友链" class="headerlink" title="3、添加友链"></a>3、添加友链</h1><p>嗯，接下来就是把几个中二病的博客链接加到友情链接里面去啦，默认情况下友情链接也是木有的（同上，有的话请跳过本步骤），这时候我们可以使用一个叫 Link Manager 的插件来实现添加友情链接的功能，插件安装完成并且开启后在控制面板（或者叫后台？）的菜单项中会出现 链接 一栏，然后点进去就可以给博客加友链了，是不是很简单！ </p><h1 id="4、去除-Google-相关引用"><a href="#4、去除-Google-相关引用" class="headerlink" title="4、去除 Google 相关引用"></a>4、去除 Google 相关引用</h1><p>嗯，针对一般的主题设置上面这些应该已经差不多了，但是，由于 WP 的主题大部分作者是国外的，所以中间可能有些主题使用了谷歌字体或者谷歌地图之类的谷歌 API （很不幸，我使用的这个主题就使用了大量的这类东东，蓝后打开的时候死慢死慢的），简单地看了一下他人的解决办法，有使用 Disable Google Fonts 和 Disable Google Maps 这类插件来解提速的，大家可以试试，反正我用了还是慢得要shi（可能是还有其他 Google 的东东在里面？），然后用了比较原始但有效的方法：将网站整站打包下载然后用 Sublime Text 搜索所有包含 googleapis 的行，然后注释掉它们就可以了（嘛，貌似工作量略大，而且修改的时候要记住编码方式要和原来的文件一样，同时请童鞋们注意：主题升级以后会恢复原样，所以升级主题时请慎重！）</p><center>![WordPress-Notes-1](/images/WordPress-Notes-1.jpg)</center> # 5、博客提速<p>第4步完成以后，博客的访问速度已经得到了很大程度的提升，如果在此基础上安装一个名为 WP Super Cache 可能（“可能”是什么么鬼…）会使速度进一步提升（关于这个插件的详细信息可以参考<a href="http://plugins.wopus.org/best-plugin/242.html">WP Super Cache使用全攻略</a>）。 </p><h1 id="6、添加邮件通知"><a href="#6、添加邮件通知" class="headerlink" title="6、添加邮件通知"></a>6、添加邮件通知</h1><p>然后 WP 默认是没有开启邮件发送功能的， WP SMTP 这款插件可以帮助我们实现“邮件通知”、“用户注册邮件发送”等一些列与电子邮件服务相关的功能，只需要简单设置邮件服务器等参数即可（关于这个插件的详细信息可以参考<a href="http://www.wpdaxue.com/wordpress-smtp-email.html">WordPress SMTP发送邮件插件：WP SMTP</a>）。 </p><h1 id="7、反恶意注册"><a href="#7、反恶意注册" class="headerlink" title="7、反恶意注册"></a>7、反恶意注册</h1><p>开启了注册功能以后，遇到大量恶意注册，大量用户名是随机字符串的雅虎邮箱申请注册，尝试在注册页面加了验证码，具体方法可以参考<a href="http://www.ludou.org/wordpress-ludou-custom-user-register.html">WordPress自定义用户注册页面插件</a>、<a href="http://www.zhiyanblog.com/wordpress-si-captcha-anti-spam-plugin.html">WordPress评论、注册、登录验证码</a>、<a href="http://www.diandidao.com/573.html">wordpress受到恶意注册，注册登录页面增加验证码</a>，这几款插件都能有效阻止此类恶意行为。</p><center>![WordPress-Notes-2](/images/WordPress-Notes-2.jpg)</center> 未完待续，QAQ<hr><p>2016 年 3 月 28 日续：<br>最近用 Hexo 搭建了自己的纯静态博客来代替 WordPress，然后在把原来的博客迁移过来，😌。</p><hr><blockquote><p>如有任何知识产权、版权问题或理论错误，还请指正。<br><a href="https://www.eyrefree.org/2015/05/31/WordPress-Notes">https://www.eyrefree.org/2015/05/31/WordPress-Notes</a><br>如文中无特殊说明，本站均使用以下协议保护：<a href="http://creativecommons.org/licenses/by-nc-nd/3.0/cn/">署名-非商业性使用-禁止演绎</a>。   </p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Blog </category>
          
      </categories>
      
      
        <tags>
            
            <tag> WordPress </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Git 常用命令</title>
      <link href="/2015/04/09/Git-Commands/"/>
      <url>/2015/04/09/Git-Commands/</url>
      
        <content type="html"><![CDATA[<p>Git 常用命令备忘</p><hr><h2 id="SubModule"><a href="#SubModule" class="headerlink" title="SubModule"></a>SubModule</h2><h3 id="1-获取所有-SubModule"><a href="#1-获取所有-SubModule" class="headerlink" title="1. 获取所有 SubModule"></a>1. 获取所有 SubModule</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git submodule update --init --recursive</span><br></pre></td></tr></table></figure><h3 id="2-删除某个-SubModule"><a href="#2-删除某个-SubModule" class="headerlink" title="2. 删除某个 SubModule"></a>2. 删除某个 SubModule</h3><p>例如：submodule_xxx</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git submodule deinit submodule_xxx</span><br><span class="line">git <span class="built_in">rm</span> submodule_xxx</span><br><span class="line"><span class="built_in">rm</span> -rf .git/modules/submodule_xxx</span><br></pre></td></tr></table></figure><h2 id="Tag"><a href="#Tag" class="headerlink" title="Tag"></a>Tag</h2><h3 id="1-添加-Tag-并上传本地-Tag-到服务器"><a href="#1-添加-Tag-并上传本地-Tag-到服务器" class="headerlink" title="1. 添加 Tag 并上传本地 Tag 到服务器"></a>1. 添加 Tag 并上传本地 Tag 到服务器</h3><p>例如：2.333</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git tag -a 2.333 -m <span class="string">&quot;2.333 版本的备注信息.&quot;</span></span><br><span class="line">git push origin --tags</span><br></pre></td></tr></table></figure><h3 id="2-删除本地-Tag-并同步到远程"><a href="#2-删除本地-Tag-并同步到远程" class="headerlink" title="2. 删除本地 Tag 并同步到远程"></a>2. 删除本地 Tag 并同步到远程</h3><p>例如：2.333</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git tag -d 2.333</span><br><span class="line">git push origin :refs/tags/2.333</span><br></pre></td></tr></table></figure><h2 id="Branch"><a href="#Branch" class="headerlink" title="Branch"></a>Branch</h2><h3 id="1-查看所有分支"><a href="#1-查看所有分支" class="headerlink" title="1. 查看所有分支"></a>1. 查看所有分支</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git branch</span><br></pre></td></tr></table></figure><h3 id="2-同步本地与远程分支"><a href="#2-同步本地与远程分支" class="headerlink" title="2. 同步本地与远程分支"></a>2. 同步本地与远程分支</h3><p>删除远程不存在的本地分支</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git fetch -p</span><br></pre></td></tr></table></figure><h2 id="Commit"><a href="#Commit" class="headerlink" title="Commit"></a>Commit</h2><h3 id="1-合并本地的最后两次-Commit"><a href="#1-合并本地的最后两次-Commit" class="headerlink" title="1. 合并本地的最后两次 Commit"></a>1. 合并本地的最后两次 Commit</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git reset --soft HEAD^git commit --amend</span><br></pre></td></tr></table></figure><h3 id="2-修改上一次的-Commit-信息"><a href="#2-修改上一次的-Commit-信息" class="headerlink" title="2. 修改上一次的 Commit 信息"></a>2. 修改上一次的 Commit 信息</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git commit --amend</span><br></pre></td></tr></table></figure><h3 id="3-撤销所有未提交的本地修改"><a href="#3-撤销所有未提交的本地修改" class="headerlink" title="3. 撤销所有未提交的本地修改"></a>3. 撤销所有未提交的本地修改</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git add -A</span><br><span class="line">git checkout .</span><br><span class="line">git cehckout -f</span><br></pre></td></tr></table></figure><h2 id="Remote"><a href="#Remote" class="headerlink" title="Remote"></a>Remote</h2><h3 id="1-删除远程仓库地址"><a href="#1-删除远程仓库地址" class="headerlink" title="1. 删除远程仓库地址"></a>1. 删除远程仓库地址</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git remote remove origin</span><br></pre></td></tr></table></figure><h3 id="2-添加远程仓库地址"><a href="#2-添加远程仓库地址" class="headerlink" title="2. 添加远程仓库地址"></a>2. 添加远程仓库地址</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git remote add origin https://git.coding.net/eyrefree/xxx.git</span><br></pre></td></tr></table></figure><h3 id="3-Push-本地分支到指定远程分支"><a href="#3-Push-本地分支到指定远程分支" class="headerlink" title="3. Push 本地分支到指定远程分支"></a>3. Push 本地分支到指定远程分支</h3><p>例如：Push 本地当前分支到远程仓库 origin 的 master 分支</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git push -u origin master</span><br></pre></td></tr></table></figure><h2 id="Other"><a href="#Other" class="headerlink" title="Other"></a>Other</h2><h3 id="1-设置本地用户名、邮箱"><a href="#1-设置本地用户名、邮箱" class="headerlink" title="1. 设置本地用户名、邮箱"></a>1. 设置本地用户名、邮箱</h3><p>例如：设置用户名为 eyrefree，邮箱为 <a href="mailto:&#x65;&#x79;&#114;&#101;&#x66;&#114;&#101;&#101;&#x40;&#x65;&#x79;&#x72;&#101;&#102;&#114;&#x65;&#x65;&#46;&#111;&#114;&#x67;">&#x65;&#x79;&#114;&#101;&#x66;&#114;&#101;&#101;&#x40;&#x65;&#x79;&#x72;&#101;&#102;&#114;&#x65;&#x65;&#46;&#111;&#114;&#x67;</a></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git config --global user.name <span class="string">&quot;eyrefree&quot;</span> git config --global user.email eyrefree@eyrefree.org</span><br></pre></td></tr></table></figure><h2 id="PS"><a href="#PS" class="headerlink" title="PS"></a>PS</h2><p>最后，转载一张觉得挺棒的图片：</p><p><img src="/images/git.png"></p><hr><p>更多 Git 常用命令可参考：<a href="http://www.ruanyifeng.com/blog/2015/12/git-cheat-sheet.html">常用 Git 命令清单</a><br>或查阅官方文档：<a href="https://git-scm.com/book/zh/v2">Pro Git book</a></p><hr><blockquote><p>如有任何知识产权、版权问题或理论错误，还请指正。<br><a href="https://www.eyrefree.org/2015/04/09/Git-Commands">https://www.eyrefree.org/2015/04/09/Git-Commands</a><br>如文中无特殊说明，本站均使用以下协议保护：<a href="http://creativecommons.org/licenses/by-nc-nd/3.0/cn/">署名-非商业性使用-禁止演绎</a>。   </p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Git </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Nothing </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Windows 7 下 QT 5.1.1 for Android 开发环境的搭建与配置</title>
      <link href="/2013/11/08/Windows7-QT-Android/"/>
      <url>/2013/11/08/Windows7-QT-Android/</url>
      
        <content type="html"><![CDATA[<p>Qt 是诺基亚开发的一个跨平台的 C++ 图形用户界面应用程序框架，对于一些想要开发 Android 的应用但是又不想学习 Java 的开发人员而言，Qt 是一个很好选择。</p><p>本次使用的操作系统为 Windows 7 64 位，用的是 32 位的安装包，32 位系统没有验证过。  </p><hr><h1 id="一、下载安装包"><a href="#一、下载安装包" class="headerlink" title="一、下载安装包"></a>一、下载安装包</h1><p>首先下载以下安装包，如果提供的链接失效请自行下载：</p><p>（1）Android SDK （Windows 32-bit ADT版）：</p><p>【直接下载】<a href="http://dl.google.com/android/adt/adt-bundle-windows-x86-20131030.zip">http://dl.google.com/android/adt/adt-bundle-windows-x86-20131030.zip</a></p><p>（2）Android NDK（Windows 32-bit）：</p><p>【直接下载】<a href="http://dl.google.com/android/ndk/android-ndk-r9b-windows-x86.zip">http://dl.google.com/android/ndk/android-ndk-r9b-windows-x86.zip</a></p><p>（3）Java JDK（Windows 32-bit）：</p><p>【手动下载】<a href="http://www.oracle.com/technetwork/java/javase/downloads/jdk7-downloads-1880260.html">http://www.oracle.com/technetwork/java/javase/downloads/jdk7-downloads-1880260.html</a></p><p>（4）Apache-Ant：</p><p>【直接下载】<a href="http://mirrors.cnnic.cn/apache//ant/binaries/apache-ant-1.9.2-bin.zip">http://mirrors.cnnic.cn/apache//ant/binaries/apache-ant-1.9.2-bin.zip</a></p><p>（5）QT 5.1.1 for Android （Windows 32-bit  离线版）：</p><p>【直接下载】<a href="http://mirrors.hustunique.com/qt/official_releases/qt/5.1/5.1.1/qt-windows-opensource-5.1.1-android-x86-win32-offline.exe">http://mirrors.hustunique.com/qt/official_releases&#x2F;qt&#x2F;5.1&#x2F;5.1.1&#x2F;qt-windows-opensource-5.1.1-android-x86-win32-offline.exe</a>  </p><h1 id="二、安装包的解压与安装"><a href="#二、安装包的解压与安装" class="headerlink" title="二、安装包的解压与安装"></a>二、安装包的解压与安装</h1><p>接下来解压、安装下载好的各安装包：</p><p>（1）Android SDK：【解压】解压到  D:\ADT 目录下<br>（2）Android NDK：【解压】解压到 D:\NDK 目录下<br>（3）Java JDK（Windows 35-bit）：【安装】安装过程中有两次要选择安装路径，注意请根据自己安装的版本自行修改，后面设置环境变量需要用到，这里我第一次填写：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">D:\Java\jdk1.7.0_45  </span><br></pre></td></tr></table></figure><p>第二次填写：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">D:\Java\jre7  </span><br></pre></td></tr></table></figure><p>（4）Apache-Ant：【解压】解压到 D:\ANT 目录下<br>（5）QT 5.1.1 for Android（Windows 35-bit 离线版）：【安装】安装到 D:\QT 目录下  </p><h1 id="三、设置环境变量"><a href="#三、设置环境变量" class="headerlink" title="三、设置环境变量"></a>三、设置环境变量</h1><p>根据第二步中的相关路径，设置系统环境变量：  </p><h2 id="1，添加新的环境变量"><a href="#1，添加新的环境变量" class="headerlink" title="1，添加新的环境变量"></a>1，添加新的环境变量</h2><p>右键单击 我的电脑 -&gt; 属性 -&gt; 高级系统设置 -&gt; 环境变量，在系统变量中新建以下变量：</p><p>（1）变量名：JAVA_HOME，变量值：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">D:\Java\jdk1.7.0_45  </span><br></pre></td></tr></table></figure><p>（2）变量名：CLASSPATH，变量值：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.;%JAVA_HOME%\lib;%JAVA_HOME%\lib\tools.jar;  </span><br></pre></td></tr></table></figure><p>【注意最前面的点号 . 和最后面的分号 ; 不能漏掉】<br>（3）变量名：ANDROID_SDK_HOME，变量值：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">D:\ADT\sdk\  </span><br></pre></td></tr></table></figure><p>（4）变量名：ANT_HOME，变量值：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">D:\ANT  </span><br></pre></td></tr></table></figure><h2 id="2，修改系统变量"><a href="#2，修改系统变量" class="headerlink" title="2，修改系统变量"></a>2，修改系统变量</h2><p>在系统变量里找到变量 Path ，选择”编辑“，在最后面添加：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">%JAVA_HOME%\bin;%JAVA_HOME%\jre\bin;%ANDROID_SDK_HOME%;  </span><br></pre></td></tr></table></figure><p>【注意最后面的分号 ; 不能漏掉】  </p><center>![Windows7-QT-Android-1](/images/Windows7-QT-Android-1.jpeg)</center><h1 id="四、Qt-Creator-设置"><a href="#四、Qt-Creator-设置" class="headerlink" title="四、Qt Creator 设置"></a>四、Qt Creator 设置</h1><p>打开Qt Creator，单击 工具 -&gt; 选项，出现选项界面后选择 Android，分别做如下设置：</p><p>（1）Android-SDK的路径：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">D:\ADT\sdk  </span><br></pre></td></tr></table></figure><p>（2）Android NDK的路径：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">D:\NDK  </span><br></pre></td></tr></table></figure><p>（3）ANT的路径： </p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">D:\ANT\bin\ant.bat  </span><br></pre></td></tr></table></figure><p>（4）JDK location：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">D:\Java\jdk1.7.0_45  </span><br></pre></td></tr></table></figure><center>![Windows7-QT-Android-2](/images/Windows7-QT-Android-2.jpeg)</center><h1 id="五、添加虚拟机"><a href="#五、添加虚拟机" class="headerlink" title="五、添加虚拟机"></a>五、添加虚拟机</h1><p>单击 启动Android AVD管理器，出现Android Virtual Device Manager界面，单击 New 创建一个Android虚拟设备。</p><center>![Windows7-QT-Android-3](/images/Windows7-QT-Android-3.jpeg)</center><h1 id="六、建立测试工程"><a href="#六、建立测试工程" class="headerlink" title="六、建立测试工程"></a>六、建立测试工程</h1><p>经过以上这些步骤，开发环境基本配置完成，接下来我们建立一个简单的工程来验证配置是否正确：</p><p>（1）重新打开Qt Creator，选择 文件 -&gt; 新建文件或项目，出现项目创建向导，选择 QT Gui 应用：  </p><center>![Windows7-QT-Android-4](/images/Windows7-QT-Android-4.jpeg)</center><p>（2）然后下一步，工程路径任选。<br>【但是切记，绝对不要在路径内包含任何空格，这里我使用的是D:\QT-WorkSpace，否则会出现各种意想不到的编译错误！】<br>（3）然后下一步，选择 Android for arm：  </p><center>![Windows7-QT-Android-5](/images/Windows7-QT-Android-5.jpeg)</center><p>（4）后面的信息暂时不需要过多关注，直接下一步即可，直至完成项目创建。  </p><center>![Windows7-QT-Android-6](/images/Windows7-QT-Android-6.jpeg)</center><p>（5）项目创建完毕后，右键 项目，选择 构建，若成功则继续下一步，否则请对照上文寻找可能的出错步骤进行相应修改或返回本文开头尝试重新开始配置过程。  </p><center>![Windows7-QT-Android-7](/images/Windows7-QT-Android-7.jpeg)</center><p>（6）项目构建成功后，右键<br>项目，选择 运行，Android虚拟设备将会自动打开，启动过程过程较慢，耐心等候。<br>（7）若无意外，将会成功运行该空项目生成的apk，因为这里是个空的项目，什么也没写，所以当然什么也没有，效果如图，表明环境配置成功。  </p><center>![Windows7-QT-Android-8](/images/Windows7-QT-Android-8.jpeg)</center><hr><p>到这里就应该已经完成了，接下来可以使用 C++ 动手开始 QT for Android 开发了，😝。</p><hr><blockquote><p>如有任何知识产权、版权问题或理论错误，还请指正。<br><a href="https://www.eyrefree.org/2013/11/08/Windows7-QT-Android">https://www.eyrefree.org/2013/11/08/Windows7-QT-Android</a><br>如文中无特殊说明，本站均使用以下协议保护：<a href="http://creativecommons.org/licenses/by-nc-nd/3.0/cn/">署名-非商业性使用-禁止演绎</a>。   </p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Environment </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Qt </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
