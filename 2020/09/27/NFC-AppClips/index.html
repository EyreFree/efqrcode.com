<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="Apple 在 WWDC2020 推出 App Clips 之后引起了不少相关的讨论，很多同学对这种 iOS 平台的 小程序 感到很好奇，下面我们就来看看如何通过 NFC 标签来唤起 App Clips 吧。 NFC 简介NFC 是 Near Field Communication 的首字母缩写，即近场通信，也被称为近距离无线通信，是一种短距离的高频无线通信技术，通过在单一芯片上集成感应式读卡器、">
<meta property="og:type" content="article">
<meta property="og:title" content="如何实现通过 NFC 标签唤起 App Clips">
<meta property="og:url" content="http://www.efqrcode.com/2020/09/27/NFC-AppClips/index.html">
<meta property="og:site_name" content="EyreFree">
<meta property="og:description" content="Apple 在 WWDC2020 推出 App Clips 之后引起了不少相关的讨论，很多同学对这种 iOS 平台的 小程序 感到很好奇，下面我们就来看看如何通过 NFC 标签来唤起 App Clips 吧。 NFC 简介NFC 是 Near Field Communication 的首字母缩写，即近场通信，也被称为近距离无线通信，是一种短距离的高频无线通信技术，通过在单一芯片上集成感应式读卡器、">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://www.efqrcode.com/images/NFC-AppClips-1.jpg">
<meta property="og:image" content="http://www.efqrcode.com/images/NFC-AppClips-2.jpg">
<meta property="og:image" content="http://www.efqrcode.com/images/NFC-AppClips-3.jpg">
<meta property="og:image" content="http://www.efqrcode.com/images/NFC-AppClips-4.jpg">
<meta property="og:image" content="http://www.efqrcode.com/images/NFC-AppClips-5.png">
<meta property="og:image" content="http://www.efqrcode.com/images/NFC-AppClips-6.png">
<meta property="og:image" content="http://www.efqrcode.com/images/NFC-AppClips-7.jpg">
<meta property="og:image" content="http://www.efqrcode.com/images/NFC-AppClips-8.png">
<meta property="og:image" content="http://www.efqrcode.com/images/NFC-AppClips-9.png">
<meta property="og:image" content="http://www.efqrcode.com/images/NFC-AppClips-10.jpg">
<meta property="og:image" content="http://www.efqrcode.com/images/NFC-AppClips-11.jpg">
<meta property="article:published_time" content="2020-09-27T07:00:00.000Z">
<meta property="article:modified_time" content="2021-09-25T08:23:41.243Z">
<meta property="article:author" content="EyreFree">
<meta property="article:tag" content="Swift">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://www.efqrcode.com/images/NFC-AppClips-1.jpg">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>如何实现通过 NFC 标签唤起 App Clips</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 6.2.0"><link rel="alternate" href="/atom.xml" title="EyreFree" type="application/atom+xml">
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="目录"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="目录"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="顶部" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">首页</a></li><!--
     --><!--
       --><li><a href="/archives/">归档</a></li><!--
     --><!--
       --><li><a href="/categories/">分类</a></li><!--
     --><!--
       --><li><a href="/tags/">标签</a></li><!--
     --><!--
       --><li><a href="/about/">关于</a></li><!--
     --><!--
       --><li><a href="/search/">搜索</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="上一篇" href="/2020/11/17/Flutter-Bitcode/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="下一篇" href="/2019/10/17/CocoaPods-Flutter-CDN/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="返回顶部" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="分享文章" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">上一篇</span>
      <span id="i-next" class="info" style="display:none;">下一篇</span>
      <span id="i-top" class="info" style="display:none;">返回顶部</span>
      <span id="i-share" class="info" style="display:none;">分享文章</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://www.efqrcode.com/2020/09/27/NFC-AppClips/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://www.efqrcode.com/2020/09/27/NFC-AppClips/&text=如何实现通过 NFC 标签唤起 App Clips"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://www.efqrcode.com/2020/09/27/NFC-AppClips/&title=如何实现通过 NFC 标签唤起 App Clips"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://www.efqrcode.com/2020/09/27/NFC-AppClips/&is_video=false&description=如何实现通过 NFC 标签唤起 App Clips"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=如何实现通过 NFC 标签唤起 App Clips&body=Check out this article: http://www.efqrcode.com/2020/09/27/NFC-AppClips/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://www.efqrcode.com/2020/09/27/NFC-AppClips/&title=如何实现通过 NFC 标签唤起 App Clips"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://www.efqrcode.com/2020/09/27/NFC-AppClips/&title=如何实现通过 NFC 标签唤起 App Clips"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://www.efqrcode.com/2020/09/27/NFC-AppClips/&title=如何实现通过 NFC 标签唤起 App Clips"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://www.efqrcode.com/2020/09/27/NFC-AppClips/&title=如何实现通过 NFC 标签唤起 App Clips"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://www.efqrcode.com/2020/09/27/NFC-AppClips/&name=如何实现通过 NFC 标签唤起 App Clips&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://www.efqrcode.com/2020/09/27/NFC-AppClips/&t=如何实现通过 NFC 标签唤起 App Clips"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#NFC-%E7%AE%80%E4%BB%8B"><span class="toc-number">1.</span> <span class="toc-text">NFC 简介</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E8%B5%B7%E6%BA%90"><span class="toc-number">1.1.</span> <span class="toc-text">1. 起源</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%8E%9F%E7%90%86"><span class="toc-number">1.2.</span> <span class="toc-text">2. 原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%BA%94%E7%94%A8"><span class="toc-number">1.3.</span> <span class="toc-text">3. 应用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%94%AF%E4%BB%98%E5%BA%94%E7%94%A8"><span class="toc-number">1.3.1.</span> <span class="toc-text">支付应用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E9%98%B2%E5%BA%94%E7%94%A8"><span class="toc-number">1.3.2.</span> <span class="toc-text">安防应用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%87%E7%AD%BE%E5%BA%94%E7%94%A8"><span class="toc-number">1.3.3.</span> <span class="toc-text">标签应用</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#App-Clips-%E5%88%9B%E5%BB%BA"><span class="toc-number">2.</span> <span class="toc-text">App Clips 创建</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E5%92%8C%E8%AE%BE%E5%A4%87"><span class="toc-number">2.1.</span> <span class="toc-text">1. 开发环境和设备</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%88%9B%E5%BB%BA-App-Clip-Target"><span class="toc-number">2.2.</span> <span class="toc-text">2. 创建 App Clip Target</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-apple-app-site-association"><span class="toc-number">2.3.</span> <span class="toc-text">3. apple-app-site-association</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-Hello-World"><span class="toc-number">2.4.</span> <span class="toc-text">4. Hello World</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E6%B7%BB%E5%8A%A0%E4%BB%A3%E7%A0%81%E8%8E%B7%E5%8F%96%E5%94%A4%E8%B5%B7-Clip-%E7%9A%84-URL"><span class="toc-number">2.5.</span> <span class="toc-text">5. 添加代码获取唤起 Clip 的 URL</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#App-Clip-%E7%9A%84-NFC-%E5%94%A4%E8%B5%B7"><span class="toc-number">3.</span> <span class="toc-text">App Clip 的 NFC 唤起</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%88%B6%E5%A4%87-NFC-%E6%A0%87%E7%AD%BE"><span class="toc-number">3.1.</span> <span class="toc-text">1. 制备 NFC 标签</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%94%A4%E8%B5%B7-Clip"><span class="toc-number">3.2.</span> <span class="toc-text">2. 唤起 Clip</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%8E%E8%AE%B0"><span class="toc-number">4.</span> <span class="toc-text">后记</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        如何实现通过 NFC 标签唤起 App Clips
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">EyreFree</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2020-09-27T07:00:00.000Z" itemprop="datePublished">2020-09-27</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fas fa-archive"></i>
        <a class="category-link" href="/categories/iOS/">iOS</a>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/tags/Swift/" rel="tag">Swift</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p>Apple 在 WWDC2020 推出 App Clips 之后引起了不少相关的讨论，很多同学对这种 iOS 平台的 <code>小程序</code> 感到很好奇，下面我们就来看看如何通过 NFC 标签来唤起 App Clips 吧。</p>
<h2 id="NFC-简介"><a href="#NFC-简介" class="headerlink" title="NFC 简介"></a>NFC 简介</h2><p>NFC 是 Near Field Communication 的首字母缩写，即近场通信，也被称为近距离无线通信，是一种短距离的高频无线通信技术，通过在单一芯片上集成感应式读卡器、感应式卡片和点对点通信的功能，利用移动设备实现移动支付、电子票务、门禁、移动身份识别、防伪等功能。</p>
<p><img src="/images/NFC-AppClips-1.jpg" alt="一种 NFC 标签"></p>
<h3 id="1-起源"><a href="#1-起源" class="headerlink" title="1. 起源"></a>1. 起源</h3><p>大约在 2003 年，索尼公司和飞利浦半导体（现为恩智浦 NXP 半导体）进行合作，计划基于 RFID 研发一种更加安全快捷并且能与之兼容的无线通讯技术，不久后双方联合对外发布了一种兼容 IS014443 非接触式卡协议的无线通讯技术，取名为 NFC，具体通信规范称作 <a target="_blank" rel="noopener" href="https://www.ecma-international.org/publications/files/ECMA-ST/ECMA-340.pdf">NFCIP-1</a> 规范。随后，索尼、飞利浦与诺基亚一起，创建 NFC 论坛，开始推广 NFC 的应用。</p>
<h3 id="2-原理"><a href="#2-原理" class="headerlink" title="2. 原理"></a>2. 原理</h3><p>NFC 是一种短距高频的无线电技术，NFCIP-1 标准规定 NFC 的通信距离为 10 厘米以内，运行频率 13.56 MHz，传输速度有106 Kbit&#x2F;s、212 Kbit&#x2F;s 或者 424 Kbit&#x2F;s 三种。NFCIP-1 标准详细规定 NFC 设备的传输速度、编解码方法、调制方案以及射频接口的帧格式，此标准中还定义了 NFC 的传输协议，其中包括启动协议和数据交换方法等。</p>
<p>NFC 工作模式分为被动模式和主动模式：</p>
<ul>
<li>被动模式</li>
</ul>
<p>NFC 发起设备（也称为主设备）利用供电设备的能量来提供射频场，并将数据发送到 NFC 目标设备（也称作从设备）。根据电磁感应原理，从设备利用主设备产生的射频场转换为电能，为从设备的电路供电，接收主设备发送的数据，并且以相同的速度将从设备数据传回主设备。</p>
<ul>
<li>主动模式</li>
</ul>
<p>发起设备和目标设备在向对方发送数据时，都必须主动产生射频场，所以称为主动模式，它们都需要供电设备来提供产生射频场的能量。这种通信模式可以获得非常快速的连接速率。</p>
<h3 id="3-应用"><a href="#3-应用" class="headerlink" title="3. 应用"></a>3. 应用</h3><h4 id="支付应用"><a href="#支付应用" class="headerlink" title="支付应用"></a>支付应用</h4><p>NFC 支付主要是指带有 NFC 功能的手机虚拟成银行卡、一卡通等的应用。</p>
<p><img src="/images/NFC-AppClips-2.jpg" alt="地铁、公交"></p>
<h4 id="安防应用"><a href="#安防应用" class="headerlink" title="安防应用"></a>安防应用</h4><p>NFC 安防的应用主要是将手机虚拟成门禁卡、电子门票等。 NFC 虚拟门禁卡就是将现有的门禁卡数据写入手机的 NFC，使用手机就可以实现门禁功能，门禁的配置、监控和修改等都会变得十分方便，而且可以实现远程修改和配置，例如在需要时临时分发凭证卡等。 </p>
<p><img src="/images/NFC-AppClips-3.jpg" alt="门禁卡"></p>
<h4 id="标签应用"><a href="#标签应用" class="headerlink" title="标签应用"></a>标签应用</h4><p>NFC 标签应用就是把一些信息写入一个 NFC 标签内， 用户只需用 NFC 手机或准备好的设备在 NFC 标签上挥一挥就可以立即获得相关的信息。例如商家可以把含有海报、促销信息、广告的 NFC 标签放在店门口，用户可以根据自己的需求用NFC手机获取相关的信息。</p>
<p><img src="/images/NFC-AppClips-4.jpg" alt="amiibo"></p>
<h2 id="App-Clips-创建"><a href="#App-Clips-创建" class="headerlink" title="App Clips 创建"></a>App Clips 创建</h2><p>唔，这里以 <a target="_blank" rel="noopener" href="https://github.com/EFPrefix/EFQRCode/tree/appclips">EFQRCode</a> 的 iOS Demo 为例进行演示。</p>
<h3 id="1-开发环境和设备"><a href="#1-开发环境和设备" class="headerlink" title="1. 开发环境和设备"></a>1. 开发环境和设备</h3><p>首先请安装好 Xcode 12，然后请准备一台已经升级到 iOS 14 的<a target="_blank" rel="noopener" href="https://www.bluebite.com/nfc/iphone-nfc-compatibility">支持 NFC 的 iOS 设备</a>用于测试，我这里是用的是 iPhone X。</p>
<table>
<thead>
<tr>
<th align="right"></th>
<th align="center">Has NFC</th>
<th align="center">Card Emulation</th>
<th align="center">NFC Payments</th>
<th align="center">Reads NFC</th>
<th align="center">Writes NFC</th>
</tr>
</thead>
<tbody><tr>
<td align="right">iPhone 11, 11 Pro &#x2F; Max, SE (2nd Gen)</td>
<td align="center">✓</td>
<td align="center">✓</td>
<td align="center">✓</td>
<td align="center">✓</td>
<td align="center">✓</td>
</tr>
<tr>
<td align="right">iPhone XS, XS Max, XR</td>
<td align="center">✓</td>
<td align="center">✓</td>
<td align="center">✓</td>
<td align="center">✓</td>
<td align="center">✓</td>
</tr>
<tr>
<td align="right">iPhone X, 8, 8+, 7, 7+</td>
<td align="center">✓</td>
<td align="center">✓</td>
<td align="center">✓</td>
<td align="center">✓*</td>
<td align="center">✓</td>
</tr>
<tr>
<td align="right">iPhone 6, 6+, 6S, 6S+, SE (1st Gen)</td>
<td align="center">✓</td>
<td align="center">✓</td>
<td align="center">✓</td>
<td align="center">✗</td>
<td align="center">✗</td>
</tr>
<tr>
<td align="right">iPhone 5S, 5C, 5, 4S, 4, 3GS, 3G</td>
<td align="center">✗</td>
<td align="center">✗</td>
<td align="center">✗</td>
<td align="center">✗</td>
<td align="center">✗</td>
</tr>
</tbody></table>
<h3 id="2-创建-App-Clip-Target"><a href="#2-创建-App-Clip-Target" class="headerlink" title="2. 创建 App Clip Target"></a>2. 创建 App Clip Target</h3><p>切换到 Project 的 Targets 列表，点击左下角 <code>+</code> 号找到 <code>App Clip</code> 项目，添加 Target：</p>
<p><img src="/images/NFC-AppClips-5.png" alt="创建 Target"></p>
<h3 id="3-apple-app-site-association"><a href="#3-apple-app-site-association" class="headerlink" title="3. apple-app-site-association"></a>3. apple-app-site-association</h3><p>扫描 NFC 标签打开对应 App Clips &#x2F; App 实际上是读取了 NFC 标签数据区的 URL 然后打开该 URL 绑定的 App Clips &#x2F; App，听起来是不是和 Universal Link 很像？所以类似地，需要在想关联的域名下添加 <code>apple-app-site-association</code> 文件，并在其中写入 <code>appclips</code> 对应的内容，<code>apps</code> 值格式为 <code>DevelopmentTeamID.BundleID</code>（DevelopmentTeamID 和 BundleID 请替换为你自己的），下面是 <a target="_blank" rel="noopener" href="http://efqrcode.com/apple-app-site-association">EFQRCode 的</a>：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;appclips&quot;: &#123;</span><br><span class="line">        &quot;apps&quot;: [&quot;P3X2725LYY.AppStore.EFQRCode.Clip&quot;]</span><br><span class="line">    &#125;</span><br><span class="line">    &quot;applinks&quot;: &#123;</span><br><span class="line">        &quot;apps&quot;: [],</span><br><span class="line">        &quot;details&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">                &quot;appID&quot;: &quot;P3X2725LYY.AppStore.EFQRCode&quot;,</span><br><span class="line">                &quot;paths&quot;: [ &quot;*&quot; ]</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>同时我们切换到刚创建的 App Clip 的 <code>Signing &amp; Capabilities</code> 选项卡下，点击左上角的 <code>+ Capability</code> 添加 <code>Associated Domains</code>，EFQRCode 的如下：</p>
<p><img src="/images/NFC-AppClips-6.png" alt="Associated Domains"></p>
<h3 id="4-Hello-World"><a href="#4-Hello-World" class="headerlink" title="4. Hello World"></a>4. Hello World</h3><p>此时我们在 Xcode 左上角选择 Clip 的 Scheme 进行编译，可以启动一个带有 Hello World 字样的空的 App Clip。</p>
<h3 id="5-添加代码获取唤起-Clip-的-URL"><a href="#5-添加代码获取唤起-Clip-的-URL" class="headerlink" title="5. 添加代码获取唤起 Clip 的 URL"></a>5. 添加代码获取唤起 Clip 的 URL</h3><p>打开我们创建的 App Clip，找到入口文件 <code>appclipApp.swift</code> 然后添加如下代码，这里使用的是 SwiftUI 方式进行开发：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">@main</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">appclipApp</span>: <span class="title class_">App</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">Scene</span> &#123;</span><br><span class="line">        <span class="type">WindowGroup</span> &#123;</span><br><span class="line">            <span class="type">ContentView</span>()</span><br><span class="line">                .onContinueUserActivity(<span class="type">NSUserActivityTypeBrowsingWeb</span>, perform: &#123; userActivity <span class="keyword">in</span></span><br><span class="line">                    <span class="keyword">guard</span> <span class="keyword">let</span> incomingURL <span class="operator">=</span> userActivity.webpageURL,</span><br><span class="line">                          <span class="keyword">let</span> components <span class="operator">=</span> <span class="type">NSURLComponents</span>(url: incomingURL, resolvingAgainstBaseURL: <span class="literal">true</span>),</span><br><span class="line">                          <span class="keyword">let</span> queryItems <span class="operator">=</span> components.queryItems <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="keyword">return</span></span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="built_in">print</span>(incomingURL)</span><br><span class="line">                    <span class="built_in">print</span>(components)</span><br><span class="line">                    <span class="built_in">print</span>(queryItems)</span><br><span class="line">                &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="App-Clip-的-NFC-唤起"><a href="#App-Clip-的-NFC-唤起" class="headerlink" title="App Clip 的 NFC 唤起"></a>App Clip 的 NFC 唤起</h2><h3 id="1-制备-NFC-标签"><a href="#1-制备-NFC-标签" class="headerlink" title="1. 制备 NFC 标签"></a>1. 制备 NFC 标签</h3><p>在唤起 Clip 之前，我们需要先制备能够唤起 Clip 的 NFC 标签，同学们可以在淘宝搜索 <code>NFC 标签贴</code> 买到空白的 NFC 标签，我这边准备的是 <code>ISO 14443-3A</code> 类型的 NFC 便利贴，小小的，可以贴在玩具底座上，如下图所示：</p>
<p><img src="/images/NFC-AppClips-7.jpg" alt="NFC 便利贴"></p>
<p>刚买到的 NFC 标签是空白的，并不包含数据，所以用 iPhone 贴近 NFC 标签并不会有任何响应。接下来我们打开 App Store 搜索 NFC Tools 随便找一个 NFC 读写器来完成我们对 NFC 标签的读写，这边我是用的是 <a target="_blank" rel="noopener" href="https://apps.apple.com/cn/app/nfc-tools/id1252962749">NFC Tools</a>。</p>
<p>打开 NFC Tools 选择 <code>读</code> 选项，当 NFC 扫描弹框出现后，将手机的背部摄像头位置靠近我们准备好的 NFC 标签，即可读出标签内的数据（如果没有识别到的话，可以尝试调整位置或扫描姿势，反正我用的 iPhone X 的 NFC 感应器是在摄像头旁边一点的样子），可以看到目前 NFC 标签内是没有写入任何数据的，只有一些基本信息，并且是可写状态，如下图所示：</p>
<p><img src="/images/NFC-AppClips-8.png" alt="读取空白 NFC 标签内的数据"></p>
<p>回到 NFC Tools 首页，选择 <code>写</code> -&gt; <code>添加记录</code> -&gt; <code>URL / URI</code>，将我们上面配好的 Associated Domains 地址填入，然后回到写数据页面，点击 <code>写 / 17 字节</code> 选项，再将手机贴近 NFC 标签，等待写入成功。这时，我们再使用 <code>读</code> 功能读取 NFC 标签内的数据，可以看到我们写入的 URL 记录：</p>
<p><img src="/images/NFC-AppClips-9.png" alt="写入数据"></p>
<h3 id="2-唤起-Clip"><a href="#2-唤起-Clip" class="headerlink" title="2. 唤起 Clip"></a>2. 唤起 Clip</h3><p>此时我们退出 NFC Tools 回到桌面，将 iPhone 贴近制备好的 NFC 标签，可以看到 iPhone 已经能识别到 NFC 标签内我们写入的 URL，但它并没有唤起我们的 App Clip，而是询问是否用 Safari 打开，这好像和我们的设想有些出入。</p>
<p><img src="/images/NFC-AppClips-10.jpg" alt="询问是否用 Safari 打开"></p>
<p>唔，这是因为我们的 Clip 并没有上架，所以 iOS 现在并不知道这个 URL 和我们 App Clip 的绑定关系。这个时候我们可以打开 <code>设置</code> -&gt; <code>开发者</code>，可以看到有 <code>APP CLIP TESTING</code> 一项，点击 <code>Local Experiences</code> -&gt; <code>Register Local Experiences</code> 添加我们的测试数据即可，添加完成后再用 iPhone 靠近 NFC 标签即可成功唤起 Clip：</p>
<p><img src="/images/NFC-AppClips-11.jpg" alt="唤起 Clip"></p>
<p>唤起成功啦，接下来就可以动手给 Clip 添加内容了呢。</p>
<h2 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h2><p>本文代码可从 <a target="_blank" rel="noopener" href="https://github.com/EFPrefix/EFQRCode/tree/appclips">https://github.com/EFPrefix/EFQRCode/tree/appclips</a> 获取，有一些上文没有提到但需要注意的点：</p>
<ul>
<li>一个 App 能且只能拥有一个 App Clip；</li>
<li>App Clip 的包大小上限为 10M，如何合理封装、复用现有代码，需要花一些时间思考；</li>
<li>如果用户已经安装了 App，那么会直接唤起 App 而不是 Clip。</li>
</ul>
<p>那么问题来了，实际生活中有哪些业务需求可以用到这个酷炫的能力呢？小伙伴们需要自己思考啦…</p>
<p>本文编写过程中参考了以下文章，在此对原作者们表示感谢：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://onevcat.com/2020/06/first-look-app-clips/">一些关于 App Clips 的笔记</a></li>
<li><a target="_blank" rel="noopener" href="http://www.cocoachina.com/articles/899697">App Clips简介以及demo演示</a></li>
<li><a target="_blank" rel="noopener" href="https://www.bluebite.com/nfc/iphone-nfc-compatibility">iPhone NFC Compatibility</a></li>
</ul>
<hr>
<blockquote>
<p>如有任何知识产权、版权问题或理论错误，还请指正。<br><a target="_blank" rel="noopener" href="https://www.eyrefree.org/2020/09/27/NFC-AppClips">https://www.eyrefree.org/2020/09/27/NFC-AppClips</a><br>如文中无特殊说明，本站均使用以下协议保护：<a target="_blank" rel="noopener" href="http://creativecommons.org/licenses/by-nc-nd/3.0/cn/">署名-非商业性使用-禁止演绎</a>。   </p>
</blockquote>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">首页</a></li>
         
          <li><a href="/archives/">归档</a></li>
         
          <li><a href="/categories/">分类</a></li>
         
          <li><a href="/tags/">标签</a></li>
         
          <li><a href="/about/">关于</a></li>
         
          <li><a href="/search/">搜索</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#NFC-%E7%AE%80%E4%BB%8B"><span class="toc-number">1.</span> <span class="toc-text">NFC 简介</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E8%B5%B7%E6%BA%90"><span class="toc-number">1.1.</span> <span class="toc-text">1. 起源</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%8E%9F%E7%90%86"><span class="toc-number">1.2.</span> <span class="toc-text">2. 原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%BA%94%E7%94%A8"><span class="toc-number">1.3.</span> <span class="toc-text">3. 应用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%94%AF%E4%BB%98%E5%BA%94%E7%94%A8"><span class="toc-number">1.3.1.</span> <span class="toc-text">支付应用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E9%98%B2%E5%BA%94%E7%94%A8"><span class="toc-number">1.3.2.</span> <span class="toc-text">安防应用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%87%E7%AD%BE%E5%BA%94%E7%94%A8"><span class="toc-number">1.3.3.</span> <span class="toc-text">标签应用</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#App-Clips-%E5%88%9B%E5%BB%BA"><span class="toc-number">2.</span> <span class="toc-text">App Clips 创建</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E5%92%8C%E8%AE%BE%E5%A4%87"><span class="toc-number">2.1.</span> <span class="toc-text">1. 开发环境和设备</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%88%9B%E5%BB%BA-App-Clip-Target"><span class="toc-number">2.2.</span> <span class="toc-text">2. 创建 App Clip Target</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-apple-app-site-association"><span class="toc-number">2.3.</span> <span class="toc-text">3. apple-app-site-association</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-Hello-World"><span class="toc-number">2.4.</span> <span class="toc-text">4. Hello World</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E6%B7%BB%E5%8A%A0%E4%BB%A3%E7%A0%81%E8%8E%B7%E5%8F%96%E5%94%A4%E8%B5%B7-Clip-%E7%9A%84-URL"><span class="toc-number">2.5.</span> <span class="toc-text">5. 添加代码获取唤起 Clip 的 URL</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#App-Clip-%E7%9A%84-NFC-%E5%94%A4%E8%B5%B7"><span class="toc-number">3.</span> <span class="toc-text">App Clip 的 NFC 唤起</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%88%B6%E5%A4%87-NFC-%E6%A0%87%E7%AD%BE"><span class="toc-number">3.1.</span> <span class="toc-text">1. 制备 NFC 标签</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%94%A4%E8%B5%B7-Clip"><span class="toc-number">3.2.</span> <span class="toc-text">2. 唤起 Clip</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%8E%E8%AE%B0"><span class="toc-number">4.</span> <span class="toc-text">后记</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://www.efqrcode.com/2020/09/27/NFC-AppClips/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://www.efqrcode.com/2020/09/27/NFC-AppClips/&text=如何实现通过 NFC 标签唤起 App Clips"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://www.efqrcode.com/2020/09/27/NFC-AppClips/&title=如何实现通过 NFC 标签唤起 App Clips"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://www.efqrcode.com/2020/09/27/NFC-AppClips/&is_video=false&description=如何实现通过 NFC 标签唤起 App Clips"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=如何实现通过 NFC 标签唤起 App Clips&body=Check out this article: http://www.efqrcode.com/2020/09/27/NFC-AppClips/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://www.efqrcode.com/2020/09/27/NFC-AppClips/&title=如何实现通过 NFC 标签唤起 App Clips"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://www.efqrcode.com/2020/09/27/NFC-AppClips/&title=如何实现通过 NFC 标签唤起 App Clips"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://www.efqrcode.com/2020/09/27/NFC-AppClips/&title=如何实现通过 NFC 标签唤起 App Clips"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://www.efqrcode.com/2020/09/27/NFC-AppClips/&title=如何实现通过 NFC 标签唤起 App Clips"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://www.efqrcode.com/2020/09/27/NFC-AppClips/&name=如何实现通过 NFC 标签唤起 App Clips&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://www.efqrcode.com/2020/09/27/NFC-AppClips/&t=如何实现通过 NFC 标签唤起 App Clips"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> 菜单</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> 目录</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> 分享</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> 返回顶部</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2015-2022
    EyreFree
  </div>
  <div class="footer-center">
    <a target="_blank" rel="noopener" href="http://beian.miit.gov.cn/">苏ICP备15023694号-2</a>
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">首页</a></li><!--
     --><!--
       --><li><a href="/archives/">归档</a></li><!--
     --><!--
       --><li><a href="/categories/">分类</a></li><!--
     --><!--
       --><li><a href="/tags/">标签</a></li><!--
     --><!--
       --><li><a href="/about/">关于</a></li><!--
     --><!--
       --><li><a href="/search/">搜索</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->
 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script> 




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script> 
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"复制到粘贴板！\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "复制成功！");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

  <script type="text/javascript">
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "https://hm.baidu.com/hm.js?638f7245dab1e13e3d8fbdd9cc3b0895";
          var s = document.getElementsByTagName("script")[0];
          s.parentNode.insertBefore(hm, s);
        })();
        </script>

<!-- Cloudflare Analytics -->

<!-- Umami Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
